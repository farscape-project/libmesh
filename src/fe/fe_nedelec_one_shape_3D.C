// The libMesh Finite Element Library.
// Copyright (C) 2002-2024 Benjamin S. Kirk, John W. Peterson, Roy H. Stogner

// This library is free software; you can redistribute it and/or
// modify it under the terms of the GNU Lesser General Public
// License as published by the Free Software Foundation; either
// version 2.1 of the License, or (at your option) any later version.

// This library is distributed in the hope that it will be useful,
// but WITHOUT ANY WARRANTY; without even the implied warranty of
// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
// Lesser General Public License for more details.

// You should have received a copy of the GNU Lesser General Public
// License along with this library; if not, write to the Free Software
// Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA  02111-1307  USA


// Local includes
#include "libmesh/fe.h"
#include "libmesh/elem.h"
#include "libmesh/enum_to_string.h"

namespace libMesh
{

template <>
RealGradient FE<3,NEDELEC_ONE>::shape(const Elem * elem,
                                      const Order order,
                                      const unsigned int i,
                                      const Point & p,
                                      const bool add_p_level)
{
#if LIBMESH_DIM == 3
  libmesh_assert(elem);

  const Order totalorder = static_cast<Order>(order + add_p_level * elem->p_level());
  libmesh_assert_less(i, n_dofs(elem->type(), totalorder));

  const char sign = elem->point(elem->local_edge_node(i, 0)) > elem->point(elem->local_edge_node(i, 1)) ? 1 : -1;

  const Real xi   = p(0);
  const Real eta  = p(1);
  const Real zeta = p(2);

  switch (totalorder)
    {
      // linear Nedelec (first kind) shape functions
    case FIRST:
      {
        switch (elem->type())
          {
          case HEX20:
          case HEX27:
            {
              // Even with a loose inverse_map tolerance we ought to
              // be nearly on the element interior in master
              // coordinates
              libmesh_assert_less_equal ( std::fabs(xi),   1.0+10*TOLERANCE );
              libmesh_assert_less_equal ( std::fabs(eta),  1.0+10*TOLERANCE );
              libmesh_assert_less_equal ( std::fabs(zeta), 1.0+10*TOLERANCE );

              switch(i)
                {
                case 0:
                  return sign * RealGradient( -0.125*(1.0-eta-zeta+eta*zeta), 0.0, 0.0 );
                case 1:
                  return sign * RealGradient( 0.0, -0.125*(1.0+xi-zeta-xi*zeta), 0.0 );
                case 2:
                  return sign * RealGradient(  0.125*(1.0+eta-zeta-eta*zeta), 0.0, 0.0 );
                case 3:
                  return sign * RealGradient( 0.0, -0.125*(1.0-xi-zeta+xi*zeta), 0.0 );
                case 4:
                  return sign * RealGradient( 0.0, 0.0, -0.125*(1.0-xi-eta+xi*eta) );
                case 5:
                  return sign * RealGradient( 0.0, 0.0, -0.125*(1.0+xi-eta-xi*eta) );
                case 6:
                  return sign * RealGradient( 0.0, 0.0, -0.125*(1.0+xi+eta+xi*eta) );
                case 7:
                  return sign * RealGradient( 0.0, 0.0, -0.125*(1.0-xi+eta-xi*eta) );
                case 8:
                  return sign * RealGradient( -0.125*(1.0-eta+zeta-eta*zeta), 0.0, 0.0 );
                case 9:
                  return sign * RealGradient( 0.0, -0.125*(1.0+xi+zeta+xi*zeta), 0.0 );
                case 10:
                  return sign * RealGradient(  0.125*(1.0+eta+zeta+eta*zeta), 0.0, 0.0 );
                case 11:
                  return sign * RealGradient( 0.0, -0.125*(1.0-xi+zeta-xi*zeta), 0.0 );

                default:
                  libmesh_error_msg("Invalid i = " << i);
                }
            }

          case TET10:
          case TET14:
            {
              switch(i)
                {
                case 0:
                  return sign * RealGradient( -1.0+eta+zeta, -xi, -xi );
                case 1:
                  return sign * RealGradient( eta,  -xi, 0.0 );
                case 2:
                  return sign * RealGradient( -eta, -1.0+xi+zeta, -eta );
                case 3:
                  return sign * RealGradient( -zeta, -zeta, -1.0+xi+eta );
                case 4:
                  return sign * RealGradient( zeta, 0.0, -xi );
                case 5:
                  return sign * RealGradient( 0.0, zeta, -eta );

                default:
                  libmesh_error_msg("Invalid i = " << i);
                }
            }

          default:
            libmesh_error_msg("ERROR: Unsupported 3D element type!: " << Utility::enum_to_string(elem->type()));
          }
      }

      // quadratic Nedelec (first kind) shape functions
    case SECOND:
      {
        switch (elem->type())
          {
          case HEX27:
            {
              switch(ii)
                {
                case 0:
                  return sign * RealGradient(-4.*eta - 3.*xi/2. - 4.*zeta - 48.*(eta/2. + 1./2.)*(xi/2. + 1./2.)*(zeta/2. + 1./2.) + 12.*(eta/2. + 1./2.)*(xi/2. + 1./2.) + 36.*(eta/2. + 1./2.)*(xi/2. + 1./2.)*((zeta + 1.)*(zeta + 1.)/(2.*2.)) + 32.*(eta/2. + 1./2.)*(zeta/2. + 1./2.) - 24.*(eta/2. + 1./2.)*(zeta + 1.)*(zeta + 1.)/(2.*2.) + 12.*(xi/2. + 1./2.)*(zeta/2. + 1./2.) + 36.*(xi/2. + 1./2.)*(zeta/2. + 1./2.)*((eta + 1.)*(eta + 1.)/(2.*2.)) - 9.*(xi/2. + 1./2.)*(eta + 1.)*(eta + 1.)/(2.*2.) - 9.*(xi/2. + 1./2.)*(zeta + 1.)*(zeta + 1.)/(2.*2.) - 27.*(xi/2. + 1./2.)*(zeta + 1.)*(zeta + 1.)/(2.*2.)*(eta + 1.)*(eta + 1.)/(2.*2.) - 24.*(zeta/2. + 1./2.)*(eta + 1.)*(eta + 1.)/(2.*2.) - 15./2. + 6.*((eta + 1.)*(eta + 1.)/(2.*2.)) + 6.*((zeta + 1.)*(zeta + 1.)/(2.*2.)) + 18.*((zeta + 1.)*(zeta + 1.)/(2.*2.))*((eta + 1.)*(eta + 1.)/(2.*2.)), 0., 0.);
                case 1:
                  return sign * RealGradient(2.*eta + 3.*xi/2. + 2.*zeta + 48.*(eta/2. + 1./2.)*(xi/2. + 1./2.)*(zeta/2. + 1./2.) - 12.*(eta/2. + 1./2.)*(xi/2. + 1./2.) - 36.*(eta/2. + 1./2.)*(xi/2. + 1./2.)*(zeta + 1.)*(zeta + 1.)/(2.*2.) - 16.*(eta/2. + 1./2.)*(zeta/2. + 1./2.) + 12.*(eta/2. + 1./2.)*((zeta + 1.)*(zeta + 1.)/(2.*2.)) - 12.*(xi/2. + 1./2.)*(zeta/2. + 1./2.) - 36.*(xi/2. + 1./2.)*(zeta/2. + 1./2.)*(eta + 1.)*(eta + 1.)/(2.*2.) + 9.*(xi/2. + 1./2.)*((eta + 1.)*(eta + 1.)/(2.*2.)) + 9.*(xi/2. + 1./2.)*((zeta + 1.)*(zeta + 1.)/(2.*2.)) + 27.*(xi/2. + 1./2.)*((zeta + 1.)*(zeta + 1.)/(2.*2.))*((eta + 1.)*(eta + 1.)/(2.*2.)) + 12.*(zeta/2. + 1./2.)*((eta + 1.)*(eta + 1.)/(2.*2.)) + 9./2. - 3.*(eta + 1.)*(eta + 1.)/(2.*2.) - 3.*(zeta + 1.)*(zeta + 1.)/(2.*2.) - 9.*(zeta + 1.)*(zeta + 1.)/(2.*2.)*(eta + 1.)*(eta + 1.)/(2.*2.), 0., 0.);
                case 2:
                  return sign * RealGradient(0., -2.*xi - 24.*(eta/2. + 1./2.)*(xi/2. + 1./2.)*(zeta/2. + 1./2.) + 6.*(eta/2. + 1./2.)*(xi/2. + 1./2.) + 18.*(eta/2. + 1./2.)*(xi/2. + 1./2.)*((zeta + 1.)*(zeta + 1.)/(2.*2.)) + 36.*(eta/2. + 1./2.)*(zeta/2. + 1./2.)*((xi + 1.)*(xi + 1.)/(2.*2.)) - 9.*(eta/2. + 1./2.)*(xi + 1.)*(xi + 1.)/(2.*2.) - 27.*(eta/2. + 1./2.)*(zeta + 1.)*(zeta + 1.)/(2.*2.)*(xi + 1.)*(xi + 1.)/(2.*2.) + 16.*(xi/2. + 1./2.)*(zeta/2. + 1./2.) - 12.*(xi/2. + 1./2.)*(zeta + 1.)*(zeta + 1.)/(2.*2.) - 24.*(zeta/2. + 1./2.)*(xi + 1.)*(xi + 1.)/(2.*2.) - 2. + 6.*((xi + 1.)*(xi + 1.)/(2.*2.)) + 18.*((zeta + 1.)*(zeta + 1.)/(2.*2.))*((xi + 1.)*(xi + 1.)/(2.*2.)), 0.);
                case 3:
                  return sign * RealGradient(0., xi + 24.*(eta/2. + 1./2.)*(xi/2. + 1./2.)*(zeta/2. + 1./2.) - 6.*(eta/2. + 1./2.)*(xi/2. + 1./2.) - 18.*(eta/2. + 1./2.)*(xi/2. + 1./2.)*(zeta + 1.)*(zeta + 1.)/(2.*2.) - 36.*(eta/2. + 1./2.)*(zeta/2. + 1./2.)*(xi + 1.)*(xi + 1.)/(2.*2.) + 9.*(eta/2. + 1./2.)*((xi + 1.)*(xi + 1.)/(2.*2.)) + 27.*(eta/2. + 1./2.)*((zeta + 1.)*(zeta + 1.)/(2.*2.))*((xi + 1.)*(xi + 1.)/(2.*2.)) - 8.*(xi/2. + 1./2.)*(zeta/2. + 1./2.) + 6.*(xi/2. + 1./2.)*((zeta + 1.)*(zeta + 1.)/(2.*2.)) + 12.*(zeta/2. + 1./2.)*((xi + 1.)*(xi + 1.)/(2.*2.)) + 1. - 3.*(xi + 1.)*(xi + 1.)/(2.*2.) - 9.*(zeta + 1.)*(zeta + 1.)/(2.*2.)*(xi + 1.)*(xi + 1.)/(2.*2.), 0.);
                case 4:
                  return sign * RealGradient(-eta - 24.*(eta/2. + 1./2.)*(xi/2. + 1./2.)*(zeta/2. + 1./2.) + 6.*(eta/2. + 1./2.)*(xi/2. + 1./2.) + 18.*(eta/2. + 1./2.)*(xi/2. + 1./2.)*((zeta + 1.)*(zeta + 1.)/(2.*2.)) + 8.*(eta/2. + 1./2.)*(zeta/2. + 1./2.) - 6.*(eta/2. + 1./2.)*(zeta + 1.)*(zeta + 1.)/(2.*2.) + 36.*(xi/2. + 1./2.)*(zeta/2. + 1./2.)*((eta + 1.)*(eta + 1.)/(2.*2.)) - 9.*(xi/2. + 1./2.)*(eta + 1.)*(eta + 1.)/(2.*2.) - 27.*(xi/2. + 1./2.)*(zeta + 1.)*(zeta + 1.)/(2.*2.)*(eta + 1.)*(eta + 1.)/(2.*2.) - 12.*(zeta/2. + 1./2.)*(eta + 1.)*(eta + 1.)/(2.*2.) - 1. + 3.*((eta + 1.)*(eta + 1.)/(2.*2.)) + 9.*((zeta + 1.)*(zeta + 1.)/(2.*2.))*((eta + 1.)*(eta + 1.)/(2.*2.)), 0., 0.);
                case 5:
                  return sign * RealGradient(2.*eta + 24.*(eta/2. + 1./2.)*(xi/2. + 1./2.)*(zeta/2. + 1./2.) - 6.*(eta/2. + 1./2.)*(xi/2. + 1./2.) - 18.*(eta/2. + 1./2.)*(xi/2. + 1./2.)*(zeta + 1.)*(zeta + 1.)/(2.*2.) - 16.*(eta/2. + 1./2.)*(zeta/2. + 1./2.) + 12.*(eta/2. + 1./2.)*((zeta + 1.)*(zeta + 1.)/(2.*2.)) - 36.*(xi/2. + 1./2.)*(zeta/2. + 1./2.)*(eta + 1.)*(eta + 1.)/(2.*2.) + 9.*(xi/2. + 1./2.)*((eta + 1.)*(eta + 1.)/(2.*2.)) + 27.*(xi/2. + 1./2.)*((zeta + 1.)*(zeta + 1.)/(2.*2.))*((eta + 1.)*(eta + 1.)/(2.*2.)) + 24.*(zeta/2. + 1./2.)*((eta + 1.)*(eta + 1.)/(2.*2.)) + 2. - 6.*(eta + 1.)*(eta + 1.)/(2.*2.) - 18.*(zeta + 1.)*(zeta + 1.)/(2.*2.)*(eta + 1.)*(eta + 1.)/(2.*2.), 0., 0.);
                case 6:
                  return sign * RealGradient(0., -3.*eta/2. - 4.*xi - 4.*zeta - 48.*(eta/2. + 1./2.)*(xi/2. + 1./2.)*(zeta/2. + 1./2.) + 12.*(eta/2. + 1./2.)*(xi/2. + 1./2.) + 36.*(eta/2. + 1./2.)*(xi/2. + 1./2.)*((zeta + 1.)*(zeta + 1.)/(2.*2.)) + 12.*(eta/2. + 1./2.)*(zeta/2. + 1./2.) + 36.*(eta/2. + 1./2.)*(zeta/2. + 1./2.)*((xi + 1.)*(xi + 1.)/(2.*2.)) - 9.*(eta/2. + 1./2.)*(xi + 1.)*(xi + 1.)/(2.*2.) - 9.*(eta/2. + 1./2.)*(zeta + 1.)*(zeta + 1.)/(2.*2.) - 27.*(eta/2. + 1./2.)*(zeta + 1.)*(zeta + 1.)/(2.*2.)*(xi + 1.)*(xi + 1.)/(2.*2.) + 32.*(xi/2. + 1./2.)*(zeta/2. + 1./2.) - 24.*(xi/2. + 1./2.)*(zeta + 1.)*(zeta + 1.)/(2.*2.) - 24.*(zeta/2. + 1./2.)*(xi + 1.)*(xi + 1.)/(2.*2.) - 15./2. + 6.*((xi + 1.)*(xi + 1.)/(2.*2.)) + 6.*((zeta + 1.)*(zeta + 1.)/(2.*2.)) + 18.*((zeta + 1.)*(zeta + 1.)/(2.*2.))*((xi + 1.)*(xi + 1.)/(2.*2.)), 0.);
                case 7:
                  return sign * RealGradient(0., 3.*eta/2. + 2.*xi + 2.*zeta + 48.*(eta/2. + 1./2.)*(xi/2. + 1./2.)*(zeta/2. + 1./2.) - 12.*(eta/2. + 1./2.)*(xi/2. + 1./2.) - 36.*(eta/2. + 1./2.)*(xi/2. + 1./2.)*(zeta + 1.)*(zeta + 1.)/(2.*2.) - 12.*(eta/2. + 1./2.)*(zeta/2. + 1./2.) - 36.*(eta/2. + 1./2.)*(zeta/2. + 1./2.)*(xi + 1.)*(xi + 1.)/(2.*2.) + 9.*(eta/2. + 1./2.)*((xi + 1.)*(xi + 1.)/(2.*2.)) + 9.*(eta/2. + 1./2.)*((zeta + 1.)*(zeta + 1.)/(2.*2.)) + 27.*(eta/2. + 1./2.)*((zeta + 1.)*(zeta + 1.)/(2.*2.))*((xi + 1.)*(xi + 1.)/(2.*2.)) - 16.*(xi/2. + 1./2.)*(zeta/2. + 1./2.) + 12.*(xi/2. + 1./2.)*((zeta + 1.)*(zeta + 1.)/(2.*2.)) + 12.*(zeta/2. + 1./2.)*((xi + 1.)*(xi + 1.)/(2.*2.)) + 9./2. - 3.*(xi + 1.)*(xi + 1.)/(2.*2.) - 3.*(zeta + 1.)*(zeta + 1.)/(2.*2.) - 9.*(zeta + 1.)*(zeta + 1.)/(2.*2.)*(xi + 1.)*(xi + 1.)/(2.*2.), 0.);
                case 8:
                  return sign * RealGradient(0., 0., -4.*eta - 4.*xi - 3.*zeta/2. - 48.*(eta/2. + 1./2.)*(xi/2. + 1./2.)*(zeta/2. + 1./2.) + 32.*(eta/2. + 1./2.)*(xi/2. + 1./2.) + 12.*(eta/2. + 1./2.)*(zeta/2. + 1./2.) + 36.*(eta/2. + 1./2.)*(zeta/2. + 1./2.)*((xi + 1.)*(xi + 1.)/(2.*2.)) - 24.*(eta/2. + 1./2.)*(xi + 1.)*(xi + 1.)/(2.*2.) + 12.*(xi/2. + 1./2.)*(zeta/2. + 1./2.) + 36.*(xi/2. + 1./2.)*(zeta/2. + 1./2.)*((eta + 1.)*(eta + 1.)/(2.*2.)) - 24.*(xi/2. + 1./2.)*(eta + 1.)*(eta + 1.)/(2.*2.) - 9.*(zeta/2. + 1./2.)*(eta + 1.)*(eta + 1.)/(2.*2.) - 27.*(zeta/2. + 1./2.)*(eta + 1.)*(eta + 1.)/(2.*2.)*(xi + 1.)*(xi + 1.)/(2.*2.) - 9.*(zeta/2. + 1./2.)*(xi + 1.)*(xi + 1.)/(2.*2.) - 15./2. + 6.*((eta + 1.)*(eta + 1.)/(2.*2.)) + 18.*((eta + 1.)*(eta + 1.)/(2.*2.))*((xi + 1.)*(xi + 1.)/(2.*2.)) + 6.*((xi + 1.)*(xi + 1.)/(2.*2.)));
                case 9:
                  return sign * RealGradient(0., 0., 2.*eta + 2.*xi + 3.*zeta/2. + 48.*(eta/2. + 1./2.)*(xi/2. + 1./2.)*(zeta/2. + 1./2.) - 16.*(eta/2. + 1./2.)*(xi/2. + 1./2.) - 12.*(eta/2. + 1./2.)*(zeta/2. + 1./2.) - 36.*(eta/2. + 1./2.)*(zeta/2. + 1./2.)*(xi + 1.)*(xi + 1.)/(2.*2.) + 12.*(eta/2. + 1./2.)*((xi + 1.)*(xi + 1.)/(2.*2.)) - 12.*(xi/2. + 1./2.)*(zeta/2. + 1./2.) - 36.*(xi/2. + 1./2.)*(zeta/2. + 1./2.)*(eta + 1.)*(eta + 1.)/(2.*2.) + 12.*(xi/2. + 1./2.)*((eta + 1.)*(eta + 1.)/(2.*2.)) + 9.*(zeta/2. + 1./2.)*((eta + 1.)*(eta + 1.)/(2.*2.)) + 27.*(zeta/2. + 1./2.)*((eta + 1.)*(eta + 1.)/(2.*2.))*((xi + 1.)*(xi + 1.)/(2.*2.)) + 9.*(zeta/2. + 1./2.)*((xi + 1.)*(xi + 1.)/(2.*2.)) + 9./2. - 3.*(eta + 1.)*(eta + 1.)/(2.*2.) - 9.*(eta + 1.)*(eta + 1.)/(2.*2.)*(xi + 1.)*(xi + 1.)/(2.*2.) - 3.*(xi + 1.)*(xi + 1.)/(2.*2.));
                case 10:
                  return sign * RealGradient(0., 0., -2.*xi - 24.*(eta/2. + 1./2.)*(xi/2. + 1./2.)*(zeta/2. + 1./2.) + 16.*(eta/2. + 1./2.)*(xi/2. + 1./2.) + 36.*(eta/2. + 1./2.)*(zeta/2. + 1./2.)*((xi + 1.)*(xi + 1.)/(2.*2.)) - 24.*(eta/2. + 1./2.)*(xi + 1.)*(xi + 1.)/(2.*2.) + 6.*(xi/2. + 1./2.)*(zeta/2. + 1./2.) + 18.*(xi/2. + 1./2.)*(zeta/2. + 1./2.)*((eta + 1.)*(eta + 1.)/(2.*2.)) - 12.*(xi/2. + 1./2.)*(eta + 1.)*(eta + 1.)/(2.*2.) - 27.*(zeta/2. + 1./2.)*(eta + 1.)*(eta + 1.)/(2.*2.)*(xi + 1.)*(xi + 1.)/(2.*2.) - 9.*(zeta/2. + 1./2.)*(xi + 1.)*(xi + 1.)/(2.*2.) - 2. + 18.*((eta + 1.)*(eta + 1.)/(2.*2.))*((xi + 1.)*(xi + 1.)/(2.*2.)) + 6.*((xi + 1.)*(xi + 1.)/(2.*2.)));
                case 11:
                  return sign * RealGradient(0., 0., xi + 24.*(eta/2. + 1./2.)*(xi/2. + 1./2.)*(zeta/2. + 1./2.) - 8.*(eta/2. + 1./2.)*(xi/2. + 1./2.) - 36.*(eta/2. + 1./2.)*(zeta/2. + 1./2.)*(xi + 1.)*(xi + 1.)/(2.*2.) + 12.*(eta/2. + 1./2.)*((xi + 1.)*(xi + 1.)/(2.*2.)) - 6.*(xi/2. + 1./2.)*(zeta/2. + 1./2.) - 18.*(xi/2. + 1./2.)*(zeta/2. + 1./2.)*(eta + 1.)*(eta + 1.)/(2.*2.) + 6.*(xi/2. + 1./2.)*((eta + 1.)*(eta + 1.)/(2.*2.)) + 27.*(zeta/2. + 1./2.)*((eta + 1.)*(eta + 1.)/(2.*2.))*((xi + 1.)*(xi + 1.)/(2.*2.)) + 9.*(zeta/2. + 1./2.)*((xi + 1.)*(xi + 1.)/(2.*2.)) + 1. - 9.*(eta + 1.)*(eta + 1.)/(2.*2.)*(xi + 1.)*(xi + 1.)/(2.*2.) - 3.*(xi + 1.)*(xi + 1.)/(2.*2.));
                case 12:
                  return sign * RealGradient(0., 0., -12.*(eta/2. + 1./2.)*(xi/2. + 1./2.)*(zeta/2. + 1./2.) + 8.*(eta/2. + 1./2.)*(xi/2. + 1./2.) + 18.*(eta/2. + 1./2.)*(zeta/2. + 1./2.)*((xi + 1.)*(xi + 1.)/(2.*2.)) - 12.*(eta/2. + 1./2.)*(xi + 1.)*(xi + 1.)/(2.*2.) + 18.*(xi/2. + 1./2.)*(zeta/2. + 1./2.)*((eta + 1.)*(eta + 1.)/(2.*2.)) - 12.*(xi/2. + 1./2.)*(eta + 1.)*(eta + 1.)/(2.*2.) - 27.*(zeta/2. + 1./2.)*(eta + 1.)*(eta + 1.)/(2.*2.)*(xi + 1.)*(xi + 1.)/(2.*2.) + 18.*((eta + 1.)*(eta + 1.)/(2.*2.))*((xi + 1.)*(xi + 1.)/(2.*2.)));
                case 13:
                  return sign * RealGradient(0., 0., 12.*(eta/2. + 1./2.)*(xi/2. + 1./2.)*(zeta/2. + 1./2.) - 4.*(eta/2. + 1./2.)*(xi/2. + 1./2.) - 18.*(eta/2. + 1./2.)*(zeta/2. + 1./2.)*(xi + 1.)*(xi + 1.)/(2.*2.) + 6.*(eta/2. + 1./2.)*((xi + 1.)*(xi + 1.)/(2.*2.)) - 18.*(xi/2. + 1./2.)*(zeta/2. + 1./2.)*(eta + 1.)*(eta + 1.)/(2.*2.) + 6.*(xi/2. + 1./2.)*((eta + 1.)*(eta + 1.)/(2.*2.)) + 27.*(zeta/2. + 1./2.)*((eta + 1.)*(eta + 1.)/(2.*2.))*((xi + 1.)*(xi + 1.)/(2.*2.)) - 9.*(eta + 1.)*(eta + 1.)/(2.*2.)*(xi + 1.)*(xi + 1.)/(2.*2.));
                case 14:
                  return sign * RealGradient(0., 0., -2.*eta - 24.*(eta/2. + 1./2.)*(xi/2. + 1./2.)*(zeta/2. + 1./2.) + 16.*(eta/2. + 1./2.)*(xi/2. + 1./2.) + 6.*(eta/2. + 1./2.)*(zeta/2. + 1./2.) + 18.*(eta/2. + 1./2.)*(zeta/2. + 1./2.)*((xi + 1.)*(xi + 1.)/(2.*2.)) - 12.*(eta/2. + 1./2.)*(xi + 1.)*(xi + 1.)/(2.*2.) + 36.*(xi/2. + 1./2.)*(zeta/2. + 1./2.)*((eta + 1.)*(eta + 1.)/(2.*2.)) - 24.*(xi/2. + 1./2.)*(eta + 1.)*(eta + 1.)/(2.*2.) - 9.*(zeta/2. + 1./2.)*(eta + 1.)*(eta + 1.)/(2.*2.) - 27.*(zeta/2. + 1./2.)*(eta + 1.)*(eta + 1.)/(2.*2.)*(xi + 1.)*(xi + 1.)/(2.*2.) - 2. + 6.*((eta + 1.)*(eta + 1.)/(2.*2.)) + 18.*((eta + 1.)*(eta + 1.)/(2.*2.))*((xi + 1.)*(xi + 1.)/(2.*2.)));
                case 15:
                  return sign * RealGradient(0., 0., eta + 24.*(eta/2. + 1./2.)*(xi/2. + 1./2.)*(zeta/2. + 1./2.) - 8.*(eta/2. + 1./2.)*(xi/2. + 1./2.) - 6.*(eta/2. + 1./2.)*(zeta/2. + 1./2.) - 18.*(eta/2. + 1./2.)*(zeta/2. + 1./2.)*(xi + 1.)*(xi + 1.)/(2.*2.) + 6.*(eta/2. + 1./2.)*((xi + 1.)*(xi + 1.)/(2.*2.)) - 36.*(xi/2. + 1./2.)*(zeta/2. + 1./2.)*(eta + 1.)*(eta + 1.)/(2.*2.) + 12.*(xi/2. + 1./2.)*((eta + 1.)*(eta + 1.)/(2.*2.)) + 9.*(zeta/2. + 1./2.)*((eta + 1.)*(eta + 1.)/(2.*2.)) + 27.*(zeta/2. + 1./2.)*((eta + 1.)*(eta + 1.)/(2.*2.))*((xi + 1.)*(xi + 1.)/(2.*2.)) + 1. - 3.*(eta + 1.)*(eta + 1.)/(2.*2.) - 9.*(eta + 1.)*(eta + 1.)/(2.*2.)*(xi + 1.)*(xi + 1.)/(2.*2.));
                case 16:
                  return sign * RealGradient(-2.*zeta - 24.*(eta/2. + 1./2.)*(xi/2. + 1./2.)*(zeta/2. + 1./2.) + 36.*(eta/2. + 1./2.)*(xi/2. + 1./2.)*((zeta + 1.)*(zeta + 1.)/(2.*2.)) + 16.*(eta/2. + 1./2.)*(zeta/2. + 1./2.) - 24.*(eta/2. + 1./2.)*(zeta + 1.)*(zeta + 1.)/(2.*2.) + 6.*(xi/2. + 1./2.)*(zeta/2. + 1./2.) + 18.*(xi/2. + 1./2.)*(zeta/2. + 1./2.)*((eta + 1.)*(eta + 1.)/(2.*2.)) - 9.*(xi/2. + 1./2.)*(zeta + 1.)*(zeta + 1.)/(2.*2.) - 27.*(xi/2. + 1./2.)*(zeta + 1.)*(zeta + 1.)/(2.*2.)*(eta + 1.)*(eta + 1.)/(2.*2.) - 12.*(zeta/2. + 1./2.)*(eta + 1.)*(eta + 1.)/(2.*2.) - 2. + 6.*((zeta + 1.)*(zeta + 1.)/(2.*2.)) + 18.*((zeta + 1.)*(zeta + 1.)/(2.*2.))*((eta + 1.)*(eta + 1.)/(2.*2.)), 0., 0.);
                case 17:
                  return sign * RealGradient(zeta + 24.*(eta/2. + 1./2.)*(xi/2. + 1./2.)*(zeta/2. + 1./2.) - 36.*(eta/2. + 1./2.)*(xi/2. + 1./2.)*(zeta + 1.)*(zeta + 1.)/(2.*2.) - 8.*(eta/2. + 1./2.)*(zeta/2. + 1./2.) + 12.*(eta/2. + 1./2.)*((zeta + 1.)*(zeta + 1.)/(2.*2.)) - 6.*(xi/2. + 1./2.)*(zeta/2. + 1./2.) - 18.*(xi/2. + 1./2.)*(zeta/2. + 1./2.)*(eta + 1.)*(eta + 1.)/(2.*2.) + 9.*(xi/2. + 1./2.)*((zeta + 1.)*(zeta + 1.)/(2.*2.)) + 27.*(xi/2. + 1./2.)*((zeta + 1.)*(zeta + 1.)/(2.*2.))*((eta + 1.)*(eta + 1.)/(2.*2.)) + 6.*(zeta/2. + 1./2.)*((eta + 1.)*(eta + 1.)/(2.*2.)) + 1. - 3.*(zeta + 1.)*(zeta + 1.)/(2.*2.) - 9.*(zeta + 1.)*(zeta + 1.)/(2.*2.)*(eta + 1.)*(eta + 1.)/(2.*2.), 0., 0.);
                case 18:
                  return sign * RealGradient(0., -12.*(eta/2. + 1./2.)*(xi/2. + 1./2.)*(zeta/2. + 1./2.) + 18.*(eta/2. + 1./2.)*(xi/2. + 1./2.)*((zeta + 1.)*(zeta + 1.)/(2.*2.)) + 18.*(eta/2. + 1./2.)*(zeta/2. + 1./2.)*((xi + 1.)*(xi + 1.)/(2.*2.)) - 27.*(eta/2. + 1./2.)*(zeta + 1.)*(zeta + 1.)/(2.*2.)*(xi + 1.)*(xi + 1.)/(2.*2.) + 8.*(xi/2. + 1./2.)*(zeta/2. + 1./2.) - 12.*(xi/2. + 1./2.)*(zeta + 1.)*(zeta + 1.)/(2.*2.) - 12.*(zeta/2. + 1./2.)*(xi + 1.)*(xi + 1.)/(2.*2.) + 18.*((zeta + 1.)*(zeta + 1.)/(2.*2.))*((xi + 1.)*(xi + 1.)/(2.*2.)), 0.);
                case 19:
                  return sign * RealGradient(0., 12.*(eta/2. + 1./2.)*(xi/2. + 1./2.)*(zeta/2. + 1./2.) - 18.*(eta/2. + 1./2.)*(xi/2. + 1./2.)*(zeta + 1.)*(zeta + 1.)/(2.*2.) - 18.*(eta/2. + 1./2.)*(zeta/2. + 1./2.)*(xi + 1.)*(xi + 1.)/(2.*2.) + 27.*(eta/2. + 1./2.)*((zeta + 1.)*(zeta + 1.)/(2.*2.))*((xi + 1.)*(xi + 1.)/(2.*2.)) - 4.*(xi/2. + 1./2.)*(zeta/2. + 1./2.) + 6.*(xi/2. + 1./2.)*((zeta + 1.)*(zeta + 1.)/(2.*2.)) + 6.*(zeta/2. + 1./2.)*((xi + 1.)*(xi + 1.)/(2.*2.)) - 9.*(zeta + 1.)*(zeta + 1.)/(2.*2.)*(xi + 1.)*(xi + 1.)/(2.*2.), 0.);
                case 20:
                  return sign * RealGradient(-12.*(eta/2. + 1./2.)*(xi/2. + 1./2.)*(zeta/2. + 1./2.) + 18.*(eta/2. + 1./2.)*(xi/2. + 1./2.)*((zeta + 1.)*(zeta + 1.)/(2.*2.)) + 4.*(eta/2. + 1./2.)*(zeta/2. + 1./2.) - 6.*(eta/2. + 1./2.)*(zeta + 1.)*(zeta + 1.)/(2.*2.) + 18.*(xi/2. + 1./2.)*(zeta/2. + 1./2.)*((eta + 1.)*(eta + 1.)/(2.*2.)) - 27.*(xi/2. + 1./2.)*(zeta + 1.)*(zeta + 1.)/(2.*2.)*(eta + 1.)*(eta + 1.)/(2.*2.) - 6.*(zeta/2. + 1./2.)*(eta + 1.)*(eta + 1.)/(2.*2.) + 9.*((zeta + 1.)*(zeta + 1.)/(2.*2.))*((eta + 1.)*(eta + 1.)/(2.*2.)), 0., 0.);
                case 21:
                  return sign * RealGradient(12.*(eta/2. + 1./2.)*(xi/2. + 1./2.)*(zeta/2. + 1./2.) - 18.*(eta/2. + 1./2.)*(xi/2. + 1./2.)*(zeta + 1.)*(zeta + 1.)/(2.*2.) - 8.*(eta/2. + 1./2.)*(zeta/2. + 1./2.) + 12.*(eta/2. + 1./2.)*((zeta + 1.)*(zeta + 1.)/(2.*2.)) - 18.*(xi/2. + 1./2.)*(zeta/2. + 1./2.)*(eta + 1.)*(eta + 1.)/(2.*2.) + 27.*(xi/2. + 1./2.)*((zeta + 1.)*(zeta + 1.)/(2.*2.))*((eta + 1.)*(eta + 1.)/(2.*2.)) + 12.*(zeta/2. + 1./2.)*((eta + 1.)*(eta + 1.)/(2.*2.)) - 18.*(zeta + 1.)*(zeta + 1.)/(2.*2.)*(eta + 1.)*(eta + 1.)/(2.*2.), 0., 0.);
                case 22:
                  return sign * RealGradient(0., -2.*zeta - 24.*(eta/2. + 1./2.)*(xi/2. + 1./2.)*(zeta/2. + 1./2.) + 36.*(eta/2. + 1./2.)*(xi/2. + 1./2.)*((zeta + 1.)*(zeta + 1.)/(2.*2.)) + 6.*(eta/2. + 1./2.)*(zeta/2. + 1./2.) + 18.*(eta/2. + 1./2.)*(zeta/2. + 1./2.)*((xi + 1.)*(xi + 1.)/(2.*2.)) - 9.*(eta/2. + 1./2.)*(zeta + 1.)*(zeta + 1.)/(2.*2.) - 27.*(eta/2. + 1./2.)*(zeta + 1.)*(zeta + 1.)/(2.*2.)*(xi + 1.)*(xi + 1.)/(2.*2.) + 16.*(xi/2. + 1./2.)*(zeta/2. + 1./2.) - 24.*(xi/2. + 1./2.)*(zeta + 1.)*(zeta + 1.)/(2.*2.) - 12.*(zeta/2. + 1./2.)*(xi + 1.)*(xi + 1.)/(2.*2.) - 2. + 6.*((zeta + 1.)*(zeta + 1.)/(2.*2.)) + 18.*((zeta + 1.)*(zeta + 1.)/(2.*2.))*((xi + 1.)*(xi + 1.)/(2.*2.)), 0.);
                case 23:
                  return sign * RealGradient(0., zeta + 24.*(eta/2. + 1./2.)*(xi/2. + 1./2.)*(zeta/2. + 1./2.) - 36.*(eta/2. + 1./2.)*(xi/2. + 1./2.)*(zeta + 1.)*(zeta + 1.)/(2.*2.) - 6.*(eta/2. + 1./2.)*(zeta/2. + 1./2.) - 18.*(eta/2. + 1./2.)*(zeta/2. + 1./2.)*(xi + 1.)*(xi + 1.)/(2.*2.) + 9.*(eta/2. + 1./2.)*((zeta + 1.)*(zeta + 1.)/(2.*2.)) + 27.*(eta/2. + 1./2.)*((zeta + 1.)*(zeta + 1.)/(2.*2.))*((xi + 1.)*(xi + 1.)/(2.*2.)) - 8.*(xi/2. + 1./2.)*(zeta/2. + 1./2.) + 12.*(xi/2. + 1./2.)*((zeta + 1.)*(zeta + 1.)/(2.*2.)) + 6.*(zeta/2. + 1./2.)*((xi + 1.)*(xi + 1.)/(2.*2.)) + 1. - 3.*(zeta + 1.)*(zeta + 1.)/(2.*2.) - 9.*(zeta + 1.)*(zeta + 1.)/(2.*2.)*(xi + 1.)*(xi + 1.)/(2.*2.), 0.);
                case 24:
                  return RealGradient(0., 6.*xi + 72.*(eta/2. + 1./2.)*(xi/2. + 1./2.)*(zeta/2. + 1./2.) - 18.*(eta/2. + 1./2.)*(xi/2. + 1./2.) - 54.*(eta/2. + 1./2.)*(xi/2. + 1./2.)*(zeta + 1.)*(zeta + 1.)/(2.*2.) - 72.*(eta/2. + 1./2.)*(zeta/2. + 1./2.)*(xi + 1.)*(xi + 1.)/(2.*2.) + 18.*(eta/2. + 1./2.)*((xi + 1.)*(xi + 1.)/(2.*2.)) + 54.*(eta/2. + 1./2.)*((zeta + 1.)*(zeta + 1.)/(2.*2.))*((xi + 1.)*(xi + 1.)/(2.*2.)) - 48.*(xi/2. + 1./2.)*(zeta/2. + 1./2.) + 36.*(xi/2. + 1./2.)*((zeta + 1.)*(zeta + 1.)/(2.*2.)) + 48.*(zeta/2. + 1./2.)*((xi + 1.)*(xi + 1.)/(2.*2.)) + 6. - 12.*(xi + 1.)*(xi + 1.)/(2.*2.) - 36.*(zeta + 1.)*(zeta + 1.)/(2.*2.)*(xi + 1.)*(xi + 1.)/(2.*2.), 0.);
                case 25:
                  return RealGradient(-6.*eta - 72.*(eta/2. + 1./2.)*(xi/2. + 1./2.)*(zeta/2. + 1./2.) + 18.*(eta/2. + 1./2.)*(xi/2. + 1./2.) + 54.*(eta/2. + 1./2.)*(xi/2. + 1./2.)*((zeta + 1.)*(zeta + 1.)/(2.*2.)) + 48.*(eta/2. + 1./2.)*(zeta/2. + 1./2.) - 36.*(eta/2. + 1./2.)*(zeta + 1.)*(zeta + 1.)/(2.*2.) + 72.*(xi/2. + 1./2.)*(zeta/2. + 1./2.)*((eta + 1.)*(eta + 1.)/(2.*2.)) - 18.*(xi/2. + 1./2.)*(eta + 1.)*(eta + 1.)/(2.*2.) - 54.*(xi/2. + 1./2.)*(zeta + 1.)*(zeta + 1.)/(2.*2.)*(eta + 1.)*(eta + 1.)/(2.*2.) - 48.*(zeta/2. + 1./2.)*(eta + 1.)*(eta + 1.)/(2.*2.) - 6. + 12.*((eta + 1.)*(eta + 1.)/(2.*2.)) + 36.*((zeta + 1.)*(zeta + 1.)/(2.*2.))*((eta + 1.)*(eta + 1.)/(2.*2.)), 0., 0.);
                case 26:
                  return RealGradient(3.*eta + 72.*(eta/2. + 1./2.)*(xi/2. + 1./2.)*(zeta/2. + 1./2.) - 18.*(eta/2. + 1./2.)*(xi/2. + 1./2.) - 54.*(eta/2. + 1./2.)*(xi/2. + 1./2.)*(zeta + 1.)*(zeta + 1.)/(2.*2.) - 24.*(eta/2. + 1./2.)*(zeta/2. + 1./2.) + 18.*(eta/2. + 1./2.)*((zeta + 1.)*(zeta + 1.)/(2.*2.)) - 72.*(xi/2. + 1./2.)*(zeta/2. + 1./2.)*(eta + 1.)*(eta + 1.)/(2.*2.) + 18.*(xi/2. + 1./2.)*((eta + 1.)*(eta + 1.)/(2.*2.)) + 54.*(xi/2. + 1./2.)*((zeta + 1.)*(zeta + 1.)/(2.*2.))*((eta + 1.)*(eta + 1.)/(2.*2.)) + 24.*(zeta/2. + 1./2.)*((eta + 1.)*(eta + 1.)/(2.*2.)) + 3. - 6.*(eta + 1.)*(eta + 1.)/(2.*2.) - 18.*(zeta + 1.)*(zeta + 1.)/(2.*2.)*(eta + 1.)*(eta + 1.)/(2.*2.), 0., 0.);
                case 27:
                  return RealGradient(0., -3.*xi - 72.*(eta/2. + 1./2.)*(xi/2. + 1./2.)*(zeta/2. + 1./2.) + 18.*(eta/2. + 1./2.)*(xi/2. + 1./2.) + 54.*(eta/2. + 1./2.)*(xi/2. + 1./2.)*((zeta + 1.)*(zeta + 1.)/(2.*2.)) + 72.*(eta/2. + 1./2.)*(zeta/2. + 1./2.)*((xi + 1.)*(xi + 1.)/(2.*2.)) - 18.*(eta/2. + 1./2.)*(xi + 1.)*(xi + 1.)/(2.*2.) - 54.*(eta/2. + 1./2.)*(zeta + 1.)*(zeta + 1.)/(2.*2.)*(xi + 1.)*(xi + 1.)/(2.*2.) + 24.*(xi/2. + 1./2.)*(zeta/2. + 1./2.) - 18.*(xi/2. + 1./2.)*(zeta + 1.)*(zeta + 1.)/(2.*2.) - 24.*(zeta/2. + 1./2.)*(xi + 1.)*(xi + 1.)/(2.*2.) - 3. + 6.*((xi + 1.)*(xi + 1.)/(2.*2.)) + 18.*((zeta + 1.)*(zeta + 1.)/(2.*2.))*((xi + 1.)*(xi + 1.)/(2.*2.)), 0.);
                case 28:
                  return RealGradient(0., 0., 6.*xi + 72.*(eta/2. + 1./2.)*(xi/2. + 1./2.)*(zeta/2. + 1./2.) - 48.*(eta/2. + 1./2.)*(xi/2. + 1./2.) - 72.*(eta/2. + 1./2.)*(zeta/2. + 1./2.)*(xi + 1.)*(xi + 1.)/(2.*2.) + 48.*(eta/2. + 1./2.)*((xi + 1.)*(xi + 1.)/(2.*2.)) - 18.*(xi/2. + 1./2.)*(zeta/2. + 1./2.) - 54.*(xi/2. + 1./2.)*(zeta/2. + 1./2.)*(eta + 1.)*(eta + 1.)/(2.*2.) + 36.*(xi/2. + 1./2.)*((eta + 1.)*(eta + 1.)/(2.*2.)) + 54.*(zeta/2. + 1./2.)*((eta + 1.)*(eta + 1.)/(2.*2.))*((xi + 1.)*(xi + 1.)/(2.*2.)) + 18.*(zeta/2. + 1./2.)*((xi + 1.)*(xi + 1.)/(2.*2.)) + 6. - 36.*(eta + 1.)*(eta + 1.)/(2.*2.)*(xi + 1.)*(xi + 1.)/(2.*2.) - 12.*(xi + 1.)*(xi + 1.)/(2.*2.));
                case 29:
                  return RealGradient(-6.*zeta - 72.*(eta/2. + 1./2.)*(xi/2. + 1./2.)*(zeta/2. + 1./2.) + 72.*(eta/2. + 1./2.)*(xi/2. + 1./2.)*((zeta + 1.)*(zeta + 1.)/(2.*2.)) + 48.*(eta/2. + 1./2.)*(zeta/2. + 1./2.) - 48.*(eta/2. + 1./2.)*(zeta + 1.)*(zeta + 1.)/(2.*2.) + 18.*(xi/2. + 1./2.)*(zeta/2. + 1./2.) + 54.*(xi/2. + 1./2.)*(zeta/2. + 1./2.)*((eta + 1.)*(eta + 1.)/(2.*2.)) - 18.*(xi/2. + 1./2.)*(zeta + 1.)*(zeta + 1.)/(2.*2.) - 54.*(xi/2. + 1./2.)*(zeta + 1.)*(zeta + 1.)/(2.*2.)*(eta + 1.)*(eta + 1.)/(2.*2.) - 36.*(zeta/2. + 1./2.)*(eta + 1.)*(eta + 1.)/(2.*2.) - 6. + 12.*((zeta + 1.)*(zeta + 1.)/(2.*2.)) + 36.*((zeta + 1.)*(zeta + 1.)/(2.*2.))*((eta + 1.)*(eta + 1.)/(2.*2.)), 0., 0.);
                case 30:
                  return RealGradient(3.*zeta + 72.*(eta/2. + 1./2.)*(xi/2. + 1./2.)*(zeta/2. + 1./2.) - 72.*(eta/2. + 1./2.)*(xi/2. + 1./2.)*(zeta + 1.)*(zeta + 1.)/(2.*2.) - 24.*(eta/2. + 1./2.)*(zeta/2. + 1./2.) + 24.*(eta/2. + 1./2.)*((zeta + 1.)*(zeta + 1.)/(2.*2.)) - 18.*(xi/2. + 1./2.)*(zeta/2. + 1./2.) - 54.*(xi/2. + 1./2.)*(zeta/2. + 1./2.)*(eta + 1.)*(eta + 1.)/(2.*2.) + 18.*(xi/2. + 1./2.)*((zeta + 1.)*(zeta + 1.)/(2.*2.)) + 54.*(xi/2. + 1./2.)*((zeta + 1.)*(zeta + 1.)/(2.*2.))*((eta + 1.)*(eta + 1.)/(2.*2.)) + 18.*(zeta/2. + 1./2.)*((eta + 1.)*(eta + 1.)/(2.*2.)) + 3. - 6.*(zeta + 1.)*(zeta + 1.)/(2.*2.) - 18.*(zeta + 1.)*(zeta + 1.)/(2.*2.)*(eta + 1.)*(eta + 1.)/(2.*2.), 0., 0.);
                case 31:
                  return RealGradient(0., 0., -3.*xi - 72.*(eta/2. + 1./2.)*(xi/2. + 1./2.)*(zeta/2. + 1./2.) + 24.*(eta/2. + 1./2.)*(xi/2. + 1./2.) + 72.*(eta/2. + 1./2.)*(zeta/2. + 1./2.)*((xi + 1.)*(xi + 1.)/(2.*2.)) - 24.*(eta/2. + 1./2.)*(xi + 1.)*(xi + 1.)/(2.*2.) + 18.*(xi/2. + 1./2.)*(zeta/2. + 1./2.) + 54.*(xi/2. + 1./2.)*(zeta/2. + 1./2.)*((eta + 1.)*(eta + 1.)/(2.*2.)) - 18.*(xi/2. + 1./2.)*(eta + 1.)*(eta + 1.)/(2.*2.) - 54.*(zeta/2. + 1./2.)*(eta + 1.)*(eta + 1.)/(2.*2.)*(xi + 1.)*(xi + 1.)/(2.*2.) - 18.*(zeta/2. + 1./2.)*(xi + 1.)*(xi + 1.)/(2.*2.) - 3. + 18.*((eta + 1.)*(eta + 1.)/(2.*2.))*((xi + 1.)*(xi + 1.)/(2.*2.)) + 6.*((xi + 1.)*(xi + 1.)/(2.*2.)));
                case 32:
                  return RealGradient(0., 0., 36.*(eta/2. + 1./2.)*(xi/2. + 1./2.)*(zeta/2. + 1./2.) - 24.*(eta/2. + 1./2.)*(xi/2. + 1./2.) - 54.*(eta/2. + 1./2.)*(zeta/2. + 1./2.)*(xi + 1.)*(xi + 1.)/(2.*2.) + 36.*(eta/2. + 1./2.)*((xi + 1.)*(xi + 1.)/(2.*2.)) - 36.*(xi/2. + 1./2.)*(zeta/2. + 1./2.)*(eta + 1.)*(eta + 1.)/(2.*2.) + 24.*(xi/2. + 1./2.)*((eta + 1.)*(eta + 1.)/(2.*2.)) + 54.*(zeta/2. + 1./2.)*((eta + 1.)*(eta + 1.)/(2.*2.))*((xi + 1.)*(xi + 1.)/(2.*2.)) - 36.*(eta + 1.)*(eta + 1.)/(2.*2.)*(xi + 1.)*(xi + 1.)/(2.*2.));
                case 33:
                  return RealGradient(0., -36.*(eta/2. + 1./2.)*(xi/2. + 1./2.)*(zeta/2. + 1./2.) + 36.*(eta/2. + 1./2.)*(xi/2. + 1./2.)*((zeta + 1.)*(zeta + 1.)/(2.*2.)) + 54.*(eta/2. + 1./2.)*(zeta/2. + 1./2.)*((xi + 1.)*(xi + 1.)/(2.*2.)) - 54.*(eta/2. + 1./2.)*(zeta + 1.)*(zeta + 1.)/(2.*2.)*(xi + 1.)*(xi + 1.)/(2.*2.) + 24.*(xi/2. + 1./2.)*(zeta/2. + 1./2.) - 24.*(xi/2. + 1./2.)*(zeta + 1.)*(zeta + 1.)/(2.*2.) - 36.*(zeta/2. + 1./2.)*(xi + 1.)*(xi + 1.)/(2.*2.) + 36.*((zeta + 1.)*(zeta + 1.)/(2.*2.))*((xi + 1.)*(xi + 1.)/(2.*2.)), 0.);
                case 34:
                  return RealGradient(0., 36.*(eta/2. + 1./2.)*(xi/2. + 1./2.)*(zeta/2. + 1./2.) - 36.*(eta/2. + 1./2.)*(xi/2. + 1./2.)*(zeta + 1.)*(zeta + 1.)/(2.*2.) - 54.*(eta/2. + 1./2.)*(zeta/2. + 1./2.)*(xi + 1.)*(xi + 1.)/(2.*2.) + 54.*(eta/2. + 1./2.)*((zeta + 1.)*(zeta + 1.)/(2.*2.))*((xi + 1.)*(xi + 1.)/(2.*2.)) - 12.*(xi/2. + 1./2.)*(zeta/2. + 1./2.) + 12.*(xi/2. + 1./2.)*((zeta + 1.)*(zeta + 1.)/(2.*2.)) + 18.*(zeta/2. + 1./2.)*((xi + 1.)*(xi + 1.)/(2.*2.)) - 18.*(zeta + 1.)*(zeta + 1.)/(2.*2.)*(xi + 1.)*(xi + 1.)/(2.*2.), 0.);
                case 35:
                  return RealGradient(0., 0., -36.*(eta/2. + 1./2.)*(xi/2. + 1./2.)*(zeta/2. + 1./2.) + 12.*(eta/2. + 1./2.)*(xi/2. + 1./2.) + 54.*(eta/2. + 1./2.)*(zeta/2. + 1./2.)*((xi + 1.)*(xi + 1.)/(2.*2.)) - 18.*(eta/2. + 1./2.)*(xi + 1.)*(xi + 1.)/(2.*2.) + 36.*(xi/2. + 1./2.)*(zeta/2. + 1./2.)*((eta + 1.)*(eta + 1.)/(2.*2.)) - 12.*(xi/2. + 1./2.)*(eta + 1.)*(eta + 1.)/(2.*2.) - 54.*(zeta/2. + 1./2.)*(eta + 1.)*(eta + 1.)/(2.*2.)*(xi + 1.)*(xi + 1.)/(2.*2.) + 18.*((eta + 1.)*(eta + 1.)/(2.*2.))*((xi + 1.)*(xi + 1.)/(2.*2.)));
                case 36:
                  return RealGradient(0., 0., 36.*(eta/2. + 1./2.)*(xi/2. + 1./2.)*(zeta/2. + 1./2.) - 24.*(eta/2. + 1./2.)*(xi/2. + 1./2.) - 36.*(eta/2. + 1./2.)*(zeta/2. + 1./2.)*(xi + 1.)*(xi + 1.)/(2.*2.) + 24.*(eta/2. + 1./2.)*((xi + 1.)*(xi + 1.)/(2.*2.)) - 54.*(xi/2. + 1./2.)*(zeta/2. + 1./2.)*(eta + 1.)*(eta + 1.)/(2.*2.) + 36.*(xi/2. + 1./2.)*((eta + 1.)*(eta + 1.)/(2.*2.)) + 54.*(zeta/2. + 1./2.)*((eta + 1.)*(eta + 1.)/(2.*2.))*((xi + 1.)*(xi + 1.)/(2.*2.)) - 36.*(eta + 1.)*(eta + 1.)/(2.*2.)*(xi + 1.)*(xi + 1.)/(2.*2.));
                case 37:
                  return RealGradient(-36.*(eta/2. + 1./2.)*(xi/2. + 1./2.)*(zeta/2. + 1./2.) + 36.*(eta/2. + 1./2.)*(xi/2. + 1./2.)*((zeta + 1.)*(zeta + 1.)/(2.*2.)) + 24.*(eta/2. + 1./2.)*(zeta/2. + 1./2.) - 24.*(eta/2. + 1./2.)*(zeta + 1.)*(zeta + 1.)/(2.*2.) + 54.*(xi/2. + 1./2.)*(zeta/2. + 1./2.)*((eta + 1.)*(eta + 1.)/(2.*2.)) - 54.*(xi/2. + 1./2.)*(zeta + 1.)*(zeta + 1.)/(2.*2.)*(eta + 1.)*(eta + 1.)/(2.*2.) - 36.*(zeta/2. + 1./2.)*(eta + 1.)*(eta + 1.)/(2.*2.) + 36.*((zeta + 1.)*(zeta + 1.)/(2.*2.))*((eta + 1.)*(eta + 1.)/(2.*2.)), 0., 0.);
                case 38:
                  return RealGradient(36.*(eta/2. + 1./2.)*(xi/2. + 1./2.)*(zeta/2. + 1./2.) - 36.*(eta/2. + 1./2.)*(xi/2. + 1./2.)*(zeta + 1.)*(zeta + 1.)/(2.*2.) - 12.*(eta/2. + 1./2.)*(zeta/2. + 1./2.) + 12.*(eta/2. + 1./2.)*((zeta + 1.)*(zeta + 1.)/(2.*2.)) - 54.*(xi/2. + 1./2.)*(zeta/2. + 1./2.)*(eta + 1.)*(eta + 1.)/(2.*2.) + 54.*(xi/2. + 1./2.)*((zeta + 1.)*(zeta + 1.)/(2.*2.))*((eta + 1.)*(eta + 1.)/(2.*2.)) + 18.*(zeta/2. + 1./2.)*((eta + 1.)*(eta + 1.)/(2.*2.)) - 18.*(zeta + 1.)*(zeta + 1.)/(2.*2.)*(eta + 1.)*(eta + 1.)/(2.*2.), 0., 0.);
                case 39:
                  return RealGradient(0., 0., -36.*(eta/2. + 1./2.)*(xi/2. + 1./2.)*(zeta/2. + 1./2.) + 12.*(eta/2. + 1./2.)*(xi/2. + 1./2.) + 36.*(eta/2. + 1./2.)*(zeta/2. + 1./2.)*((xi + 1.)*(xi + 1.)/(2.*2.)) - 12.*(eta/2. + 1./2.)*(xi + 1.)*(xi + 1.)/(2.*2.) + 54.*(xi/2. + 1./2.)*(zeta/2. + 1./2.)*((eta + 1.)*(eta + 1.)/(2.*2.)) - 18.*(xi/2. + 1./2.)*(eta + 1.)*(eta + 1.)/(2.*2.) - 54.*(zeta/2. + 1./2.)*(eta + 1.)*(eta + 1.)/(2.*2.)*(xi + 1.)*(xi + 1.)/(2.*2.) + 18.*((eta + 1.)*(eta + 1.)/(2.*2.))*((xi + 1.)*(xi + 1.)/(2.*2.)));
                case 40:
                  return RealGradient(0., 0., 6.*eta + 72.*(eta/2. + 1./2.)*(xi/2. + 1./2.)*(zeta/2. + 1./2.) - 48.*(eta/2. + 1./2.)*(xi/2. + 1./2.) - 18.*(eta/2. + 1./2.)*(zeta/2. + 1./2.) - 54.*(eta/2. + 1./2.)*(zeta/2. + 1./2.)*(xi + 1.)*(xi + 1.)/(2.*2.) + 36.*(eta/2. + 1./2.)*((xi + 1.)*(xi + 1.)/(2.*2.)) - 72.*(xi/2. + 1./2.)*(zeta/2. + 1./2.)*(eta + 1.)*(eta + 1.)/(2.*2.) + 48.*(xi/2. + 1./2.)*((eta + 1.)*(eta + 1.)/(2.*2.)) + 18.*(zeta/2. + 1./2.)*((eta + 1.)*(eta + 1.)/(2.*2.)) + 54.*(zeta/2. + 1./2.)*((eta + 1.)*(eta + 1.)/(2.*2.))*((xi + 1.)*(xi + 1.)/(2.*2.)) + 6. - 12.*(eta + 1.)*(eta + 1.)/(2.*2.) - 36.*(eta + 1.)*(eta + 1.)/(2.*2.)*(xi + 1.)*(xi + 1.)/(2.*2.));
                case 41:
                  return RealGradient(0., -6.*zeta - 72.*(eta/2. + 1./2.)*(xi/2. + 1./2.)*(zeta/2. + 1./2.) + 72.*(eta/2. + 1./2.)*(xi/2. + 1./2.)*((zeta + 1.)*(zeta + 1.)/(2.*2.)) + 18.*(eta/2. + 1./2.)*(zeta/2. + 1./2.) + 54.*(eta/2. + 1./2.)*(zeta/2. + 1./2.)*((xi + 1.)*(xi + 1.)/(2.*2.)) - 18.*(eta/2. + 1./2.)*(zeta + 1.)*(zeta + 1.)/(2.*2.) - 54.*(eta/2. + 1./2.)*(zeta + 1.)*(zeta + 1.)/(2.*2.)*(xi + 1.)*(xi + 1.)/(2.*2.) + 48.*(xi/2. + 1./2.)*(zeta/2. + 1./2.) - 48.*(xi/2. + 1./2.)*(zeta + 1.)*(zeta + 1.)/(2.*2.) - 36.*(zeta/2. + 1./2.)*(xi + 1.)*(xi + 1.)/(2.*2.) - 6. + 12.*((zeta + 1.)*(zeta + 1.)/(2.*2.)) + 36.*((zeta + 1.)*(zeta + 1.)/(2.*2.))*((xi + 1.)*(xi + 1.)/(2.*2.)), 0.);
                case 42:
                  return RealGradient(0., 3.*zeta + 72.*(eta/2. + 1./2.)*(xi/2. + 1./2.)*(zeta/2. + 1./2.) - 72.*(eta/2. + 1./2.)*(xi/2. + 1./2.)*(zeta + 1.)*(zeta + 1.)/(2.*2.) - 18.*(eta/2. + 1./2.)*(zeta/2. + 1./2.) - 54.*(eta/2. + 1./2.)*(zeta/2. + 1./2.)*(xi + 1.)*(xi + 1.)/(2.*2.) + 18.*(eta/2. + 1./2.)*((zeta + 1.)*(zeta + 1.)/(2.*2.)) + 54.*(eta/2. + 1./2.)*((zeta + 1.)*(zeta + 1.)/(2.*2.))*((xi + 1.)*(xi + 1.)/(2.*2.)) - 24.*(xi/2. + 1./2.)*(zeta/2. + 1./2.) + 24.*(xi/2. + 1./2.)*((zeta + 1.)*(zeta + 1.)/(2.*2.)) + 18.*(zeta/2. + 1./2.)*((xi + 1.)*(xi + 1.)/(2.*2.)) + 3. - 6.*(zeta + 1.)*(zeta + 1.)/(2.*2.) - 18.*(zeta + 1.)*(zeta + 1.)/(2.*2.)*(xi + 1.)*(xi + 1.)/(2.*2.), 0.);
                case 43:
                  return RealGradient(0., 0., -3.*eta - 72.*(eta/2. + 1./2.)*(xi/2. + 1./2.)*(zeta/2. + 1./2.) + 24.*(eta/2. + 1./2.)*(xi/2. + 1./2.) + 18.*(eta/2. + 1./2.)*(zeta/2. + 1./2.) + 54.*(eta/2. + 1./2.)*(zeta/2. + 1./2.)*((xi + 1.)*(xi + 1.)/(2.*2.)) - 18.*(eta/2. + 1./2.)*(xi + 1.)*(xi + 1.)/(2.*2.) + 72.*(xi/2. + 1./2.)*(zeta/2. + 1./2.)*((eta + 1.)*(eta + 1.)/(2.*2.)) - 24.*(xi/2. + 1./2.)*(eta + 1.)*(eta + 1.)/(2.*2.) - 18.*(zeta/2. + 1./2.)*(eta + 1.)*(eta + 1.)/(2.*2.) - 54.*(zeta/2. + 1./2.)*(eta + 1.)*(eta + 1.)/(2.*2.)*(xi + 1.)*(xi + 1.)/(2.*2.) - 3. + 6.*((eta + 1.)*(eta + 1.)/(2.*2.)) + 18.*((eta + 1.)*(eta + 1.)/(2.*2.))*((xi + 1.)*(xi + 1.)/(2.*2.)));
                case 44:
                  return RealGradient(0., 36.*(eta/2. + 1./2.)*(xi/2. + 1./2.)*(zeta/2. + 1./2.) - 54.*(eta/2. + 1./2.)*(xi/2. + 1./2.)*(zeta + 1.)*(zeta + 1.)/(2.*2.) - 36.*(eta/2. + 1./2.)*(zeta/2. + 1./2.)*(xi + 1.)*(xi + 1.)/(2.*2.) + 54.*(eta/2. + 1./2.)*((zeta + 1.)*(zeta + 1.)/(2.*2.))*((xi + 1.)*(xi + 1.)/(2.*2.)) - 24.*(xi/2. + 1./2.)*(zeta/2. + 1./2.) + 36.*(xi/2. + 1./2.)*((zeta + 1.)*(zeta + 1.)/(2.*2.)) + 24.*(zeta/2. + 1./2.)*((xi + 1.)*(xi + 1.)/(2.*2.)) - 36.*(zeta + 1.)*(zeta + 1.)/(2.*2.)*(xi + 1.)*(xi + 1.)/(2.*2.), 0.);
                case 45:
                  return RealGradient(-36.*(eta/2. + 1./2.)*(xi/2. + 1./2.)*(zeta/2. + 1./2.) + 54.*(eta/2. + 1./2.)*(xi/2. + 1./2.)*((zeta + 1.)*(zeta + 1.)/(2.*2.)) + 24.*(eta/2. + 1./2.)*(zeta/2. + 1./2.) - 36.*(eta/2. + 1./2.)*(zeta + 1.)*(zeta + 1.)/(2.*2.) + 36.*(xi/2. + 1./2.)*(zeta/2. + 1./2.)*((eta + 1.)*(eta + 1.)/(2.*2.)) - 54.*(xi/2. + 1./2.)*(zeta + 1.)*(zeta + 1.)/(2.*2.)*(eta + 1.)*(eta + 1.)/(2.*2.) - 24.*(zeta/2. + 1./2.)*(eta + 1.)*(eta + 1.)/(2.*2.) + 36.*((zeta + 1.)*(zeta + 1.)/(2.*2.))*((eta + 1.)*(eta + 1.)/(2.*2.)), 0., 0.);
                case 46:
                  return RealGradient(36.*(eta/2. + 1./2.)*(xi/2. + 1./2.)*(zeta/2. + 1./2.) - 54.*(eta/2. + 1./2.)*(xi/2. + 1./2.)*(zeta + 1.)*(zeta + 1.)/(2.*2.) - 12.*(eta/2. + 1./2.)*(zeta/2. + 1./2.) + 18.*(eta/2. + 1./2.)*((zeta + 1.)*(zeta + 1.)/(2.*2.)) - 36.*(xi/2. + 1./2.)*(zeta/2. + 1./2.)*(eta + 1.)*(eta + 1.)/(2.*2.) + 54.*(xi/2. + 1./2.)*((zeta + 1.)*(zeta + 1.)/(2.*2.))*((eta + 1.)*(eta + 1.)/(2.*2.)) + 12.*(zeta/2. + 1./2.)*((eta + 1.)*(eta + 1.)/(2.*2.)) - 18.*(zeta + 1.)*(zeta + 1.)/(2.*2.)*(eta + 1.)*(eta + 1.)/(2.*2.), 0., 0.);
                case 47:
                  return RealGradient(0., -36.*(eta/2. + 1./2.)*(xi/2. + 1./2.)*(zeta/2. + 1./2.) + 54.*(eta/2. + 1./2.)*(xi/2. + 1./2.)*((zeta + 1.)*(zeta + 1.)/(2.*2.)) + 36.*(eta/2. + 1./2.)*(zeta/2. + 1./2.)*((xi + 1.)*(xi + 1.)/(2.*2.)) - 54.*(eta/2. + 1./2.)*(zeta + 1.)*(zeta + 1.)/(2.*2.)*(xi + 1.)*(xi + 1.)/(2.*2.) + 12.*(xi/2. + 1./2.)*(zeta/2. + 1./2.) - 18.*(xi/2. + 1./2.)*(zeta + 1.)*(zeta + 1.)/(2.*2.) - 12.*(zeta/2. + 1./2.)*(xi + 1.)*(xi + 1.)/(2.*2.) + 18.*((zeta + 1.)*(zeta + 1.)/(2.*2.))*((xi + 1.)*(xi + 1.)/(2.*2.)), 0.);
                case 48:
                  return RealGradient(0., 0., -108.*(eta/2. + 1./2.)*(xi/2. + 1./2.)*(zeta/2. + 1./2.) + 72.*(eta/2. + 1./2.)*(xi/2. + 1./2.) + 108.*(eta/2. + 1./2.)*(zeta/2. + 1./2.)*((xi + 1.)*(xi + 1.)/(2.*2.)) - 72.*(eta/2. + 1./2.)*(xi + 1.)*(xi + 1.)/(2.*2.) + 108.*(xi/2. + 1./2.)*(zeta/2. + 1./2.)*((eta + 1.)*(eta + 1.)/(2.*2.)) - 72.*(xi/2. + 1./2.)*(eta + 1.)*(eta + 1.)/(2.*2.) - 108.*(zeta/2. + 1./2.)*(eta + 1.)*(eta + 1.)/(2.*2.)*(xi + 1.)*(xi + 1.)/(2.*2.) + 72.*((eta + 1.)*(eta + 1.)/(2.*2.))*((xi + 1.)*(xi + 1.)/(2.*2.)));
                case 49:
                  return RealGradient(0., 108.*(eta/2. + 1./2.)*(xi/2. + 1./2.)*(zeta/2. + 1./2.) - 108.*(eta/2. + 1./2.)*(xi/2. + 1./2.)*(zeta + 1.)*(zeta + 1.)/(2.*2.) - 108.*(eta/2. + 1./2.)*(zeta/2. + 1./2.)*(xi + 1.)*(xi + 1.)/(2.*2.) + 108.*(eta/2. + 1./2.)*((zeta + 1.)*(zeta + 1.)/(2.*2.))*((xi + 1.)*(xi + 1.)/(2.*2.)) - 72.*(xi/2. + 1./2.)*(zeta/2. + 1./2.) + 72.*(xi/2. + 1./2.)*((zeta + 1.)*(zeta + 1.)/(2.*2.)) + 72.*(zeta/2. + 1./2.)*((xi + 1.)*(xi + 1.)/(2.*2.)) - 72.*(zeta + 1.)*(zeta + 1.)/(2.*2.)*(xi + 1.)*(xi + 1.)/(2.*2.), 0.);
                case 50:
                  return RealGradient(-108.*(eta/2. + 1./2.)*(xi/2. + 1./2.)*(zeta/2. + 1./2.) + 108.*(eta/2. + 1./2.)*(xi/2. + 1./2.)*((zeta + 1.)*(zeta + 1.)/(2.*2.)) + 72.*(eta/2. + 1./2.)*(zeta/2. + 1./2.) - 72.*(eta/2. + 1./2.)*(zeta + 1.)*(zeta + 1.)/(2.*2.) + 108.*(xi/2. + 1./2.)*(zeta/2. + 1./2.)*((eta + 1.)*(eta + 1.)/(2.*2.)) - 108.*(xi/2. + 1./2.)*(zeta + 1.)*(zeta + 1.)/(2.*2.)*(eta + 1.)*(eta + 1.)/(2.*2.) - 72.*(zeta/2. + 1./2.)*(eta + 1.)*(eta + 1.)/(2.*2.) + 72.*((zeta + 1.)*(zeta + 1.)/(2.*2.))*((eta + 1.)*(eta + 1.)/(2.*2.)), 0., 0.);
                case 51:
                  return RealGradient(108.*(eta/2. + 1./2.)*(xi/2. + 1./2.)*(zeta/2. + 1./2.) - 108.*(eta/2. + 1./2.)*(xi/2. + 1./2.)*(zeta + 1.)*(zeta + 1.)/(2.*2.) - 36.*(eta/2. + 1./2.)*(zeta/2. + 1./2.) + 36.*(eta/2. + 1./2.)*((zeta + 1.)*(zeta + 1.)/(2.*2.)) - 108.*(xi/2. + 1./2.)*(zeta/2. + 1./2.)*(eta + 1.)*(eta + 1.)/(2.*2.) + 108.*(xi/2. + 1./2.)*((zeta + 1.)*(zeta + 1.)/(2.*2.))*((eta + 1.)*(eta + 1.)/(2.*2.)) + 36.*(zeta/2. + 1./2.)*((eta + 1.)*(eta + 1.)/(2.*2.)) - 36.*(zeta + 1.)*(zeta + 1.)/(2.*2.)*(eta + 1.)*(eta + 1.)/(2.*2.), 0., 0.);
                case 52:
                  return RealGradient(0., -108.*(eta/2. + 1./2.)*(xi/2. + 1./2.)*(zeta/2. + 1./2.) + 108.*(eta/2. + 1./2.)*(xi/2. + 1./2.)*((zeta + 1.)*(zeta + 1.)/(2.*2.)) + 108.*(eta/2. + 1./2.)*(zeta/2. + 1./2.)*((xi + 1.)*(xi + 1.)/(2.*2.)) - 108.*(eta/2. + 1./2.)*(zeta + 1.)*(zeta + 1.)/(2.*2.)*(xi + 1.)*(xi + 1.)/(2.*2.) + 36.*(xi/2. + 1./2.)*(zeta/2. + 1./2.) - 36.*(xi/2. + 1./2.)*(zeta + 1.)*(zeta + 1.)/(2.*2.) - 36.*(zeta/2. + 1./2.)*(xi + 1.)*(xi + 1.)/(2.*2.) + 36.*((zeta + 1.)*(zeta + 1.)/(2.*2.))*((xi + 1.)*(xi + 1.)/(2.*2.)), 0.);
                case 53:
                  return RealGradient(0., 0., 108.*(eta/2. + 1./2.)*(xi/2. + 1./2.)*(zeta/2. + 1./2.) - 36.*(eta/2. + 1./2.)*(xi/2. + 1./2.) - 108.*(eta/2. + 1./2.)*(zeta/2. + 1./2.)*(xi + 1.)*(xi + 1.)/(2.*2.) + 36.*(eta/2. + 1./2.)*((xi + 1.)*(xi + 1.)/(2.*2.)) - 108.*(xi/2. + 1./2.)*(zeta/2. + 1./2.)*(eta + 1.)*(eta + 1.)/(2.*2.) + 36.*(xi/2. + 1./2.)*((eta + 1.)*(eta + 1.)/(2.*2.)) + 108.*(zeta/2. + 1./2.)*((eta + 1.)*(eta + 1.)/(2.*2.))*((xi + 1.)*(xi + 1.)/(2.*2.)) - 36.*(eta + 1.)*(eta + 1.)/(2.*2.)*(xi + 1.)*(xi + 1.)/(2.*2.));
                default:
                  libmesh_error_msg("Invalid i = " << i);
                }
            }

          case TET14:
            {
              switch(ii)
                {
                case 0:
                  return sign * RealGradient(8.*eta*xi + 16.*eta*zeta - 12.*eta + 8.*xi*zeta - 6.*xi - 12.*zeta + 4. + 8.*(eta*eta) + 8.*(zeta*zeta), -8.*eta*xi - 8.*xi*zeta + 6.*xi - 8.*xi*xi, -8.*eta*xi - 8.*xi*zeta + 6.*xi - 8.*xi*xi);
                case 1:
                  return sign * RealGradient(-8.*eta*xi + 2.*eta - 8.*xi*zeta + 6.*xi + 2.*zeta - 2., -4.*xi + 8.*(xi*xi), -4.*xi + 8.*(xi*xi));
                case 2:
                  return sign * RealGradient(-8.*eta*xi + 2.*eta, -4.*xi + 8.*(xi*xi), 0.);
                case 3:
                  return sign * RealGradient(4.*eta - 8.*eta*eta, 8.*eta*xi - 2.*xi, 0.);
                case 4:
                  return sign * RealGradient(-8.*eta*xi - 8.*eta*zeta + 6.*eta - 8.*eta*eta, 8.*eta*xi + 8.*eta*zeta - 6.*eta + 16.*xi*zeta - 12.*xi - 12.*zeta + 4. + 8.*(xi*xi) + 8.*(zeta*zeta), -8.*eta*xi - 8.*eta*zeta + 6.*eta - 8.*eta*eta);
                case 5:
                  return sign * RealGradient(-4.*eta + 8.*(eta*eta), -8.*eta*xi - 8.*eta*zeta + 6.*eta + 2.*xi + 2.*zeta - 2., -4.*eta + 8.*(eta*eta));
                case 6:
                  return sign * RealGradient(-8.*eta*zeta - 8.*xi*zeta + 6.*zeta - 8.*zeta*zeta, -8.*eta*zeta - 8.*xi*zeta + 6.*zeta - 8.*zeta*zeta, 16.*eta*xi + 8.*eta*zeta - 12.*eta + 8.*xi*zeta - 12.*xi - 6.*zeta + 4. + 8.*(eta*eta) + 8.*(xi*xi));
                case 7:
                  return sign * RealGradient(-4.*zeta + 8.*(zeta*zeta), -4.*zeta + 8.*(zeta*zeta), -8.*eta*zeta + 2.*eta - 8.*xi*zeta + 2.*xi + 6.*zeta - 2.);
                case 8:
                  return sign * RealGradient(-8.*xi*zeta + 2.*zeta, 0., -4.*xi + 8.*(xi*xi));
                case 9:
                  return sign * RealGradient(4.*zeta - 8.*zeta*zeta, 0., 8.*xi*zeta - 2.*xi);
                case 10:
                  return sign * RealGradient(0., -8.*eta*zeta + 2.*zeta, -4.*eta + 8.*(eta*eta));
                case 11:
                  return sign * RealGradient(0., 4.*zeta - 8.*zeta*zeta, 8.*eta*zeta - 2.*eta);
                case 12:
                  return RealGradient(-8.*eta*xi - 16.*eta*zeta + 16.*eta - 16.*eta*eta, 16.*eta*xi + 8.*xi*zeta - 8.*xi + 8.*(xi*xi), 8.*eta*xi);
                case 13:
                  return RealGradient(16.*eta*xi + 8.*eta*zeta - 8.*eta + 8.*(eta*eta), -8.*eta*xi - 16.*xi*zeta + 16.*xi - 16.*xi*xi, 8.*eta*xi);
                case 14:
                  return RealGradient(-16.*eta*zeta - 8.*xi*zeta + 16.*zeta - 16.*zeta*zeta, 8.*xi*zeta, 8.*eta*xi + 16.*xi*zeta - 8.*xi + 8.*(xi*xi));
                case 15:
                  return RealGradient(8.*eta*zeta + 16.*xi*zeta - 8.*zeta + 8.*(zeta*zeta), 8.*xi*zeta, -16.*eta*xi - 8.*xi*zeta + 16.*xi - 16.*xi*xi);
                case 16:
                  return RealGradient(-8.*eta*zeta, 16.*xi*zeta, -8.*eta*xi);
                case 17:
                  return RealGradient(-8.*eta*zeta, -8.*xi*zeta, 16.*eta*xi);
                case 18:
                  return RealGradient(8.*eta*zeta, -8.*eta*zeta - 16.*xi*zeta + 16.*zeta - 16.*zeta*zeta, 8.*eta*xi + 16.*eta*zeta - 8.*eta + 8.*(eta*eta));
                case 19:
                  return RealGradient(8.*eta*zeta, 16.*eta*zeta + 8.*xi*zeta - 8.*zeta + 8.*(zeta*zeta), -16.*eta*xi - 8.*eta*zeta + 16.*eta - 16.*eta*eta);
                default:
                  libmesh_error_msg("Invalid i = " << i);
                }
            }

          default:
            libmesh_error_msg("ERROR: Unsupported 3D element type!: " << Utility::enum_to_string(elem->type()));
          } // end switch (type)
      } // end case SECOND

      // unsupported order
    default:
      libmesh_error_msg("ERROR: Unsupported 3D FE order!: " << totalorder);
    }
#else // LIBMESH_DIM != 3
  libmesh_ignore(elem, order, i, p, add_p_level);
  libmesh_not_implemented();
#endif
}



template <>
RealGradient FE<3,NEDELEC_ONE>::shape(const ElemType,
                                      const Order,
                                      const unsigned int,
                                      const Point &)
{
  libmesh_error_msg("Nedelec elements require the element type \nbecause edge orientation is needed.");
  return RealGradient();
}



template <>
RealGradient FE<3,NEDELEC_ONE>::shape(const FEType fet,
                                      const Elem * elem,
                                      const unsigned int i,
                                      const Point & p,
                                      const bool add_p_level)
{
  return FE<3,NEDELEC_ONE>::shape(elem, fet.order, i, p, add_p_level);
}


template <>
RealGradient FE<3,NEDELEC_ONE>::shape_deriv(const Elem * elem,
                                            const Order order,
                                            const unsigned int i,
                                            const unsigned int j,
                                            const Point & p,
                                            const bool add_p_level)
{
#if LIBMESH_DIM == 3
  libmesh_assert(elem);
  libmesh_assert_less (j, 3);

  const Order totalorder = static_cast<Order>(order + add_p_level * elem->p_level());
  libmesh_assert_less(i, n_dofs(elem->type(), totalorder));

  const char sign = elem->point(elem->local_edge_node(i, 0)) > elem->point(elem->local_edge_node(i, 1)) ? 1 : -1;

  const Real xi   = p(0);
  const Real eta  = p(1);
  const Real zeta = p(2);

  switch (totalorder)
    {
      // linear Nedelec (first kind) shape function first derivatives
    case FIRST:
      {
        switch (elem->type())
          {
          case HEX20:
          case HEX27:
            {
              // Even with a loose inverse_map tolerance we ought to
              // be nearly on the element interior in master
              // coordinates
              libmesh_assert_less_equal ( std::fabs(xi),   1.0+10*TOLERANCE );
              libmesh_assert_less_equal ( std::fabs(eta),  1.0+10*TOLERANCE );
              libmesh_assert_less_equal ( std::fabs(zeta), 1.0+10*TOLERANCE );

              switch (j)
                {
                  // d()/dxi
                case 0:
                  {
                    switch(i)
                      {
                      case 0:
                      case 2:
                      case 8:
                      case 10:
                        return RealGradient();
                      case 1:
                        return sign * RealGradient( 0.0, -0.125*(1.0-zeta) );
                      case 3:
                        return sign * RealGradient( 0.0, -0.125*(-1.0+zeta) );
                      case 4:
                        return sign * RealGradient( 0.0, 0.0, -0.125*(-1.0+eta) );
                      case 5:
                        return sign * RealGradient( 0.0, 0.0, -0.125*(1.0-eta) );
                      case 6:
                        return sign * RealGradient( 0.0, 0.0, -0.125*(1.0+eta) );
                      case 7:
                        return sign * RealGradient( 0.0, 0.0, -0.125*(-1.0-eta) );
                      case 9:
                        return sign * RealGradient( 0.0, -0.125*(1.0+zeta), 0.0 );
                      case 11:
                        return sign * RealGradient( 0.0, -0.125*(-1.0-zeta), 0.0 );

                      default:
                        libmesh_error_msg("Invalid i = " << i);
                      } // switch(i)

                  } // j = 0

                  // d()/deta
                case 1:
                  {
                    switch(i)
                      {
                      case 1:
                      case 3:
                      case 9:
                      case 11:
                        return RealGradient();
                      case 0:
                        return sign * RealGradient( -0.125*(-1.0+zeta), 0.0, 0.0 );
                      case 2:
                        return sign * RealGradient( 0.125*(1.0-zeta), 0.0, 0.0 );
                      case 4:
                        return sign * RealGradient( 0.0, 0.0, -0.125*(-1.0+xi) );
                      case 5:
                        return sign * RealGradient( 0.0, 0.0, -0.125*(-1.0-xi) );
                      case 6:
                        return sign * RealGradient( 0.0, 0.0, -0.125*(1.0+xi) );
                      case 7:
                        return sign * RealGradient( 0.0, 0.0, -0.125*(1.0-xi) );
                      case 8:
                        return sign * RealGradient( -0.125*(-1.0-zeta), 0.0, 0.0 );
                      case 10:
                        return sign * RealGradient(  0.125*(1.0+zeta), 0.0, 0.0 );

                      default:
                        libmesh_error_msg("Invalid i = " << i);
                      } // switch(i)

                  } // j = 1

                  // d()/dzeta
                case 2:
                  {
                    switch(i)
                      {
                      case 4:
                      case 5:
                      case 6:
                      case 7:
                        return RealGradient();
                      case 0:
                        return sign * RealGradient( -0.125*(-1.0+eta), 0.0, 0.0 );
                      case 1:
                        return sign * RealGradient( 0.0, -0.125*(-1.0-xi), 0.0 );
                      case 2:
                        return sign * RealGradient( 0.125*(-1.0-eta), 0.0, 0.0 );
                      case 3:
                        return sign * RealGradient( 0.0,  -0.125*(-1.0+xi), 0.0 );
                      case 8:
                        return sign * RealGradient( -0.125*(1.0-eta), 0.0, 0.0 );
                      case 9:
                        return sign * RealGradient( 0.0, -0.125*(1.0+xi), 0.0 );
                      case 10:
                        return sign * RealGradient(  0.125*(1.0+eta), 0.0, 0.0 );
                      case 11:
                        return sign * RealGradient( 0.0, -0.125*(1.0-xi), 0.0 );

                      default:
                        libmesh_error_msg("Invalid i = " << i);
                      } // switch(i)

                  } // j = 2

                default:
                  libmesh_error_msg("Invalid j = " << j);
                }
            }

          case TET10:
          case TET14:
            {
              switch (j)
                {
                  // d()/dxi
                case 0:
                  {
                    switch(i)
                      {
                      case 0:
                        return sign * RealGradient( 0.0, -1.0, -1.0 );
                      case 1:
                        return sign * RealGradient( 0.0,  -1.0, 0.0 );
                      case 2:
                        return sign * RealGradient( 0.0, 1.0, 0.0 );
                      case 3:
                        return sign * RealGradient( 0.0, 0.0, 1.0 );
                      case 4:
                        return sign * RealGradient( 0.0, 0.0, -1.0 );
                      case 5:
                        return RealGradient();

                      default:
                        libmesh_error_msg("Invalid i = " << i);
                      } // switch(i)

                  } // j = 0

                  // d()/deta
                case 1:
                  {
                    switch(i)
                      {
                      case 0:
                        return sign * RealGradient( 1.0, 0.0, 0.0 );
                      case 1:
                        return sign * RealGradient( 1.0,  0.0, 0.0 );
                      case 2:
                        return sign * RealGradient( -1.0, 0.0, -1.0 );
                      case 3:
                        return sign * RealGradient( 0.0, 0.0, 1.0 );
                      case 4:
                        return RealGradient();
                      case 5:
                        return sign * RealGradient( 0.0, 0.0, -1.0 );

                      default:
                        libmesh_error_msg("Invalid i = " << i);
                      } // switch(i)

                  } // j = 1

                  // d()/dzeta
                case 2:
                  {
                    switch(i)
                      {
                        case 0:
                          return sign * RealGradient( 1.0, 0.0, 0.0 );
                        case 1:
                          return RealGradient();
                        case 2:
                          return sign * RealGradient( 0.0, 1.0, 0.0 );
                        case 3:
                          return sign * RealGradient( -1.0, -1.0, 0.0 );
                        case 4:
                          return sign * RealGradient( 1.0, 0.0, 0.0 );
                        case 5:
                          return sign * RealGradient( 0.0, 1.0, 0.0 );

                        default:
                          libmesh_error_msg("Invalid i = " << i);
                      } // switch(i)
                  } // j = 2

                default:
                  libmesh_error_msg("Invalid j = " << j);
                }
            }

          default:
            libmesh_error_msg("ERROR: Unsupported 3D element type!: " << Utility::enum_to_string(elem->type()));
          }
      }

      // quadratic Nedelec (first kind) shape function first derivatives
    case SECOND:
      {
        switch (elem->type())
          {
          case HEX27:
            {
              switch (j)
                {
                  // d()/dxi
                case 0:
                  {
                    switch(ii)
                      {
                      case 0:
                        return sign * RealGradient(3.*eta + 3.*zeta - 24.*(eta/2. + 1./2.)*(zeta/2. + 1./2.) + 18.*(eta/2. + 1./2.)*((zeta + 1.)*(zeta + 1.)/(2.*2.)) + 18.*(zeta/2. + 1./2.)*((eta + 1.)*(eta + 1.)/(2.*2.)) + 9./2. - 9.*(eta + 1.)*(eta + 1.)/(2.*2.)/2. - 9.*(zeta + 1.)*(zeta + 1.)/(2.*2.)/2. - 27.*(zeta + 1.)*(zeta + 1.)/(2.*2.)*(eta + 1.)*(eta + 1.)/(2.*2.)/2., 0., 0.);
                      case 1:
                        return sign * RealGradient(-3.*eta - 3.*zeta + 24.*(eta/2. + 1./2.)*(zeta/2. + 1./2.) - 18.*(eta/2. + 1./2.)*(zeta + 1.)*(zeta + 1.)/(2.*2.) - 18.*(zeta/2. + 1./2.)*(eta + 1.)*(eta + 1.)/(2.*2.) - 9./2. + 9.*((eta + 1.)*(eta + 1.)/(2.*2.))/2. + 9.*((zeta + 1.)*(zeta + 1.)/(2.*2.))/2. + 27.*((zeta + 1.)*(zeta + 1.)/(2.*2.))*((eta + 1.)*(eta + 1.)/(2.*2.))/2., 0., 0.);
                      case 2:
                        return sign * RealGradient(0., 3.*eta/2. + 3.*xi + 4.*zeta + 36.*(eta/2. + 1./2.)*(xi/2. + 1./2.)*(zeta/2. + 1./2.) - 9.*(eta/2. + 1./2.)*(xi/2. + 1./2.) - 27.*(eta/2. + 1./2.)*(xi/2. + 1./2.)*(zeta + 1.)*(zeta + 1.)/(2.*2.) - 12.*(eta/2. + 1./2.)*(zeta/2. + 1./2.) + 9.*(eta/2. + 1./2.)*((zeta + 1.)*(zeta + 1.)/(2.*2.)) - 24.*(xi/2. + 1./2.)*(zeta/2. + 1./2.) + 18.*(xi/2. + 1./2.)*((zeta + 1.)*(zeta + 1.)/(2.*2.)) + 13./2. - 6.*(zeta + 1.)*(zeta + 1.)/(2.*2.), 0.);
                      case 3:
                        return sign * RealGradient(0., -3.*eta/2. - 3.*xi/2. - 2.*zeta - 36.*(eta/2. + 1./2.)*(xi/2. + 1./2.)*(zeta/2. + 1./2.) + 9.*(eta/2. + 1./2.)*(xi/2. + 1./2.) + 27.*(eta/2. + 1./2.)*(xi/2. + 1./2.)*((zeta + 1.)*(zeta + 1.)/(2.*2.)) + 12.*(eta/2. + 1./2.)*(zeta/2. + 1./2.) - 9.*(eta/2. + 1./2.)*(zeta + 1.)*(zeta + 1.)/(2.*2.) + 12.*(xi/2. + 1./2.)*(zeta/2. + 1./2.) - 9.*(xi/2. + 1./2.)*(zeta + 1.)*(zeta + 1.)/(2.*2.) - 4. + 3.*((zeta + 1.)*(zeta + 1.)/(2.*2.)), 0.);
                      case 4:
                        return sign * RealGradient(3.*eta/2. - 12.*(eta/2. + 1./2.)*(zeta/2. + 1./2.) + 9.*(eta/2. + 1./2.)*((zeta + 1.)*(zeta + 1.)/(2.*2.)) + 18.*(zeta/2. + 1./2.)*((eta + 1.)*(eta + 1.)/(2.*2.)) + 3./2. - 9.*(eta + 1.)*(eta + 1.)/(2.*2.)/2. - 27.*(zeta + 1.)*(zeta + 1.)/(2.*2.)*(eta + 1.)*(eta + 1.)/(2.*2.)/2., 0., 0.);
                      case 5:
                        return sign * RealGradient(-3.*eta/2. + 12.*(eta/2. + 1./2.)*(zeta/2. + 1./2.) - 9.*(eta/2. + 1./2.)*(zeta + 1.)*(zeta + 1.)/(2.*2.) - 18.*(zeta/2. + 1./2.)*(eta + 1.)*(eta + 1.)/(2.*2.) - 3./2. + 9.*((eta + 1.)*(eta + 1.)/(2.*2.))/2. + 27.*((zeta + 1.)*(zeta + 1.)/(2.*2.))*((eta + 1.)*(eta + 1.)/(2.*2.))/2., 0., 0.);
                      case 6:
                        return sign * RealGradient(0., 3.*eta + 3.*xi + 8.*zeta + 36.*(eta/2. + 1./2.)*(xi/2. + 1./2.)*(zeta/2. + 1./2.) - 9.*(eta/2. + 1./2.)*(xi/2. + 1./2.) - 27.*(eta/2. + 1./2.)*(xi/2. + 1./2.)*(zeta + 1.)*(zeta + 1.)/(2.*2.) - 24.*(eta/2. + 1./2.)*(zeta/2. + 1./2.) + 18.*(eta/2. + 1./2.)*((zeta + 1.)*(zeta + 1.)/(2.*2.)) - 24.*(xi/2. + 1./2.)*(zeta/2. + 1./2.) + 18.*(xi/2. + 1./2.)*((zeta + 1.)*(zeta + 1.)/(2.*2.)) + 10. - 12.*(zeta + 1.)*(zeta + 1.)/(2.*2.), 0.);
                      case 7:
                        return sign * RealGradient(0., -3.*eta - 3.*xi/2. - 4.*zeta - 36.*(eta/2. + 1./2.)*(xi/2. + 1./2.)*(zeta/2. + 1./2.) + 9.*(eta/2. + 1./2.)*(xi/2. + 1./2.) + 27.*(eta/2. + 1./2.)*(xi/2. + 1./2.)*((zeta + 1.)*(zeta + 1.)/(2.*2.)) + 24.*(eta/2. + 1./2.)*(zeta/2. + 1./2.) - 18.*(eta/2. + 1./2.)*(zeta + 1.)*(zeta + 1.)/(2.*2.) + 12.*(xi/2. + 1./2.)*(zeta/2. + 1./2.) - 9.*(xi/2. + 1./2.)*(zeta + 1.)*(zeta + 1.)/(2.*2.) - 13./2. + 6.*((zeta + 1.)*(zeta + 1.)/(2.*2.)), 0.);
                      case 8:
                        return sign * RealGradient(0., 0., 8.*eta + 3.*xi + 3.*zeta + 36.*(eta/2. + 1./2.)*(xi/2. + 1./2.)*(zeta/2. + 1./2.) - 24.*(eta/2. + 1./2.)*(xi/2. + 1./2.) - 24.*(eta/2. + 1./2.)*(zeta/2. + 1./2.) - 9.*(xi/2. + 1./2.)*(zeta/2. + 1./2.) - 27.*(xi/2. + 1./2.)*(zeta/2. + 1./2.)*(eta + 1.)*(eta + 1.)/(2.*2.) + 18.*(xi/2. + 1./2.)*((eta + 1.)*(eta + 1.)/(2.*2.)) + 18.*(zeta/2. + 1./2.)*((eta + 1.)*(eta + 1.)/(2.*2.)) + 10. - 12.*(eta + 1.)*(eta + 1.)/(2.*2.));
                      case 9:
                        return sign * RealGradient(0., 0., -4.*eta - 3.*xi/2. - 3.*zeta - 36.*(eta/2. + 1./2.)*(xi/2. + 1./2.)*(zeta/2. + 1./2.) + 12.*(eta/2. + 1./2.)*(xi/2. + 1./2.) + 24.*(eta/2. + 1./2.)*(zeta/2. + 1./2.) + 9.*(xi/2. + 1./2.)*(zeta/2. + 1./2.) + 27.*(xi/2. + 1./2.)*(zeta/2. + 1./2.)*((eta + 1.)*(eta + 1.)/(2.*2.)) - 9.*(xi/2. + 1./2.)*(eta + 1.)*(eta + 1.)/(2.*2.) - 18.*(zeta/2. + 1./2.)*(eta + 1.)*(eta + 1.)/(2.*2.) - 13./2. + 6.*((eta + 1.)*(eta + 1.)/(2.*2.)));
                      case 10:
                        return sign * RealGradient(0., 0., 4.*eta + 3.*xi + 3.*zeta/2. + 36.*(eta/2. + 1./2.)*(xi/2. + 1./2.)*(zeta/2. + 1./2.) - 24.*(eta/2. + 1./2.)*(xi/2. + 1./2.) - 12.*(eta/2. + 1./2.)*(zeta/2. + 1./2.) - 9.*(xi/2. + 1./2.)*(zeta/2. + 1./2.) - 27.*(xi/2. + 1./2.)*(zeta/2. + 1./2.)*(eta + 1.)*(eta + 1.)/(2.*2.) + 18.*(xi/2. + 1./2.)*((eta + 1.)*(eta + 1.)/(2.*2.)) + 9.*(zeta/2. + 1./2.)*((eta + 1.)*(eta + 1.)/(2.*2.)) + 13./2. - 6.*(eta + 1.)*(eta + 1.)/(2.*2.));
                      case 11:
                        return sign * RealGradient(0., 0., -2.*eta - 3.*xi/2. - 3.*zeta/2. - 36.*(eta/2. + 1./2.)*(xi/2. + 1./2.)*(zeta/2. + 1./2.) + 12.*(eta/2. + 1./2.)*(xi/2. + 1./2.) + 12.*(eta/2. + 1./2.)*(zeta/2. + 1./2.) + 9.*(xi/2. + 1./2.)*(zeta/2. + 1./2.) + 27.*(xi/2. + 1./2.)*(zeta/2. + 1./2.)*((eta + 1.)*(eta + 1.)/(2.*2.)) - 9.*(xi/2. + 1./2.)*(eta + 1.)*(eta + 1.)/(2.*2.) - 9.*(zeta/2. + 1./2.)*(eta + 1.)*(eta + 1.)/(2.*2.) - 4. + 3.*((eta + 1.)*(eta + 1.)/(2.*2.)));
                      case 12:
                        return sign * RealGradient(0., 0., 2.*eta + 18.*(eta/2. + 1./2.)*(xi/2. + 1./2.)*(zeta/2. + 1./2.) - 12.*(eta/2. + 1./2.)*(xi/2. + 1./2.) - 6.*(eta/2. + 1./2.)*(zeta/2. + 1./2.) - 27.*(xi/2. + 1./2.)*(zeta/2. + 1./2.)*(eta + 1.)*(eta + 1.)/(2.*2.) + 18.*(xi/2. + 1./2.)*((eta + 1.)*(eta + 1.)/(2.*2.)) + 9.*(zeta/2. + 1./2.)*((eta + 1.)*(eta + 1.)/(2.*2.)) + 2. - 6.*(eta + 1.)*(eta + 1.)/(2.*2.));
                      case 13:
                        return sign * RealGradient(0., 0., -eta - 18.*(eta/2. + 1./2.)*(xi/2. + 1./2.)*(zeta/2. + 1./2.) + 6.*(eta/2. + 1./2.)*(xi/2. + 1./2.) + 6.*(eta/2. + 1./2.)*(zeta/2. + 1./2.) + 27.*(xi/2. + 1./2.)*(zeta/2. + 1./2.)*((eta + 1.)*(eta + 1.)/(2.*2.)) - 9.*(xi/2. + 1./2.)*(eta + 1.)*(eta + 1.)/(2.*2.) - 9.*(zeta/2. + 1./2.)*(eta + 1.)*(eta + 1.)/(2.*2.) - 1. + 3.*((eta + 1.)*(eta + 1.)/(2.*2.)));
                      case 14:
                        return sign * RealGradient(0., 0., 4.*eta + 18.*(eta/2. + 1./2.)*(xi/2. + 1./2.)*(zeta/2. + 1./2.) - 12.*(eta/2. + 1./2.)*(xi/2. + 1./2.) - 12.*(eta/2. + 1./2.)*(zeta/2. + 1./2.) - 27.*(xi/2. + 1./2.)*(zeta/2. + 1./2.)*(eta + 1.)*(eta + 1.)/(2.*2.) + 18.*(xi/2. + 1./2.)*((eta + 1.)*(eta + 1.)/(2.*2.)) + 18.*(zeta/2. + 1./2.)*((eta + 1.)*(eta + 1.)/(2.*2.)) + 4. - 12.*(eta + 1.)*(eta + 1.)/(2.*2.));
                      case 15:
                        return sign * RealGradient(0., 0., -2.*eta - 18.*(eta/2. + 1./2.)*(xi/2. + 1./2.)*(zeta/2. + 1./2.) + 6.*(eta/2. + 1./2.)*(xi/2. + 1./2.) + 12.*(eta/2. + 1./2.)*(zeta/2. + 1./2.) + 27.*(xi/2. + 1./2.)*(zeta/2. + 1./2.)*((eta + 1.)*(eta + 1.)/(2.*2.)) - 9.*(xi/2. + 1./2.)*(eta + 1.)*(eta + 1.)/(2.*2.) - 18.*(zeta/2. + 1./2.)*(eta + 1.)*(eta + 1.)/(2.*2.) - 2. + 6.*((eta + 1.)*(eta + 1.)/(2.*2.)));
                      case 16:
                        return sign * RealGradient(3.*zeta/2. - 12.*(eta/2. + 1./2.)*(zeta/2. + 1./2.) + 18.*(eta/2. + 1./2.)*((zeta + 1.)*(zeta + 1.)/(2.*2.)) + 9.*(zeta/2. + 1./2.)*((eta + 1.)*(eta + 1.)/(2.*2.)) + 3./2. - 9.*(zeta + 1.)*(zeta + 1.)/(2.*2.)/2. - 27.*(zeta + 1.)*(zeta + 1.)/(2.*2.)*(eta + 1.)*(eta + 1.)/(2.*2.)/2., 0., 0.);
                      case 17:
                        return sign * RealGradient(-3.*zeta/2. + 12.*(eta/2. + 1./2.)*(zeta/2. + 1./2.) - 18.*(eta/2. + 1./2.)*(zeta + 1.)*(zeta + 1.)/(2.*2.) - 9.*(zeta/2. + 1./2.)*(eta + 1.)*(eta + 1.)/(2.*2.) - 3./2. + 9.*((zeta + 1.)*(zeta + 1.)/(2.*2.))/2. + 27.*((zeta + 1.)*(zeta + 1.)/(2.*2.))*((eta + 1.)*(eta + 1.)/(2.*2.))/2., 0., 0.);
                      case 18:
                        return sign * RealGradient(0., 2.*zeta + 18.*(eta/2. + 1./2.)*(xi/2. + 1./2.)*(zeta/2. + 1./2.) - 27.*(eta/2. + 1./2.)*(xi/2. + 1./2.)*(zeta + 1.)*(zeta + 1.)/(2.*2.) - 6.*(eta/2. + 1./2.)*(zeta/2. + 1./2.) + 9.*(eta/2. + 1./2.)*((zeta + 1.)*(zeta + 1.)/(2.*2.)) - 12.*(xi/2. + 1./2.)*(zeta/2. + 1./2.) + 18.*(xi/2. + 1./2.)*((zeta + 1.)*(zeta + 1.)/(2.*2.)) + 2. - 6.*(zeta + 1.)*(zeta + 1.)/(2.*2.), 0.);
                      case 19:
                        return sign * RealGradient(0., -zeta - 18.*(eta/2. + 1./2.)*(xi/2. + 1./2.)*(zeta/2. + 1./2.) + 27.*(eta/2. + 1./2.)*(xi/2. + 1./2.)*((zeta + 1.)*(zeta + 1.)/(2.*2.)) + 6.*(eta/2. + 1./2.)*(zeta/2. + 1./2.) - 9.*(eta/2. + 1./2.)*(zeta + 1.)*(zeta + 1.)/(2.*2.) + 6.*(xi/2. + 1./2.)*(zeta/2. + 1./2.) - 9.*(xi/2. + 1./2.)*(zeta + 1.)*(zeta + 1.)/(2.*2.) - 1. + 3.*((zeta + 1.)*(zeta + 1.)/(2.*2.)), 0.);
                      case 20:
                        return sign * RealGradient(-6.*(eta/2. + 1./2.)*(zeta/2. + 1./2.) + 9.*(eta/2. + 1./2.)*((zeta + 1.)*(zeta + 1.)/(2.*2.)) + 9.*(zeta/2. + 1./2.)*((eta + 1.)*(eta + 1.)/(2.*2.)) - 27.*(zeta + 1.)*(zeta + 1.)/(2.*2.)*(eta + 1.)*(eta + 1.)/(2.*2.)/2., 0., 0.);
                      case 21:
                        return sign * RealGradient(6.*(eta/2. + 1./2.)*(zeta/2. + 1./2.) - 9.*(eta/2. + 1./2.)*(zeta + 1.)*(zeta + 1.)/(2.*2.) - 9.*(zeta/2. + 1./2.)*(eta + 1.)*(eta + 1.)/(2.*2.) + 27.*((zeta + 1.)*(zeta + 1.)/(2.*2.))*((eta + 1.)*(eta + 1.)/(2.*2.))/2., 0., 0.);
                      case 22:
                        return sign * RealGradient(0., 4.*zeta + 18.*(eta/2. + 1./2.)*(xi/2. + 1./2.)*(zeta/2. + 1./2.) - 27.*(eta/2. + 1./2.)*(xi/2. + 1./2.)*(zeta + 1.)*(zeta + 1.)/(2.*2.) - 12.*(eta/2. + 1./2.)*(zeta/2. + 1./2.) + 18.*(eta/2. + 1./2.)*((zeta + 1.)*(zeta + 1.)/(2.*2.)) - 12.*(xi/2. + 1./2.)*(zeta/2. + 1./2.) + 18.*(xi/2. + 1./2.)*((zeta + 1.)*(zeta + 1.)/(2.*2.)) + 4. - 12.*(zeta + 1.)*(zeta + 1.)/(2.*2.), 0.);
                      case 23:
                        return sign * RealGradient(0., -2.*zeta - 18.*(eta/2. + 1./2.)*(xi/2. + 1./2.)*(zeta/2. + 1./2.) + 27.*(eta/2. + 1./2.)*(xi/2. + 1./2.)*((zeta + 1.)*(zeta + 1.)/(2.*2.)) + 12.*(eta/2. + 1./2.)*(zeta/2. + 1./2.) - 18.*(eta/2. + 1./2.)*(zeta + 1.)*(zeta + 1.)/(2.*2.) + 6.*(xi/2. + 1./2.)*(zeta/2. + 1./2.) - 9.*(xi/2. + 1./2.)*(zeta + 1.)*(zeta + 1.)/(2.*2.) - 2. + 6.*((zeta + 1.)*(zeta + 1.)/(2.*2.)), 0.);
                      case 24:
                        return RealGradient(0., -9.*eta/2. - 6.*xi - 12.*zeta - 72.*(eta/2. + 1./2.)*(xi/2. + 1./2.)*(zeta/2. + 1./2.) + 18.*(eta/2. + 1./2.)*(xi/2. + 1./2.) + 54.*(eta/2. + 1./2.)*(xi/2. + 1./2.)*((zeta + 1.)*(zeta + 1.)/(2.*2.)) + 36.*(eta/2. + 1./2.)*(zeta/2. + 1./2.) - 27.*(eta/2. + 1./2.)*(zeta + 1.)*(zeta + 1.)/(2.*2.) + 48.*(xi/2. + 1./2.)*(zeta/2. + 1./2.) - 36.*(xi/2. + 1./2.)*(zeta + 1.)*(zeta + 1.)/(2.*2.) - 33./2. + 18.*((zeta + 1.)*(zeta + 1.)/(2.*2.)), 0.);
                      case 25:
                        return RealGradient(9.*eta/2. - 36.*(eta/2. + 1./2.)*(zeta/2. + 1./2.) + 27.*(eta/2. + 1./2.)*((zeta + 1.)*(zeta + 1.)/(2.*2.)) + 36.*(zeta/2. + 1./2.)*((eta + 1.)*(eta + 1.)/(2.*2.)) + 9./2. - 9.*(eta + 1.)*(eta + 1.)/(2.*2.) - 27.*(zeta + 1.)*(zeta + 1.)/(2.*2.)*(eta + 1.)*(eta + 1.)/(2.*2.), 0., 0.);
                      case 26:
                        return RealGradient(-9.*eta/2. + 36.*(eta/2. + 1./2.)*(zeta/2. + 1./2.) - 27.*(eta/2. + 1./2.)*(zeta + 1.)*(zeta + 1.)/(2.*2.) - 36.*(zeta/2. + 1./2.)*(eta + 1.)*(eta + 1.)/(2.*2.) - 9./2. + 9.*((eta + 1.)*(eta + 1.)/(2.*2.)) + 27.*((zeta + 1.)*(zeta + 1.)/(2.*2.))*((eta + 1.)*(eta + 1.)/(2.*2.)), 0., 0.);
                      case 27:
                        return RealGradient(0., 9.*eta/2. + 3.*xi + 6.*zeta + 72.*(eta/2. + 1./2.)*(xi/2. + 1./2.)*(zeta/2. + 1./2.) - 18.*(eta/2. + 1./2.)*(xi/2. + 1./2.) - 54.*(eta/2. + 1./2.)*(xi/2. + 1./2.)*(zeta + 1.)*(zeta + 1.)/(2.*2.) - 36.*(eta/2. + 1./2.)*(zeta/2. + 1./2.) + 27.*(eta/2. + 1./2.)*((zeta + 1.)*(zeta + 1.)/(2.*2.)) - 24.*(xi/2. + 1./2.)*(zeta/2. + 1./2.) + 18.*(xi/2. + 1./2.)*((zeta + 1.)*(zeta + 1.)/(2.*2.)) + 21./2. - 9.*(zeta + 1.)*(zeta + 1.)/(2.*2.), 0.);
                      case 28:
                        return RealGradient(0., 0., -12.*eta - 6.*xi - 9.*zeta/2. - 72.*(eta/2. + 1./2.)*(xi/2. + 1./2.)*(zeta/2. + 1./2.) + 48.*(eta/2. + 1./2.)*(xi/2. + 1./2.) + 36.*(eta/2. + 1./2.)*(zeta/2. + 1./2.) + 18.*(xi/2. + 1./2.)*(zeta/2. + 1./2.) + 54.*(xi/2. + 1./2.)*(zeta/2. + 1./2.)*((eta + 1.)*(eta + 1.)/(2.*2.)) - 36.*(xi/2. + 1./2.)*(eta + 1.)*(eta + 1.)/(2.*2.) - 27.*(zeta/2. + 1./2.)*(eta + 1.)*(eta + 1.)/(2.*2.) - 33./2. + 18.*((eta + 1.)*(eta + 1.)/(2.*2.)));
                      case 29:
                        return RealGradient(9.*zeta/2. - 36.*(eta/2. + 1./2.)*(zeta/2. + 1./2.) + 36.*(eta/2. + 1./2.)*((zeta + 1.)*(zeta + 1.)/(2.*2.)) + 27.*(zeta/2. + 1./2.)*((eta + 1.)*(eta + 1.)/(2.*2.)) + 9./2. - 9.*(zeta + 1.)*(zeta + 1.)/(2.*2.) - 27.*(zeta + 1.)*(zeta + 1.)/(2.*2.)*(eta + 1.)*(eta + 1.)/(2.*2.), 0., 0.);
                      case 30:
                        return RealGradient(-9.*zeta/2. + 36.*(eta/2. + 1./2.)*(zeta/2. + 1./2.) - 36.*(eta/2. + 1./2.)*(zeta + 1.)*(zeta + 1.)/(2.*2.) - 27.*(zeta/2. + 1./2.)*(eta + 1.)*(eta + 1.)/(2.*2.) - 9./2. + 9.*((zeta + 1.)*(zeta + 1.)/(2.*2.)) + 27.*((zeta + 1.)*(zeta + 1.)/(2.*2.))*((eta + 1.)*(eta + 1.)/(2.*2.)), 0., 0.);
                      case 31:
                        return RealGradient(0., 0., 6.*eta + 3.*xi + 9.*zeta/2. + 72.*(eta/2. + 1./2.)*(xi/2. + 1./2.)*(zeta/2. + 1./2.) - 24.*(eta/2. + 1./2.)*(xi/2. + 1./2.) - 36.*(eta/2. + 1./2.)*(zeta/2. + 1./2.) - 18.*(xi/2. + 1./2.)*(zeta/2. + 1./2.) - 54.*(xi/2. + 1./2.)*(zeta/2. + 1./2.)*(eta + 1.)*(eta + 1.)/(2.*2.) + 18.*(xi/2. + 1./2.)*((eta + 1.)*(eta + 1.)/(2.*2.)) + 27.*(zeta/2. + 1./2.)*((eta + 1.)*(eta + 1.)/(2.*2.)) + 21./2. - 9.*(eta + 1.)*(eta + 1.)/(2.*2.));
                      case 32:
                        return RealGradient(0., 0., -6.*eta - 54.*(eta/2. + 1./2.)*(xi/2. + 1./2.)*(zeta/2. + 1./2.) + 36.*(eta/2. + 1./2.)*(xi/2. + 1./2.) + 18.*(eta/2. + 1./2.)*(zeta/2. + 1./2.) + 54.*(xi/2. + 1./2.)*(zeta/2. + 1./2.)*((eta + 1.)*(eta + 1.)/(2.*2.)) - 36.*(xi/2. + 1./2.)*(eta + 1.)*(eta + 1.)/(2.*2.) - 18.*(zeta/2. + 1./2.)*(eta + 1.)*(eta + 1.)/(2.*2.) - 6. + 12.*((eta + 1.)*(eta + 1.)/(2.*2.)));
                      case 33:
                        return RealGradient(0., 6.*zeta + 54.*(eta/2. + 1./2.)*(xi/2. + 1./2.)*(zeta/2. + 1./2.) - 54.*(eta/2. + 1./2.)*(xi/2. + 1./2.)*(zeta + 1.)*(zeta + 1.)/(2.*2.) - 18.*(eta/2. + 1./2.)*(zeta/2. + 1./2.) + 18.*(eta/2. + 1./2.)*((zeta + 1.)*(zeta + 1.)/(2.*2.)) - 36.*(xi/2. + 1./2.)*(zeta/2. + 1./2.) + 36.*(xi/2. + 1./2.)*((zeta + 1.)*(zeta + 1.)/(2.*2.)) + 6. - 12.*(zeta + 1.)*(zeta + 1.)/(2.*2.), 0.);
                      case 34:
                        return RealGradient(0., -3.*zeta - 54.*(eta/2. + 1./2.)*(xi/2. + 1./2.)*(zeta/2. + 1./2.) + 54.*(eta/2. + 1./2.)*(xi/2. + 1./2.)*((zeta + 1.)*(zeta + 1.)/(2.*2.)) + 18.*(eta/2. + 1./2.)*(zeta/2. + 1./2.) - 18.*(eta/2. + 1./2.)*(zeta + 1.)*(zeta + 1.)/(2.*2.) + 18.*(xi/2. + 1./2.)*(zeta/2. + 1./2.) - 18.*(xi/2. + 1./2.)*(zeta + 1.)*(zeta + 1.)/(2.*2.) - 3. + 6.*((zeta + 1.)*(zeta + 1.)/(2.*2.)), 0.);
                      case 35:
                        return RealGradient(0., 0., 3.*eta + 54.*(eta/2. + 1./2.)*(xi/2. + 1./2.)*(zeta/2. + 1./2.) - 18.*(eta/2. + 1./2.)*(xi/2. + 1./2.) - 18.*(eta/2. + 1./2.)*(zeta/2. + 1./2.) - 54.*(xi/2. + 1./2.)*(zeta/2. + 1./2.)*(eta + 1.)*(eta + 1.)/(2.*2.) + 18.*(xi/2. + 1./2.)*((eta + 1.)*(eta + 1.)/(2.*2.)) + 18.*(zeta/2. + 1./2.)*((eta + 1.)*(eta + 1.)/(2.*2.)) + 3. - 6.*(eta + 1.)*(eta + 1.)/(2.*2.));
                      case 36:
                        return RealGradient(0., 0., -6.*eta - 36.*(eta/2. + 1./2.)*(xi/2. + 1./2.)*(zeta/2. + 1./2.) + 24.*(eta/2. + 1./2.)*(xi/2. + 1./2.) + 18.*(eta/2. + 1./2.)*(zeta/2. + 1./2.) + 54.*(xi/2. + 1./2.)*(zeta/2. + 1./2.)*((eta + 1.)*(eta + 1.)/(2.*2.)) - 36.*(xi/2. + 1./2.)*(eta + 1.)*(eta + 1.)/(2.*2.) - 27.*(zeta/2. + 1./2.)*(eta + 1.)*(eta + 1.)/(2.*2.) - 6. + 18.*((eta + 1.)*(eta + 1.)/(2.*2.)));
                      case 37:
                        return RealGradient(-18.*(eta/2. + 1./2.)*(zeta/2. + 1./2.) + 18.*(eta/2. + 1./2.)*((zeta + 1.)*(zeta + 1.)/(2.*2.)) + 27.*(zeta/2. + 1./2.)*((eta + 1.)*(eta + 1.)/(2.*2.)) - 27.*(zeta + 1.)*(zeta + 1.)/(2.*2.)*(eta + 1.)*(eta + 1.)/(2.*2.), 0., 0.);
                      case 38:
                        return RealGradient(18.*(eta/2. + 1./2.)*(zeta/2. + 1./2.) - 18.*(eta/2. + 1./2.)*(zeta + 1.)*(zeta + 1.)/(2.*2.) - 27.*(zeta/2. + 1./2.)*(eta + 1.)*(eta + 1.)/(2.*2.) + 27.*((zeta + 1.)*(zeta + 1.)/(2.*2.))*((eta + 1.)*(eta + 1.)/(2.*2.)), 0., 0.);
                      case 39:
                        return RealGradient(0., 0., 3.*eta + 36.*(eta/2. + 1./2.)*(xi/2. + 1./2.)*(zeta/2. + 1./2.) - 12.*(eta/2. + 1./2.)*(xi/2. + 1./2.) - 18.*(eta/2. + 1./2.)*(zeta/2. + 1./2.) - 54.*(xi/2. + 1./2.)*(zeta/2. + 1./2.)*(eta + 1.)*(eta + 1.)/(2.*2.) + 18.*(xi/2. + 1./2.)*((eta + 1.)*(eta + 1.)/(2.*2.)) + 27.*(zeta/2. + 1./2.)*((eta + 1.)*(eta + 1.)/(2.*2.)) + 3. - 9.*(eta + 1.)*(eta + 1.)/(2.*2.));
                      case 40:
                        return RealGradient(0., 0., -12.*eta - 54.*(eta/2. + 1./2.)*(xi/2. + 1./2.)*(zeta/2. + 1./2.) + 36.*(eta/2. + 1./2.)*(xi/2. + 1./2.) + 36.*(eta/2. + 1./2.)*(zeta/2. + 1./2.) + 54.*(xi/2. + 1./2.)*(zeta/2. + 1./2.)*((eta + 1.)*(eta + 1.)/(2.*2.)) - 36.*(xi/2. + 1./2.)*(eta + 1.)*(eta + 1.)/(2.*2.) - 36.*(zeta/2. + 1./2.)*(eta + 1.)*(eta + 1.)/(2.*2.) - 12. + 24.*((eta + 1.)*(eta + 1.)/(2.*2.)));
                      case 41:
                        return RealGradient(0., 12.*zeta + 54.*(eta/2. + 1./2.)*(xi/2. + 1./2.)*(zeta/2. + 1./2.) - 54.*(eta/2. + 1./2.)*(xi/2. + 1./2.)*(zeta + 1.)*(zeta + 1.)/(2.*2.) - 36.*(eta/2. + 1./2.)*(zeta/2. + 1./2.) + 36.*(eta/2. + 1./2.)*((zeta + 1.)*(zeta + 1.)/(2.*2.)) - 36.*(xi/2. + 1./2.)*(zeta/2. + 1./2.) + 36.*(xi/2. + 1./2.)*((zeta + 1.)*(zeta + 1.)/(2.*2.)) + 12. - 24.*(zeta + 1.)*(zeta + 1.)/(2.*2.), 0.);
                      case 42:
                        return RealGradient(0., -6.*zeta - 54.*(eta/2. + 1./2.)*(xi/2. + 1./2.)*(zeta/2. + 1./2.) + 54.*(eta/2. + 1./2.)*(xi/2. + 1./2.)*((zeta + 1.)*(zeta + 1.)/(2.*2.)) + 36.*(eta/2. + 1./2.)*(zeta/2. + 1./2.) - 36.*(eta/2. + 1./2.)*(zeta + 1.)*(zeta + 1.)/(2.*2.) + 18.*(xi/2. + 1./2.)*(zeta/2. + 1./2.) - 18.*(xi/2. + 1./2.)*(zeta + 1.)*(zeta + 1.)/(2.*2.) - 6. + 12.*((zeta + 1.)*(zeta + 1.)/(2.*2.)), 0.);
                      case 43:
                        return RealGradient(0., 0., 6.*eta + 54.*(eta/2. + 1./2.)*(xi/2. + 1./2.)*(zeta/2. + 1./2.) - 18.*(eta/2. + 1./2.)*(xi/2. + 1./2.) - 36.*(eta/2. + 1./2.)*(zeta/2. + 1./2.) - 54.*(xi/2. + 1./2.)*(zeta/2. + 1./2.)*(eta + 1.)*(eta + 1.)/(2.*2.) + 18.*(xi/2. + 1./2.)*((eta + 1.)*(eta + 1.)/(2.*2.)) + 36.*(zeta/2. + 1./2.)*((eta + 1.)*(eta + 1.)/(2.*2.)) + 6. - 12.*(eta + 1.)*(eta + 1.)/(2.*2.));
                      case 44:
                        return RealGradient(0., -6.*zeta - 36.*(eta/2. + 1./2.)*(xi/2. + 1./2.)*(zeta/2. + 1./2.) + 54.*(eta/2. + 1./2.)*(xi/2. + 1./2.)*((zeta + 1.)*(zeta + 1.)/(2.*2.)) + 18.*(eta/2. + 1./2.)*(zeta/2. + 1./2.) - 27.*(eta/2. + 1./2.)*(zeta + 1.)*(zeta + 1.)/(2.*2.) + 24.*(xi/2. + 1./2.)*(zeta/2. + 1./2.) - 36.*(xi/2. + 1./2.)*(zeta + 1.)*(zeta + 1.)/(2.*2.) - 6. + 18.*((zeta + 1.)*(zeta + 1.)/(2.*2.)), 0.);
                      case 45:
                        return RealGradient(-18.*(eta/2. + 1./2.)*(zeta/2. + 1./2.) + 27.*(eta/2. + 1./2.)*((zeta + 1.)*(zeta + 1.)/(2.*2.)) + 18.*(zeta/2. + 1./2.)*((eta + 1.)*(eta + 1.)/(2.*2.)) - 27.*(zeta + 1.)*(zeta + 1.)/(2.*2.)*(eta + 1.)*(eta + 1.)/(2.*2.), 0., 0.);
                      case 46:
                        return RealGradient(18.*(eta/2. + 1./2.)*(zeta/2. + 1./2.) - 27.*(eta/2. + 1./2.)*(zeta + 1.)*(zeta + 1.)/(2.*2.) - 18.*(zeta/2. + 1./2.)*(eta + 1.)*(eta + 1.)/(2.*2.) + 27.*((zeta + 1.)*(zeta + 1.)/(2.*2.))*((eta + 1.)*(eta + 1.)/(2.*2.)), 0., 0.);
                      case 47:
                        return RealGradient(0., 3.*zeta + 36.*(eta/2. + 1./2.)*(xi/2. + 1./2.)*(zeta/2. + 1./2.) - 54.*(eta/2. + 1./2.)*(xi/2. + 1./2.)*(zeta + 1.)*(zeta + 1.)/(2.*2.) - 18.*(eta/2. + 1./2.)*(zeta/2. + 1./2.) + 27.*(eta/2. + 1./2.)*((zeta + 1.)*(zeta + 1.)/(2.*2.)) - 12.*(xi/2. + 1./2.)*(zeta/2. + 1./2.) + 18.*(xi/2. + 1./2.)*((zeta + 1.)*(zeta + 1.)/(2.*2.)) + 3. - 9.*(zeta + 1.)*(zeta + 1.)/(2.*2.), 0.);
                      case 48:
                        return RealGradient(0., 0., 18.*eta + 108.*(eta/2. + 1./2.)*(xi/2. + 1./2.)*(zeta/2. + 1./2.) - 72.*(eta/2. + 1./2.)*(xi/2. + 1./2.) - 54.*(eta/2. + 1./2.)*(zeta/2. + 1./2.) - 108.*(xi/2. + 1./2.)*(zeta/2. + 1./2.)*(eta + 1.)*(eta + 1.)/(2.*2.) + 72.*(xi/2. + 1./2.)*((eta + 1.)*(eta + 1.)/(2.*2.)) + 54.*(zeta/2. + 1./2.)*((eta + 1.)*(eta + 1.)/(2.*2.)) + 18. - 36.*(eta + 1.)*(eta + 1.)/(2.*2.));
                      case 49:
                        return RealGradient(0., -18.*zeta - 108.*(eta/2. + 1./2.)*(xi/2. + 1./2.)*(zeta/2. + 1./2.) + 108.*(eta/2. + 1./2.)*(xi/2. + 1./2.)*((zeta + 1.)*(zeta + 1.)/(2.*2.)) + 54.*(eta/2. + 1./2.)*(zeta/2. + 1./2.) - 54.*(eta/2. + 1./2.)*(zeta + 1.)*(zeta + 1.)/(2.*2.) + 72.*(xi/2. + 1./2.)*(zeta/2. + 1./2.) - 72.*(xi/2. + 1./2.)*(zeta + 1.)*(zeta + 1.)/(2.*2.) - 18. + 36.*((zeta + 1.)*(zeta + 1.)/(2.*2.)), 0.);
                      case 50:
                        return RealGradient(-54.*(eta/2. + 1./2.)*(zeta/2. + 1./2.) + 54.*(eta/2. + 1./2.)*((zeta + 1.)*(zeta + 1.)/(2.*2.)) + 54.*(zeta/2. + 1./2.)*((eta + 1.)*(eta + 1.)/(2.*2.)) - 54.*(zeta + 1.)*(zeta + 1.)/(2.*2.)*(eta + 1.)*(eta + 1.)/(2.*2.), 0., 0.);
                      case 51:
                        return RealGradient(54.*(eta/2. + 1./2.)*(zeta/2. + 1./2.) - 54.*(eta/2. + 1./2.)*(zeta + 1.)*(zeta + 1.)/(2.*2.) - 54.*(zeta/2. + 1./2.)*(eta + 1.)*(eta + 1.)/(2.*2.) + 54.*((zeta + 1.)*(zeta + 1.)/(2.*2.))*((eta + 1.)*(eta + 1.)/(2.*2.)), 0., 0.);
                      case 52:
                        return RealGradient(0., 9.*zeta + 108.*(eta/2. + 1./2.)*(xi/2. + 1./2.)*(zeta/2. + 1./2.) - 108.*(eta/2. + 1./2.)*(xi/2. + 1./2.)*(zeta + 1.)*(zeta + 1.)/(2.*2.) - 54.*(eta/2. + 1./2.)*(zeta/2. + 1./2.) + 54.*(eta/2. + 1./2.)*((zeta + 1.)*(zeta + 1.)/(2.*2.)) - 36.*(xi/2. + 1./2.)*(zeta/2. + 1./2.) + 36.*(xi/2. + 1./2.)*((zeta + 1.)*(zeta + 1.)/(2.*2.)) + 9. - 18.*(zeta + 1.)*(zeta + 1.)/(2.*2.), 0.);
                      case 53:
                        return RealGradient(0., 0., -9.*eta - 108.*(eta/2. + 1./2.)*(xi/2. + 1./2.)*(zeta/2. + 1./2.) + 36.*(eta/2. + 1./2.)*(xi/2. + 1./2.) + 54.*(eta/2. + 1./2.)*(zeta/2. + 1./2.) + 108.*(xi/2. + 1./2.)*(zeta/2. + 1./2.)*((eta + 1.)*(eta + 1.)/(2.*2.)) - 36.*(xi/2. + 1./2.)*(eta + 1.)*(eta + 1.)/(2.*2.) - 54.*(zeta/2. + 1./2.)*(eta + 1.)*(eta + 1.)/(2.*2.) - 9. + 18.*((eta + 1.)*(eta + 1.)/(2.*2.)));
                      default:
                        libmesh_error_msg("Invalid i = " << i);
                      }
                  } // j = 0

                  // d()/deta
                case 1:
                  {
                    switch(ii)
                      {
                      case 0:
                        return sign * RealGradient(3.*eta + 3.*xi + 8.*zeta + 36.*(eta/2. + 1./2.)*(xi/2. + 1./2.)*(zeta/2. + 1./2.) - 9.*(eta/2. + 1./2.)*(xi/2. + 1./2.) - 27.*(eta/2. + 1./2.)*(xi/2. + 1./2.)*(zeta + 1.)*(zeta + 1.)/(2.*2.) - 24.*(eta/2. + 1./2.)*(zeta/2. + 1./2.) + 18.*(eta/2. + 1./2.)*((zeta + 1.)*(zeta + 1.)/(2.*2.)) - 24.*(xi/2. + 1./2.)*(zeta/2. + 1./2.) + 18.*(xi/2. + 1./2.)*((zeta + 1.)*(zeta + 1.)/(2.*2.)) + 10. - 12.*(zeta + 1.)*(zeta + 1.)/(2.*2.), 0., 0.);
                      case 1:
                        return sign * RealGradient(-3.*eta/2. - 3.*xi - 4.*zeta - 36.*(eta/2. + 1./2.)*(xi/2. + 1./2.)*(zeta/2. + 1./2.) + 9.*(eta/2. + 1./2.)*(xi/2. + 1./2.) + 27.*(eta/2. + 1./2.)*(xi/2. + 1./2.)*((zeta + 1.)*(zeta + 1.)/(2.*2.)) + 12.*(eta/2. + 1./2.)*(zeta/2. + 1./2.) - 9.*(eta/2. + 1./2.)*(zeta + 1.)*(zeta + 1.)/(2.*2.) + 24.*(xi/2. + 1./2.)*(zeta/2. + 1./2.) - 18.*(xi/2. + 1./2.)*(zeta + 1.)*(zeta + 1.)/(2.*2.) - 13./2. + 6.*((zeta + 1.)*(zeta + 1.)/(2.*2.)), 0., 0.);
                      case 2:
                        return sign * RealGradient(0., 3.*xi/2. - 12.*(xi/2. + 1./2.)*(zeta/2. + 1./2.) + 9.*(xi/2. + 1./2.)*((zeta + 1.)*(zeta + 1.)/(2.*2.)) + 18.*(zeta/2. + 1./2.)*((xi + 1.)*(xi + 1.)/(2.*2.)) + 3./2. - 9.*(xi + 1.)*(xi + 1.)/(2.*2.)/2. - 27.*(zeta + 1.)*(zeta + 1.)/(2.*2.)*(xi + 1.)*(xi + 1.)/(2.*2.)/2., 0.);
                      case 3:
                        return sign * RealGradient(0., -3.*xi/2. + 12.*(xi/2. + 1./2.)*(zeta/2. + 1./2.) - 9.*(xi/2. + 1./2.)*(zeta + 1.)*(zeta + 1.)/(2.*2.) - 18.*(zeta/2. + 1./2.)*(xi + 1.)*(xi + 1.)/(2.*2.) - 3./2. + 9.*((xi + 1.)*(xi + 1.)/(2.*2.))/2. + 27.*((zeta + 1.)*(zeta + 1.)/(2.*2.))*((xi + 1.)*(xi + 1.)/(2.*2.))/2., 0.);
                      case 4:
                        return sign * RealGradient(3.*eta/2. + 3.*xi/2. + 2.*zeta + 36.*(eta/2. + 1./2.)*(xi/2. + 1./2.)*(zeta/2. + 1./2.) - 9.*(eta/2. + 1./2.)*(xi/2. + 1./2.) - 27.*(eta/2. + 1./2.)*(xi/2. + 1./2.)*(zeta + 1.)*(zeta + 1.)/(2.*2.) - 12.*(eta/2. + 1./2.)*(zeta/2. + 1./2.) + 9.*(eta/2. + 1./2.)*((zeta + 1.)*(zeta + 1.)/(2.*2.)) - 12.*(xi/2. + 1./2.)*(zeta/2. + 1./2.) + 9.*(xi/2. + 1./2.)*((zeta + 1.)*(zeta + 1.)/(2.*2.)) + 4. - 3.*(zeta + 1.)*(zeta + 1.)/(2.*2.), 0., 0.);
                      case 5:
                        return sign * RealGradient(-3.*eta - 3.*xi/2. - 4.*zeta - 36.*(eta/2. + 1./2.)*(xi/2. + 1./2.)*(zeta/2. + 1./2.) + 9.*(eta/2. + 1./2.)*(xi/2. + 1./2.) + 27.*(eta/2. + 1./2.)*(xi/2. + 1./2.)*((zeta + 1.)*(zeta + 1.)/(2.*2.)) + 24.*(eta/2. + 1./2.)*(zeta/2. + 1./2.) - 18.*(eta/2. + 1./2.)*(zeta + 1.)*(zeta + 1.)/(2.*2.) + 12.*(xi/2. + 1./2.)*(zeta/2. + 1./2.) - 9.*(xi/2. + 1./2.)*(zeta + 1.)*(zeta + 1.)/(2.*2.) - 13./2. + 6.*((zeta + 1.)*(zeta + 1.)/(2.*2.)), 0., 0.);
                      case 6:
                        return sign * RealGradient(0., 3.*xi + 3.*zeta - 24.*(xi/2. + 1./2.)*(zeta/2. + 1./2.) + 18.*(xi/2. + 1./2.)*((zeta + 1.)*(zeta + 1.)/(2.*2.)) + 18.*(zeta/2. + 1./2.)*((xi + 1.)*(xi + 1.)/(2.*2.)) + 9./2. - 9.*(xi + 1.)*(xi + 1.)/(2.*2.)/2. - 9.*(zeta + 1.)*(zeta + 1.)/(2.*2.)/2. - 27.*(zeta + 1.)*(zeta + 1.)/(2.*2.)*(xi + 1.)*(xi + 1.)/(2.*2.)/2., 0.);
                      case 7:
                        return sign * RealGradient(0., -3.*xi - 3.*zeta + 24.*(xi/2. + 1./2.)*(zeta/2. + 1./2.) - 18.*(xi/2. + 1./2.)*(zeta + 1.)*(zeta + 1.)/(2.*2.) - 18.*(zeta/2. + 1./2.)*(xi + 1.)*(xi + 1.)/(2.*2.) - 9./2. + 9.*((xi + 1.)*(xi + 1.)/(2.*2.))/2. + 9.*((zeta + 1.)*(zeta + 1.)/(2.*2.))/2. + 27.*((zeta + 1.)*(zeta + 1.)/(2.*2.))*((xi + 1.)*(xi + 1.)/(2.*2.))/2., 0.);
                      case 8:
                        return sign * RealGradient(0., 0., 3.*eta + 8.*xi + 3.*zeta + 36.*(eta/2. + 1./2.)*(xi/2. + 1./2.)*(zeta/2. + 1./2.) - 24.*(eta/2. + 1./2.)*(xi/2. + 1./2.) - 9.*(eta/2. + 1./2.)*(zeta/2. + 1./2.) - 27.*(eta/2. + 1./2.)*(zeta/2. + 1./2.)*(xi + 1.)*(xi + 1.)/(2.*2.) + 18.*(eta/2. + 1./2.)*((xi + 1.)*(xi + 1.)/(2.*2.)) - 24.*(xi/2. + 1./2.)*(zeta/2. + 1./2.) + 18.*(zeta/2. + 1./2.)*((xi + 1.)*(xi + 1.)/(2.*2.)) + 10. - 12.*(xi + 1.)*(xi + 1.)/(2.*2.));
                      case 9:
                        return sign * RealGradient(0., 0., -3.*eta/2. - 4.*xi - 3.*zeta - 36.*(eta/2. + 1./2.)*(xi/2. + 1./2.)*(zeta/2. + 1./2.) + 12.*(eta/2. + 1./2.)*(xi/2. + 1./2.) + 9.*(eta/2. + 1./2.)*(zeta/2. + 1./2.) + 27.*(eta/2. + 1./2.)*(zeta/2. + 1./2.)*((xi + 1.)*(xi + 1.)/(2.*2.)) - 9.*(eta/2. + 1./2.)*(xi + 1.)*(xi + 1.)/(2.*2.) + 24.*(xi/2. + 1./2.)*(zeta/2. + 1./2.) - 18.*(zeta/2. + 1./2.)*(xi + 1.)*(xi + 1.)/(2.*2.) - 13./2. + 6.*((xi + 1.)*(xi + 1.)/(2.*2.)));
                      case 10:
                        return sign * RealGradient(0., 0., 4.*xi + 18.*(eta/2. + 1./2.)*(xi/2. + 1./2.)*(zeta/2. + 1./2.) - 12.*(eta/2. + 1./2.)*(xi/2. + 1./2.) - 27.*(eta/2. + 1./2.)*(zeta/2. + 1./2.)*(xi + 1.)*(xi + 1.)/(2.*2.) + 18.*(eta/2. + 1./2.)*((xi + 1.)*(xi + 1.)/(2.*2.)) - 12.*(xi/2. + 1./2.)*(zeta/2. + 1./2.) + 18.*(zeta/2. + 1./2.)*((xi + 1.)*(xi + 1.)/(2.*2.)) + 4. - 12.*(xi + 1.)*(xi + 1.)/(2.*2.));
                      case 11:
                        return sign * RealGradient(0., 0., -2.*xi - 18.*(eta/2. + 1./2.)*(xi/2. + 1./2.)*(zeta/2. + 1./2.) + 6.*(eta/2. + 1./2.)*(xi/2. + 1./2.) + 27.*(eta/2. + 1./2.)*(zeta/2. + 1./2.)*((xi + 1.)*(xi + 1.)/(2.*2.)) - 9.*(eta/2. + 1./2.)*(xi + 1.)*(xi + 1.)/(2.*2.) + 12.*(xi/2. + 1./2.)*(zeta/2. + 1./2.) - 18.*(zeta/2. + 1./2.)*(xi + 1.)*(xi + 1.)/(2.*2.) - 2. + 6.*((xi + 1.)*(xi + 1.)/(2.*2.)));
                      case 12:
                        return sign * RealGradient(0., 0., 2.*xi + 18.*(eta/2. + 1./2.)*(xi/2. + 1./2.)*(zeta/2. + 1./2.) - 12.*(eta/2. + 1./2.)*(xi/2. + 1./2.) - 27.*(eta/2. + 1./2.)*(zeta/2. + 1./2.)*(xi + 1.)*(xi + 1.)/(2.*2.) + 18.*(eta/2. + 1./2.)*((xi + 1.)*(xi + 1.)/(2.*2.)) - 6.*(xi/2. + 1./2.)*(zeta/2. + 1./2.) + 9.*(zeta/2. + 1./2.)*((xi + 1.)*(xi + 1.)/(2.*2.)) + 2. - 6.*(xi + 1.)*(xi + 1.)/(2.*2.));
                      case 13:
                        return sign * RealGradient(0., 0., -xi - 18.*(eta/2. + 1./2.)*(xi/2. + 1./2.)*(zeta/2. + 1./2.) + 6.*(eta/2. + 1./2.)*(xi/2. + 1./2.) + 27.*(eta/2. + 1./2.)*(zeta/2. + 1./2.)*((xi + 1.)*(xi + 1.)/(2.*2.)) - 9.*(eta/2. + 1./2.)*(xi + 1.)*(xi + 1.)/(2.*2.) + 6.*(xi/2. + 1./2.)*(zeta/2. + 1./2.) - 9.*(zeta/2. + 1./2.)*(xi + 1.)*(xi + 1.)/(2.*2.) - 1. + 3.*((xi + 1.)*(xi + 1.)/(2.*2.)));
                      case 14:
                        return sign * RealGradient(0., 0., 3.*eta + 4.*xi + 3.*zeta/2. + 36.*(eta/2. + 1./2.)*(xi/2. + 1./2.)*(zeta/2. + 1./2.) - 24.*(eta/2. + 1./2.)*(xi/2. + 1./2.) - 9.*(eta/2. + 1./2.)*(zeta/2. + 1./2.) - 27.*(eta/2. + 1./2.)*(zeta/2. + 1./2.)*(xi + 1.)*(xi + 1.)/(2.*2.) + 18.*(eta/2. + 1./2.)*((xi + 1.)*(xi + 1.)/(2.*2.)) - 12.*(xi/2. + 1./2.)*(zeta/2. + 1./2.) + 9.*(zeta/2. + 1./2.)*((xi + 1.)*(xi + 1.)/(2.*2.)) + 13./2. - 6.*(xi + 1.)*(xi + 1.)/(2.*2.));
                      case 15:
                        return sign * RealGradient(0., 0., -3.*eta/2. - 2.*xi - 3.*zeta/2. - 36.*(eta/2. + 1./2.)*(xi/2. + 1./2.)*(zeta/2. + 1./2.) + 12.*(eta/2. + 1./2.)*(xi/2. + 1./2.) + 9.*(eta/2. + 1./2.)*(zeta/2. + 1./2.) + 27.*(eta/2. + 1./2.)*(zeta/2. + 1./2.)*((xi + 1.)*(xi + 1.)/(2.*2.)) - 9.*(eta/2. + 1./2.)*(xi + 1.)*(xi + 1.)/(2.*2.) + 12.*(xi/2. + 1./2.)*(zeta/2. + 1./2.) - 9.*(zeta/2. + 1./2.)*(xi + 1.)*(xi + 1.)/(2.*2.) - 4. + 3.*((xi + 1.)*(xi + 1.)/(2.*2.)));
                      case 16:
                        return sign * RealGradient(4.*zeta + 18.*(eta/2. + 1./2.)*(xi/2. + 1./2.)*(zeta/2. + 1./2.) - 27.*(eta/2. + 1./2.)*(xi/2. + 1./2.)*(zeta + 1.)*(zeta + 1.)/(2.*2.) - 12.*(eta/2. + 1./2.)*(zeta/2. + 1./2.) + 18.*(eta/2. + 1./2.)*((zeta + 1.)*(zeta + 1.)/(2.*2.)) - 12.*(xi/2. + 1./2.)*(zeta/2. + 1./2.) + 18.*(xi/2. + 1./2.)*((zeta + 1.)*(zeta + 1.)/(2.*2.)) + 4. - 12.*(zeta + 1.)*(zeta + 1.)/(2.*2.), 0., 0.);
                      case 17:
                        return sign * RealGradient(-2.*zeta - 18.*(eta/2. + 1./2.)*(xi/2. + 1./2.)*(zeta/2. + 1./2.) + 27.*(eta/2. + 1./2.)*(xi/2. + 1./2.)*((zeta + 1.)*(zeta + 1.)/(2.*2.)) + 6.*(eta/2. + 1./2.)*(zeta/2. + 1./2.) - 9.*(eta/2. + 1./2.)*(zeta + 1.)*(zeta + 1.)/(2.*2.) + 12.*(xi/2. + 1./2.)*(zeta/2. + 1./2.) - 18.*(xi/2. + 1./2.)*(zeta + 1.)*(zeta + 1.)/(2.*2.) - 2. + 6.*((zeta + 1.)*(zeta + 1.)/(2.*2.)), 0., 0.);
                      case 18:
                        return sign * RealGradient(0., -6.*(xi/2. + 1./2.)*(zeta/2. + 1./2.) + 9.*(xi/2. + 1./2.)*((zeta + 1.)*(zeta + 1.)/(2.*2.)) + 9.*(zeta/2. + 1./2.)*((xi + 1.)*(xi + 1.)/(2.*2.)) - 27.*(zeta + 1.)*(zeta + 1.)/(2.*2.)*(xi + 1.)*(xi + 1.)/(2.*2.)/2., 0.);
                      case 19:
                        return sign * RealGradient(0., 6.*(xi/2. + 1./2.)*(zeta/2. + 1./2.) - 9.*(xi/2. + 1./2.)*(zeta + 1.)*(zeta + 1.)/(2.*2.) - 9.*(zeta/2. + 1./2.)*(xi + 1.)*(xi + 1.)/(2.*2.) + 27.*((zeta + 1.)*(zeta + 1.)/(2.*2.))*((xi + 1.)*(xi + 1.)/(2.*2.))/2., 0.);
                      case 20:
                        return sign * RealGradient(zeta + 18.*(eta/2. + 1./2.)*(xi/2. + 1./2.)*(zeta/2. + 1./2.) - 27.*(eta/2. + 1./2.)*(xi/2. + 1./2.)*(zeta + 1.)*(zeta + 1.)/(2.*2.) - 6.*(eta/2. + 1./2.)*(zeta/2. + 1./2.) + 9.*(eta/2. + 1./2.)*((zeta + 1.)*(zeta + 1.)/(2.*2.)) - 6.*(xi/2. + 1./2.)*(zeta/2. + 1./2.) + 9.*(xi/2. + 1./2.)*((zeta + 1.)*(zeta + 1.)/(2.*2.)) + 1. - 3.*(zeta + 1.)*(zeta + 1.)/(2.*2.), 0., 0.);
                      case 21:
                        return sign * RealGradient(-2.*zeta - 18.*(eta/2. + 1./2.)*(xi/2. + 1./2.)*(zeta/2. + 1./2.) + 27.*(eta/2. + 1./2.)*(xi/2. + 1./2.)*((zeta + 1.)*(zeta + 1.)/(2.*2.)) + 12.*(eta/2. + 1./2.)*(zeta/2. + 1./2.) - 18.*(eta/2. + 1./2.)*(zeta + 1.)*(zeta + 1.)/(2.*2.) + 6.*(xi/2. + 1./2.)*(zeta/2. + 1./2.) - 9.*(xi/2. + 1./2.)*(zeta + 1.)*(zeta + 1.)/(2.*2.) - 2. + 6.*((zeta + 1.)*(zeta + 1.)/(2.*2.)), 0., 0.);
                      case 22:
                        return sign * RealGradient(0., 3.*zeta/2. - 12.*(xi/2. + 1./2.)*(zeta/2. + 1./2.) + 18.*(xi/2. + 1./2.)*((zeta + 1.)*(zeta + 1.)/(2.*2.)) + 9.*(zeta/2. + 1./2.)*((xi + 1.)*(xi + 1.)/(2.*2.)) + 3./2. - 9.*(zeta + 1.)*(zeta + 1.)/(2.*2.)/2. - 27.*(zeta + 1.)*(zeta + 1.)/(2.*2.)*(xi + 1.)*(xi + 1.)/(2.*2.)/2., 0.);
                      case 23:
                        return sign * RealGradient(0., -3.*zeta/2. + 12.*(xi/2. + 1./2.)*(zeta/2. + 1./2.) - 18.*(xi/2. + 1./2.)*(zeta + 1.)*(zeta + 1.)/(2.*2.) - 9.*(zeta/2. + 1./2.)*(xi + 1.)*(xi + 1.)/(2.*2.) - 3./2. + 9.*((zeta + 1.)*(zeta + 1.)/(2.*2.))/2. + 27.*((zeta + 1.)*(zeta + 1.)/(2.*2.))*((xi + 1.)*(xi + 1.)/(2.*2.))/2., 0.);
                      case 24:
                        return RealGradient(0., -9.*xi/2. + 36.*(xi/2. + 1./2.)*(zeta/2. + 1./2.) - 27.*(xi/2. + 1./2.)*(zeta + 1.)*(zeta + 1.)/(2.*2.) - 36.*(zeta/2. + 1./2.)*(xi + 1.)*(xi + 1.)/(2.*2.) - 9./2. + 9.*((xi + 1.)*(xi + 1.)/(2.*2.)) + 27.*((zeta + 1.)*(zeta + 1.)/(2.*2.))*((xi + 1.)*(xi + 1.)/(2.*2.)), 0.);
                      case 25:
                        return RealGradient(6.*eta + 9.*xi/2. + 12.*zeta + 72.*(eta/2. + 1./2.)*(xi/2. + 1./2.)*(zeta/2. + 1./2.) - 18.*(eta/2. + 1./2.)*(xi/2. + 1./2.) - 54.*(eta/2. + 1./2.)*(xi/2. + 1./2.)*(zeta + 1.)*(zeta + 1.)/(2.*2.) - 48.*(eta/2. + 1./2.)*(zeta/2. + 1./2.) + 36.*(eta/2. + 1./2.)*((zeta + 1.)*(zeta + 1.)/(2.*2.)) - 36.*(xi/2. + 1./2.)*(zeta/2. + 1./2.) + 27.*(xi/2. + 1./2.)*((zeta + 1.)*(zeta + 1.)/(2.*2.)) + 33./2. - 18.*(zeta + 1.)*(zeta + 1.)/(2.*2.), 0., 0.);
                      case 26:
                        return RealGradient(-3.*eta - 9.*xi/2. - 6.*zeta - 72.*(eta/2. + 1./2.)*(xi/2. + 1./2.)*(zeta/2. + 1./2.) + 18.*(eta/2. + 1./2.)*(xi/2. + 1./2.) + 54.*(eta/2. + 1./2.)*(xi/2. + 1./2.)*((zeta + 1.)*(zeta + 1.)/(2.*2.)) + 24.*(eta/2. + 1./2.)*(zeta/2. + 1./2.) - 18.*(eta/2. + 1./2.)*(zeta + 1.)*(zeta + 1.)/(2.*2.) + 36.*(xi/2. + 1./2.)*(zeta/2. + 1./2.) - 27.*(xi/2. + 1./2.)*(zeta + 1.)*(zeta + 1.)/(2.*2.) - 21./2. + 9.*((zeta + 1.)*(zeta + 1.)/(2.*2.)), 0., 0.);
                      case 27:
                        return RealGradient(0., 9.*xi/2. - 36.*(xi/2. + 1./2.)*(zeta/2. + 1./2.) + 27.*(xi/2. + 1./2.)*((zeta + 1.)*(zeta + 1.)/(2.*2.)) + 36.*(zeta/2. + 1./2.)*((xi + 1.)*(xi + 1.)/(2.*2.)) + 9./2. - 9.*(xi + 1.)*(xi + 1.)/(2.*2.) - 27.*(zeta + 1.)*(zeta + 1.)/(2.*2.)*(xi + 1.)*(xi + 1.)/(2.*2.), 0.);
                      case 28:
                        return RealGradient(0., 0., -12.*xi - 54.*(eta/2. + 1./2.)*(xi/2. + 1./2.)*(zeta/2. + 1./2.) + 36.*(eta/2. + 1./2.)*(xi/2. + 1./2.) + 54.*(eta/2. + 1./2.)*(zeta/2. + 1./2.)*((xi + 1.)*(xi + 1.)/(2.*2.)) - 36.*(eta/2. + 1./2.)*(xi + 1.)*(xi + 1.)/(2.*2.) + 36.*(xi/2. + 1./2.)*(zeta/2. + 1./2.) - 36.*(zeta/2. + 1./2.)*(xi + 1.)*(xi + 1.)/(2.*2.) - 12. + 24.*((xi + 1.)*(xi + 1.)/(2.*2.)));
                      case 29:
                        return RealGradient(12.*zeta + 54.*(eta/2. + 1./2.)*(xi/2. + 1./2.)*(zeta/2. + 1./2.) - 54.*(eta/2. + 1./2.)*(xi/2. + 1./2.)*(zeta + 1.)*(zeta + 1.)/(2.*2.) - 36.*(eta/2. + 1./2.)*(zeta/2. + 1./2.) + 36.*(eta/2. + 1./2.)*((zeta + 1.)*(zeta + 1.)/(2.*2.)) - 36.*(xi/2. + 1./2.)*(zeta/2. + 1./2.) + 36.*(xi/2. + 1./2.)*((zeta + 1.)*(zeta + 1.)/(2.*2.)) + 12. - 24.*(zeta + 1.)*(zeta + 1.)/(2.*2.), 0., 0.);
                      case 30:
                        return RealGradient(-6.*zeta - 54.*(eta/2. + 1./2.)*(xi/2. + 1./2.)*(zeta/2. + 1./2.) + 54.*(eta/2. + 1./2.)*(xi/2. + 1./2.)*((zeta + 1.)*(zeta + 1.)/(2.*2.)) + 18.*(eta/2. + 1./2.)*(zeta/2. + 1./2.) - 18.*(eta/2. + 1./2.)*(zeta + 1.)*(zeta + 1.)/(2.*2.) + 36.*(xi/2. + 1./2.)*(zeta/2. + 1./2.) - 36.*(xi/2. + 1./2.)*(zeta + 1.)*(zeta + 1.)/(2.*2.) - 6. + 12.*((zeta + 1.)*(zeta + 1.)/(2.*2.)), 0., 0.);
                      case 31:
                        return RealGradient(0., 0., 6.*xi + 54.*(eta/2. + 1./2.)*(xi/2. + 1./2.)*(zeta/2. + 1./2.) - 18.*(eta/2. + 1./2.)*(xi/2. + 1./2.) - 54.*(eta/2. + 1./2.)*(zeta/2. + 1./2.)*(xi + 1.)*(xi + 1.)/(2.*2.) + 18.*(eta/2. + 1./2.)*((xi + 1.)*(xi + 1.)/(2.*2.)) - 36.*(xi/2. + 1./2.)*(zeta/2. + 1./2.) + 36.*(zeta/2. + 1./2.)*((xi + 1.)*(xi + 1.)/(2.*2.)) + 6. - 12.*(xi + 1.)*(xi + 1.)/(2.*2.));
                      case 32:
                        return RealGradient(0., 0., -6.*xi - 36.*(eta/2. + 1./2.)*(xi/2. + 1./2.)*(zeta/2. + 1./2.) + 24.*(eta/2. + 1./2.)*(xi/2. + 1./2.) + 54.*(eta/2. + 1./2.)*(zeta/2. + 1./2.)*((xi + 1.)*(xi + 1.)/(2.*2.)) - 36.*(eta/2. + 1./2.)*(xi + 1.)*(xi + 1.)/(2.*2.) + 18.*(xi/2. + 1./2.)*(zeta/2. + 1./2.) - 27.*(zeta/2. + 1./2.)*(xi + 1.)*(xi + 1.)/(2.*2.) - 6. + 18.*((xi + 1.)*(xi + 1.)/(2.*2.)));
                      case 33:
                        return RealGradient(0., -18.*(xi/2. + 1./2.)*(zeta/2. + 1./2.) + 18.*(xi/2. + 1./2.)*((zeta + 1.)*(zeta + 1.)/(2.*2.)) + 27.*(zeta/2. + 1./2.)*((xi + 1.)*(xi + 1.)/(2.*2.)) - 27.*(zeta + 1.)*(zeta + 1.)/(2.*2.)*(xi + 1.)*(xi + 1.)/(2.*2.), 0.);
                      case 34:
                        return RealGradient(0., 18.*(xi/2. + 1./2.)*(zeta/2. + 1./2.) - 18.*(xi/2. + 1./2.)*(zeta + 1.)*(zeta + 1.)/(2.*2.) - 27.*(zeta/2. + 1./2.)*(xi + 1.)*(xi + 1.)/(2.*2.) + 27.*((zeta + 1.)*(zeta + 1.)/(2.*2.))*((xi + 1.)*(xi + 1.)/(2.*2.)), 0.);
                      case 35:
                        return RealGradient(0., 0., 3.*xi + 36.*(eta/2. + 1./2.)*(xi/2. + 1./2.)*(zeta/2. + 1./2.) - 12.*(eta/2. + 1./2.)*(xi/2. + 1./2.) - 54.*(eta/2. + 1./2.)*(zeta/2. + 1./2.)*(xi + 1.)*(xi + 1.)/(2.*2.) + 18.*(eta/2. + 1./2.)*((xi + 1.)*(xi + 1.)/(2.*2.)) - 18.*(xi/2. + 1./2.)*(zeta/2. + 1./2.) + 27.*(zeta/2. + 1./2.)*((xi + 1.)*(xi + 1.)/(2.*2.)) + 3. - 9.*(xi + 1.)*(xi + 1.)/(2.*2.));
                      case 36:
                        return RealGradient(0., 0., -6.*xi - 54.*(eta/2. + 1./2.)*(xi/2. + 1./2.)*(zeta/2. + 1./2.) + 36.*(eta/2. + 1./2.)*(xi/2. + 1./2.) + 54.*(eta/2. + 1./2.)*(zeta/2. + 1./2.)*((xi + 1.)*(xi + 1.)/(2.*2.)) - 36.*(eta/2. + 1./2.)*(xi + 1.)*(xi + 1.)/(2.*2.) + 18.*(xi/2. + 1./2.)*(zeta/2. + 1./2.) - 18.*(zeta/2. + 1./2.)*(xi + 1.)*(xi + 1.)/(2.*2.) - 6. + 12.*((xi + 1.)*(xi + 1.)/(2.*2.)));
                      case 37:
                        return RealGradient(6.*zeta + 54.*(eta/2. + 1./2.)*(xi/2. + 1./2.)*(zeta/2. + 1./2.) - 54.*(eta/2. + 1./2.)*(xi/2. + 1./2.)*(zeta + 1.)*(zeta + 1.)/(2.*2.) - 36.*(eta/2. + 1./2.)*(zeta/2. + 1./2.) + 36.*(eta/2. + 1./2.)*((zeta + 1.)*(zeta + 1.)/(2.*2.)) - 18.*(xi/2. + 1./2.)*(zeta/2. + 1./2.) + 18.*(xi/2. + 1./2.)*((zeta + 1.)*(zeta + 1.)/(2.*2.)) + 6. - 12.*(zeta + 1.)*(zeta + 1.)/(2.*2.), 0., 0.);
                      case 38:
                        return RealGradient(-3.*zeta - 54.*(eta/2. + 1./2.)*(xi/2. + 1./2.)*(zeta/2. + 1./2.) + 54.*(eta/2. + 1./2.)*(xi/2. + 1./2.)*((zeta + 1.)*(zeta + 1.)/(2.*2.)) + 18.*(eta/2. + 1./2.)*(zeta/2. + 1./2.) - 18.*(eta/2. + 1./2.)*(zeta + 1.)*(zeta + 1.)/(2.*2.) + 18.*(xi/2. + 1./2.)*(zeta/2. + 1./2.) - 18.*(xi/2. + 1./2.)*(zeta + 1.)*(zeta + 1.)/(2.*2.) - 3. + 6.*((zeta + 1.)*(zeta + 1.)/(2.*2.)), 0., 0.);
                      case 39:
                        return RealGradient(0., 0., 3.*xi + 54.*(eta/2. + 1./2.)*(xi/2. + 1./2.)*(zeta/2. + 1./2.) - 18.*(eta/2. + 1./2.)*(xi/2. + 1./2.) - 54.*(eta/2. + 1./2.)*(zeta/2. + 1./2.)*(xi + 1.)*(xi + 1.)/(2.*2.) + 18.*(eta/2. + 1./2.)*((xi + 1.)*(xi + 1.)/(2.*2.)) - 18.*(xi/2. + 1./2.)*(zeta/2. + 1./2.) + 18.*(zeta/2. + 1./2.)*((xi + 1.)*(xi + 1.)/(2.*2.)) + 3. - 6.*(xi + 1.)*(xi + 1.)/(2.*2.));
                      case 40:
                        return RealGradient(0., 0., -6.*eta - 12.*xi - 9.*zeta/2. - 72.*(eta/2. + 1./2.)*(xi/2. + 1./2.)*(zeta/2. + 1./2.) + 48.*(eta/2. + 1./2.)*(xi/2. + 1./2.) + 18.*(eta/2. + 1./2.)*(zeta/2. + 1./2.) + 54.*(eta/2. + 1./2.)*(zeta/2. + 1./2.)*((xi + 1.)*(xi + 1.)/(2.*2.)) - 36.*(eta/2. + 1./2.)*(xi + 1.)*(xi + 1.)/(2.*2.) + 36.*(xi/2. + 1./2.)*(zeta/2. + 1./2.) - 27.*(zeta/2. + 1./2.)*(xi + 1.)*(xi + 1.)/(2.*2.) - 33./2. + 18.*((xi + 1.)*(xi + 1.)/(2.*2.)));
                      case 41:
                        return RealGradient(0., 9.*zeta/2. - 36.*(xi/2. + 1./2.)*(zeta/2. + 1./2.) + 36.*(xi/2. + 1./2.)*((zeta + 1.)*(zeta + 1.)/(2.*2.)) + 27.*(zeta/2. + 1./2.)*((xi + 1.)*(xi + 1.)/(2.*2.)) + 9./2. - 9.*(zeta + 1.)*(zeta + 1.)/(2.*2.) - 27.*(zeta + 1.)*(zeta + 1.)/(2.*2.)*(xi + 1.)*(xi + 1.)/(2.*2.), 0.);
                      case 42:
                        return RealGradient(0., -9.*zeta/2. + 36.*(xi/2. + 1./2.)*(zeta/2. + 1./2.) - 36.*(xi/2. + 1./2.)*(zeta + 1.)*(zeta + 1.)/(2.*2.) - 27.*(zeta/2. + 1./2.)*(xi + 1.)*(xi + 1.)/(2.*2.) - 9./2. + 9.*((zeta + 1.)*(zeta + 1.)/(2.*2.)) + 27.*((zeta + 1.)*(zeta + 1.)/(2.*2.))*((xi + 1.)*(xi + 1.)/(2.*2.)), 0.);
                      case 43:
                        return RealGradient(0., 0., 3.*eta + 6.*xi + 9.*zeta/2. + 72.*(eta/2. + 1./2.)*(xi/2. + 1./2.)*(zeta/2. + 1./2.) - 24.*(eta/2. + 1./2.)*(xi/2. + 1./2.) - 18.*(eta/2. + 1./2.)*(zeta/2. + 1./2.) - 54.*(eta/2. + 1./2.)*(zeta/2. + 1./2.)*(xi + 1.)*(xi + 1.)/(2.*2.) + 18.*(eta/2. + 1./2.)*((xi + 1.)*(xi + 1.)/(2.*2.)) - 36.*(xi/2. + 1./2.)*(zeta/2. + 1./2.) + 27.*(zeta/2. + 1./2.)*((xi + 1.)*(xi + 1.)/(2.*2.)) + 21./2. - 9.*(xi + 1.)*(xi + 1.)/(2.*2.));
                      case 44:
                        return RealGradient(0., 18.*(xi/2. + 1./2.)*(zeta/2. + 1./2.) - 27.*(xi/2. + 1./2.)*(zeta + 1.)*(zeta + 1.)/(2.*2.) - 18.*(zeta/2. + 1./2.)*(xi + 1.)*(xi + 1.)/(2.*2.) + 27.*((zeta + 1.)*(zeta + 1.)/(2.*2.))*((xi + 1.)*(xi + 1.)/(2.*2.)), 0.);
                      case 45:
                        return RealGradient(6.*zeta + 36.*(eta/2. + 1./2.)*(xi/2. + 1./2.)*(zeta/2. + 1./2.) - 54.*(eta/2. + 1./2.)*(xi/2. + 1./2.)*(zeta + 1.)*(zeta + 1.)/(2.*2.) - 24.*(eta/2. + 1./2.)*(zeta/2. + 1./2.) + 36.*(eta/2. + 1./2.)*((zeta + 1.)*(zeta + 1.)/(2.*2.)) - 18.*(xi/2. + 1./2.)*(zeta/2. + 1./2.) + 27.*(xi/2. + 1./2.)*((zeta + 1.)*(zeta + 1.)/(2.*2.)) + 6. - 18.*(zeta + 1.)*(zeta + 1.)/(2.*2.), 0., 0.);
                      case 46:
                        return RealGradient(-3.*zeta - 36.*(eta/2. + 1./2.)*(xi/2. + 1./2.)*(zeta/2. + 1./2.) + 54.*(eta/2. + 1./2.)*(xi/2. + 1./2.)*((zeta + 1.)*(zeta + 1.)/(2.*2.)) + 12.*(eta/2. + 1./2.)*(zeta/2. + 1./2.) - 18.*(eta/2. + 1./2.)*(zeta + 1.)*(zeta + 1.)/(2.*2.) + 18.*(xi/2. + 1./2.)*(zeta/2. + 1./2.) - 27.*(xi/2. + 1./2.)*(zeta + 1.)*(zeta + 1.)/(2.*2.) - 3. + 9.*((zeta + 1.)*(zeta + 1.)/(2.*2.)), 0., 0.);
                      case 47:
                        return RealGradient(0., -18.*(xi/2. + 1./2.)*(zeta/2. + 1./2.) + 27.*(xi/2. + 1./2.)*((zeta + 1.)*(zeta + 1.)/(2.*2.)) + 18.*(zeta/2. + 1./2.)*((xi + 1.)*(xi + 1.)/(2.*2.)) - 27.*(zeta + 1.)*(zeta + 1.)/(2.*2.)*(xi + 1.)*(xi + 1.)/(2.*2.), 0.);
                      case 48:
                        return RealGradient(0., 0., 18.*xi + 108.*(eta/2. + 1./2.)*(xi/2. + 1./2.)*(zeta/2. + 1./2.) - 72.*(eta/2. + 1./2.)*(xi/2. + 1./2.) - 108.*(eta/2. + 1./2.)*(zeta/2. + 1./2.)*(xi + 1.)*(xi + 1.)/(2.*2.) + 72.*(eta/2. + 1./2.)*((xi + 1.)*(xi + 1.)/(2.*2.)) - 54.*(xi/2. + 1./2.)*(zeta/2. + 1./2.) + 54.*(zeta/2. + 1./2.)*((xi + 1.)*(xi + 1.)/(2.*2.)) + 18. - 36.*(xi + 1.)*(xi + 1.)/(2.*2.));
                      case 49:
                        return RealGradient(0., 54.*(xi/2. + 1./2.)*(zeta/2. + 1./2.) - 54.*(xi/2. + 1./2.)*(zeta + 1.)*(zeta + 1.)/(2.*2.) - 54.*(zeta/2. + 1./2.)*(xi + 1.)*(xi + 1.)/(2.*2.) + 54.*((zeta + 1.)*(zeta + 1.)/(2.*2.))*((xi + 1.)*(xi + 1.)/(2.*2.)), 0.);
                      case 50:
                        return RealGradient(18.*zeta + 108.*(eta/2. + 1./2.)*(xi/2. + 1./2.)*(zeta/2. + 1./2.) - 108.*(eta/2. + 1./2.)*(xi/2. + 1./2.)*(zeta + 1.)*(zeta + 1.)/(2.*2.) - 72.*(eta/2. + 1./2.)*(zeta/2. + 1./2.) + 72.*(eta/2. + 1./2.)*((zeta + 1.)*(zeta + 1.)/(2.*2.)) - 54.*(xi/2. + 1./2.)*(zeta/2. + 1./2.) + 54.*(xi/2. + 1./2.)*((zeta + 1.)*(zeta + 1.)/(2.*2.)) + 18. - 36.*(zeta + 1.)*(zeta + 1.)/(2.*2.), 0., 0.);
                      case 51:
                        return RealGradient(-9.*zeta - 108.*(eta/2. + 1./2.)*(xi/2. + 1./2.)*(zeta/2. + 1./2.) + 108.*(eta/2. + 1./2.)*(xi/2. + 1./2.)*((zeta + 1.)*(zeta + 1.)/(2.*2.)) + 36.*(eta/2. + 1./2.)*(zeta/2. + 1./2.) - 36.*(eta/2. + 1./2.)*(zeta + 1.)*(zeta + 1.)/(2.*2.) + 54.*(xi/2. + 1./2.)*(zeta/2. + 1./2.) - 54.*(xi/2. + 1./2.)*(zeta + 1.)*(zeta + 1.)/(2.*2.) - 9. + 18.*((zeta + 1.)*(zeta + 1.)/(2.*2.)), 0., 0.);
                      case 52:
                        return RealGradient(0., -54.*(xi/2. + 1./2.)*(zeta/2. + 1./2.) + 54.*(xi/2. + 1./2.)*((zeta + 1.)*(zeta + 1.)/(2.*2.)) + 54.*(zeta/2. + 1./2.)*((xi + 1.)*(xi + 1.)/(2.*2.)) - 54.*(zeta + 1.)*(zeta + 1.)/(2.*2.)*(xi + 1.)*(xi + 1.)/(2.*2.), 0.);
                      case 53:
                        return RealGradient(0., 0., -9.*xi - 108.*(eta/2. + 1./2.)*(xi/2. + 1./2.)*(zeta/2. + 1./2.) + 36.*(eta/2. + 1./2.)*(xi/2. + 1./2.) + 108.*(eta/2. + 1./2.)*(zeta/2. + 1./2.)*((xi + 1.)*(xi + 1.)/(2.*2.)) - 36.*(eta/2. + 1./2.)*(xi + 1.)*(xi + 1.)/(2.*2.) + 54.*(xi/2. + 1./2.)*(zeta/2. + 1./2.) - 54.*(zeta/2. + 1./2.)*(xi + 1.)*(xi + 1.)/(2.*2.) - 9. + 18.*((xi + 1.)*(xi + 1.)/(2.*2.)));
                      default:
                        libmesh_error_msg("Invalid i = " << i);
                      }
                  } // j = 1

                  // d()/dzeta
                case 2:
                  {
                    switch(ii)
                      {
                      case 0:
                        return sign * RealGradient(8.*eta + 3.*xi + 3.*zeta + 36.*(eta/2. + 1./2.)*(xi/2. + 1./2.)*(zeta/2. + 1./2.) - 24.*(eta/2. + 1./2.)*(xi/2. + 1./2.) - 24.*(eta/2. + 1./2.)*(zeta/2. + 1./2.) - 9.*(xi/2. + 1./2.)*(zeta/2. + 1./2.) - 27.*(xi/2. + 1./2.)*(zeta/2. + 1./2.)*(eta + 1.)*(eta + 1.)/(2.*2.) + 18.*(xi/2. + 1./2.)*((eta + 1.)*(eta + 1.)/(2.*2.)) + 18.*(zeta/2. + 1./2.)*((eta + 1.)*(eta + 1.)/(2.*2.)) + 10. - 12.*(eta + 1.)*(eta + 1.)/(2.*2.), 0., 0.);
                      case 1:
                        return sign * RealGradient(-4.*eta - 3.*xi - 3.*zeta/2. - 36.*(eta/2. + 1./2.)*(xi/2. + 1./2.)*(zeta/2. + 1./2.) + 24.*(eta/2. + 1./2.)*(xi/2. + 1./2.) + 12.*(eta/2. + 1./2.)*(zeta/2. + 1./2.) + 9.*(xi/2. + 1./2.)*(zeta/2. + 1./2.) + 27.*(xi/2. + 1./2.)*(zeta/2. + 1./2.)*((eta + 1.)*(eta + 1.)/(2.*2.)) - 18.*(xi/2. + 1./2.)*(eta + 1.)*(eta + 1.)/(2.*2.) - 9.*(zeta/2. + 1./2.)*(eta + 1.)*(eta + 1.)/(2.*2.) - 13./2. + 6.*((eta + 1.)*(eta + 1.)/(2.*2.)), 0., 0.);
                      case 2:
                        return sign * RealGradient(0., 4.*xi + 18.*(eta/2. + 1./2.)*(xi/2. + 1./2.)*(zeta/2. + 1./2.) - 12.*(eta/2. + 1./2.)*(xi/2. + 1./2.) - 27.*(eta/2. + 1./2.)*(zeta/2. + 1./2.)*(xi + 1.)*(xi + 1.)/(2.*2.) + 18.*(eta/2. + 1./2.)*((xi + 1.)*(xi + 1.)/(2.*2.)) - 12.*(xi/2. + 1./2.)*(zeta/2. + 1./2.) + 18.*(zeta/2. + 1./2.)*((xi + 1.)*(xi + 1.)/(2.*2.)) + 4. - 12.*(xi + 1.)*(xi + 1.)/(2.*2.), 0.);
                      case 3:
                        return sign * RealGradient(0., -2.*xi - 18.*(eta/2. + 1./2.)*(xi/2. + 1./2.)*(zeta/2. + 1./2.) + 12.*(eta/2. + 1./2.)*(xi/2. + 1./2.) + 27.*(eta/2. + 1./2.)*(zeta/2. + 1./2.)*((xi + 1.)*(xi + 1.)/(2.*2.)) - 18.*(eta/2. + 1./2.)*(xi + 1.)*(xi + 1.)/(2.*2.) + 6.*(xi/2. + 1./2.)*(zeta/2. + 1./2.) - 9.*(zeta/2. + 1./2.)*(xi + 1.)*(xi + 1.)/(2.*2.) - 2. + 6.*((xi + 1.)*(xi + 1.)/(2.*2.)), 0.);
                      case 4:
                        return sign * RealGradient(2.*eta + 18.*(eta/2. + 1./2.)*(xi/2. + 1./2.)*(zeta/2. + 1./2.) - 12.*(eta/2. + 1./2.)*(xi/2. + 1./2.) - 6.*(eta/2. + 1./2.)*(zeta/2. + 1./2.) - 27.*(xi/2. + 1./2.)*(zeta/2. + 1./2.)*(eta + 1.)*(eta + 1.)/(2.*2.) + 18.*(xi/2. + 1./2.)*((eta + 1.)*(eta + 1.)/(2.*2.)) + 9.*(zeta/2. + 1./2.)*((eta + 1.)*(eta + 1.)/(2.*2.)) + 2. - 6.*(eta + 1.)*(eta + 1.)/(2.*2.), 0., 0.);
                      case 5:
                        return sign * RealGradient(-4.*eta - 18.*(eta/2. + 1./2.)*(xi/2. + 1./2.)*(zeta/2. + 1./2.) + 12.*(eta/2. + 1./2.)*(xi/2. + 1./2.) + 12.*(eta/2. + 1./2.)*(zeta/2. + 1./2.) + 27.*(xi/2. + 1./2.)*(zeta/2. + 1./2.)*((eta + 1.)*(eta + 1.)/(2.*2.)) - 18.*(xi/2. + 1./2.)*(eta + 1.)*(eta + 1.)/(2.*2.) - 18.*(zeta/2. + 1./2.)*(eta + 1.)*(eta + 1.)/(2.*2.) - 4. + 12.*((eta + 1.)*(eta + 1.)/(2.*2.)), 0., 0.);
                      case 6:
                        return sign * RealGradient(0., 3.*eta + 8.*xi + 3.*zeta + 36.*(eta/2. + 1./2.)*(xi/2. + 1./2.)*(zeta/2. + 1./2.) - 24.*(eta/2. + 1./2.)*(xi/2. + 1./2.) - 9.*(eta/2. + 1./2.)*(zeta/2. + 1./2.) - 27.*(eta/2. + 1./2.)*(zeta/2. + 1./2.)*(xi + 1.)*(xi + 1.)/(2.*2.) + 18.*(eta/2. + 1./2.)*((xi + 1.)*(xi + 1.)/(2.*2.)) - 24.*(xi/2. + 1./2.)*(zeta/2. + 1./2.) + 18.*(zeta/2. + 1./2.)*((xi + 1.)*(xi + 1.)/(2.*2.)) + 10. - 12.*(xi + 1.)*(xi + 1.)/(2.*2.), 0.);
                      case 7:
                        return sign * RealGradient(0., -3.*eta - 4.*xi - 3.*zeta/2. - 36.*(eta/2. + 1./2.)*(xi/2. + 1./2.)*(zeta/2. + 1./2.) + 24.*(eta/2. + 1./2.)*(xi/2. + 1./2.) + 9.*(eta/2. + 1./2.)*(zeta/2. + 1./2.) + 27.*(eta/2. + 1./2.)*(zeta/2. + 1./2.)*((xi + 1.)*(xi + 1.)/(2.*2.)) - 18.*(eta/2. + 1./2.)*(xi + 1.)*(xi + 1.)/(2.*2.) + 12.*(xi/2. + 1./2.)*(zeta/2. + 1./2.) - 9.*(zeta/2. + 1./2.)*(xi + 1.)*(xi + 1.)/(2.*2.) - 13./2. + 6.*((xi + 1.)*(xi + 1.)/(2.*2.)), 0.);
                      case 8:
                        return sign * RealGradient(0., 0., 3.*eta + 3.*xi - 24.*(eta/2. + 1./2.)*(xi/2. + 1./2.) + 18.*(eta/2. + 1./2.)*((xi + 1.)*(xi + 1.)/(2.*2.)) + 18.*(xi/2. + 1./2.)*((eta + 1.)*(eta + 1.)/(2.*2.)) + 9./2. - 9.*(eta + 1.)*(eta + 1.)/(2.*2.)/2. - 27.*(eta + 1.)*(eta + 1.)/(2.*2.)*(xi + 1.)*(xi + 1.)/(2.*2.)/2. - 9.*(xi + 1.)*(xi + 1.)/(2.*2.)/2.);
                      case 9:
                        return sign * RealGradient(0., 0., -3.*eta - 3.*xi + 24.*(eta/2. + 1./2.)*(xi/2. + 1./2.) - 18.*(eta/2. + 1./2.)*(xi + 1.)*(xi + 1.)/(2.*2.) - 18.*(xi/2. + 1./2.)*(eta + 1.)*(eta + 1.)/(2.*2.) - 9./2. + 9.*((eta + 1.)*(eta + 1.)/(2.*2.))/2. + 27.*((eta + 1.)*(eta + 1.)/(2.*2.))*((xi + 1.)*(xi + 1.)/(2.*2.))/2. + 9.*((xi + 1.)*(xi + 1.)/(2.*2.))/2.);
                      case 10:
                        return sign * RealGradient(0., 0., 3.*xi/2. - 12.*(eta/2. + 1./2.)*(xi/2. + 1./2.) + 18.*(eta/2. + 1./2.)*((xi + 1.)*(xi + 1.)/(2.*2.)) + 9.*(xi/2. + 1./2.)*((eta + 1.)*(eta + 1.)/(2.*2.)) + 3./2. - 27.*(eta + 1.)*(eta + 1.)/(2.*2.)*(xi + 1.)*(xi + 1.)/(2.*2.)/2. - 9.*(xi + 1.)*(xi + 1.)/(2.*2.)/2.);
                      case 11:
                        return sign * RealGradient(0., 0., -3.*xi/2. + 12.*(eta/2. + 1./2.)*(xi/2. + 1./2.) - 18.*(eta/2. + 1./2.)*(xi + 1.)*(xi + 1.)/(2.*2.) - 9.*(xi/2. + 1./2.)*(eta + 1.)*(eta + 1.)/(2.*2.) - 3./2. + 27.*((eta + 1.)*(eta + 1.)/(2.*2.))*((xi + 1.)*(xi + 1.)/(2.*2.))/2. + 9.*((xi + 1.)*(xi + 1.)/(2.*2.))/2.);
                      case 12:
                        return sign * RealGradient(0., 0., -6.*(eta/2. + 1./2.)*(xi/2. + 1./2.) + 9.*(eta/2. + 1./2.)*((xi + 1.)*(xi + 1.)/(2.*2.)) + 9.*(xi/2. + 1./2.)*((eta + 1.)*(eta + 1.)/(2.*2.)) - 27.*(eta + 1.)*(eta + 1.)/(2.*2.)*(xi + 1.)*(xi + 1.)/(2.*2.)/2.);
                      case 13:
                        return sign * RealGradient(0., 0., 6.*(eta/2. + 1./2.)*(xi/2. + 1./2.) - 9.*(eta/2. + 1./2.)*(xi + 1.)*(xi + 1.)/(2.*2.) - 9.*(xi/2. + 1./2.)*(eta + 1.)*(eta + 1.)/(2.*2.) + 27.*((eta + 1.)*(eta + 1.)/(2.*2.))*((xi + 1.)*(xi + 1.)/(2.*2.))/2.);
                      case 14:
                        return sign * RealGradient(0., 0., 3.*eta/2. - 12.*(eta/2. + 1./2.)*(xi/2. + 1./2.) + 9.*(eta/2. + 1./2.)*((xi + 1.)*(xi + 1.)/(2.*2.)) + 18.*(xi/2. + 1./2.)*((eta + 1.)*(eta + 1.)/(2.*2.)) + 3./2. - 9.*(eta + 1.)*(eta + 1.)/(2.*2.)/2. - 27.*(eta + 1.)*(eta + 1.)/(2.*2.)*(xi + 1.)*(xi + 1.)/(2.*2.)/2.);
                      case 15:
                        return sign * RealGradient(0., 0., -3.*eta/2. + 12.*(eta/2. + 1./2.)*(xi/2. + 1./2.) - 9.*(eta/2. + 1./2.)*(xi + 1.)*(xi + 1.)/(2.*2.) - 18.*(xi/2. + 1./2.)*(eta + 1.)*(eta + 1.)/(2.*2.) - 3./2. + 9.*((eta + 1.)*(eta + 1.)/(2.*2.))/2. + 27.*((eta + 1.)*(eta + 1.)/(2.*2.))*((xi + 1.)*(xi + 1.)/(2.*2.))/2.);
                      case 16:
                        return sign * RealGradient(4.*eta + 3.*xi/2. + 3.*zeta + 36.*(eta/2. + 1./2.)*(xi/2. + 1./2.)*(zeta/2. + 1./2.) - 12.*(eta/2. + 1./2.)*(xi/2. + 1./2.) - 24.*(eta/2. + 1./2.)*(zeta/2. + 1./2.) - 9.*(xi/2. + 1./2.)*(zeta/2. + 1./2.) - 27.*(xi/2. + 1./2.)*(zeta/2. + 1./2.)*(eta + 1.)*(eta + 1.)/(2.*2.) + 9.*(xi/2. + 1./2.)*((eta + 1.)*(eta + 1.)/(2.*2.)) + 18.*(zeta/2. + 1./2.)*((eta + 1.)*(eta + 1.)/(2.*2.)) + 13./2. - 6.*(eta + 1.)*(eta + 1.)/(2.*2.), 0., 0.);
                      case 17:
                        return sign * RealGradient(-2.*eta - 3.*xi/2. - 3.*zeta/2. - 36.*(eta/2. + 1./2.)*(xi/2. + 1./2.)*(zeta/2. + 1./2.) + 12.*(eta/2. + 1./2.)*(xi/2. + 1./2.) + 12.*(eta/2. + 1./2.)*(zeta/2. + 1./2.) + 9.*(xi/2. + 1./2.)*(zeta/2. + 1./2.) + 27.*(xi/2. + 1./2.)*(zeta/2. + 1./2.)*((eta + 1.)*(eta + 1.)/(2.*2.)) - 9.*(xi/2. + 1./2.)*(eta + 1.)*(eta + 1.)/(2.*2.) - 9.*(zeta/2. + 1./2.)*(eta + 1.)*(eta + 1.)/(2.*2.) - 4. + 3.*((eta + 1.)*(eta + 1.)/(2.*2.)), 0., 0.);
                      case 18:
                        return sign * RealGradient(0., 2.*xi + 18.*(eta/2. + 1./2.)*(xi/2. + 1./2.)*(zeta/2. + 1./2.) - 6.*(eta/2. + 1./2.)*(xi/2. + 1./2.) - 27.*(eta/2. + 1./2.)*(zeta/2. + 1./2.)*(xi + 1.)*(xi + 1.)/(2.*2.) + 9.*(eta/2. + 1./2.)*((xi + 1.)*(xi + 1.)/(2.*2.)) - 12.*(xi/2. + 1./2.)*(zeta/2. + 1./2.) + 18.*(zeta/2. + 1./2.)*((xi + 1.)*(xi + 1.)/(2.*2.)) + 2. - 6.*(xi + 1.)*(xi + 1.)/(2.*2.), 0.);
                      case 19:
                        return sign * RealGradient(0., -xi - 18.*(eta/2. + 1./2.)*(xi/2. + 1./2.)*(zeta/2. + 1./2.) + 6.*(eta/2. + 1./2.)*(xi/2. + 1./2.) + 27.*(eta/2. + 1./2.)*(zeta/2. + 1./2.)*((xi + 1.)*(xi + 1.)/(2.*2.)) - 9.*(eta/2. + 1./2.)*(xi + 1.)*(xi + 1.)/(2.*2.) + 6.*(xi/2. + 1./2.)*(zeta/2. + 1./2.) - 9.*(zeta/2. + 1./2.)*(xi + 1.)*(xi + 1.)/(2.*2.) - 1. + 3.*((xi + 1.)*(xi + 1.)/(2.*2.)), 0.);
                      case 20:
                        return sign * RealGradient(eta + 18.*(eta/2. + 1./2.)*(xi/2. + 1./2.)*(zeta/2. + 1./2.) - 6.*(eta/2. + 1./2.)*(xi/2. + 1./2.) - 6.*(eta/2. + 1./2.)*(zeta/2. + 1./2.) - 27.*(xi/2. + 1./2.)*(zeta/2. + 1./2.)*(eta + 1.)*(eta + 1.)/(2.*2.) + 9.*(xi/2. + 1./2.)*((eta + 1.)*(eta + 1.)/(2.*2.)) + 9.*(zeta/2. + 1./2.)*((eta + 1.)*(eta + 1.)/(2.*2.)) + 1. - 3.*(eta + 1.)*(eta + 1.)/(2.*2.), 0., 0.);
                      case 21:
                        return sign * RealGradient(-2.*eta - 18.*(eta/2. + 1./2.)*(xi/2. + 1./2.)*(zeta/2. + 1./2.) + 6.*(eta/2. + 1./2.)*(xi/2. + 1./2.) + 12.*(eta/2. + 1./2.)*(zeta/2. + 1./2.) + 27.*(xi/2. + 1./2.)*(zeta/2. + 1./2.)*((eta + 1.)*(eta + 1.)/(2.*2.)) - 9.*(xi/2. + 1./2.)*(eta + 1.)*(eta + 1.)/(2.*2.) - 18.*(zeta/2. + 1./2.)*(eta + 1.)*(eta + 1.)/(2.*2.) - 2. + 6.*((eta + 1.)*(eta + 1.)/(2.*2.)), 0., 0.);
                      case 22:
                        return sign * RealGradient(0., 3.*eta/2. + 4.*xi + 3.*zeta + 36.*(eta/2. + 1./2.)*(xi/2. + 1./2.)*(zeta/2. + 1./2.) - 12.*(eta/2. + 1./2.)*(xi/2. + 1./2.) - 9.*(eta/2. + 1./2.)*(zeta/2. + 1./2.) - 27.*(eta/2. + 1./2.)*(zeta/2. + 1./2.)*(xi + 1.)*(xi + 1.)/(2.*2.) + 9.*(eta/2. + 1./2.)*((xi + 1.)*(xi + 1.)/(2.*2.)) - 24.*(xi/2. + 1./2.)*(zeta/2. + 1./2.) + 18.*(zeta/2. + 1./2.)*((xi + 1.)*(xi + 1.)/(2.*2.)) + 13./2. - 6.*(xi + 1.)*(xi + 1.)/(2.*2.), 0.);
                      case 23:
                        return sign * RealGradient(0., -3.*eta/2. - 2.*xi - 3.*zeta/2. - 36.*(eta/2. + 1./2.)*(xi/2. + 1./2.)*(zeta/2. + 1./2.) + 12.*(eta/2. + 1./2.)*(xi/2. + 1./2.) + 9.*(eta/2. + 1./2.)*(zeta/2. + 1./2.) + 27.*(eta/2. + 1./2.)*(zeta/2. + 1./2.)*((xi + 1.)*(xi + 1.)/(2.*2.)) - 9.*(eta/2. + 1./2.)*(xi + 1.)*(xi + 1.)/(2.*2.) + 12.*(xi/2. + 1./2.)*(zeta/2. + 1./2.) - 9.*(zeta/2. + 1./2.)*(xi + 1.)*(xi + 1.)/(2.*2.) - 4. + 3.*((xi + 1.)*(xi + 1.)/(2.*2.)), 0.);
                      case 24:
                        return RealGradient(0., -12.*xi - 54.*(eta/2. + 1./2.)*(xi/2. + 1./2.)*(zeta/2. + 1./2.) + 36.*(eta/2. + 1./2.)*(xi/2. + 1./2.) + 54.*(eta/2. + 1./2.)*(zeta/2. + 1./2.)*((xi + 1.)*(xi + 1.)/(2.*2.)) - 36.*(eta/2. + 1./2.)*(xi + 1.)*(xi + 1.)/(2.*2.) + 36.*(xi/2. + 1./2.)*(zeta/2. + 1./2.) - 36.*(zeta/2. + 1./2.)*(xi + 1.)*(xi + 1.)/(2.*2.) - 12. + 24.*((xi + 1.)*(xi + 1.)/(2.*2.)), 0.);
                      case 25:
                        return RealGradient(12.*eta + 54.*(eta/2. + 1./2.)*(xi/2. + 1./2.)*(zeta/2. + 1./2.) - 36.*(eta/2. + 1./2.)*(xi/2. + 1./2.) - 36.*(eta/2. + 1./2.)*(zeta/2. + 1./2.) - 54.*(xi/2. + 1./2.)*(zeta/2. + 1./2.)*(eta + 1.)*(eta + 1.)/(2.*2.) + 36.*(xi/2. + 1./2.)*((eta + 1.)*(eta + 1.)/(2.*2.)) + 36.*(zeta/2. + 1./2.)*((eta + 1.)*(eta + 1.)/(2.*2.)) + 12. - 24.*(eta + 1.)*(eta + 1.)/(2.*2.), 0., 0.);
                      case 26:
                        return RealGradient(-6.*eta - 54.*(eta/2. + 1./2.)*(xi/2. + 1./2.)*(zeta/2. + 1./2.) + 36.*(eta/2. + 1./2.)*(xi/2. + 1./2.) + 18.*(eta/2. + 1./2.)*(zeta/2. + 1./2.) + 54.*(xi/2. + 1./2.)*(zeta/2. + 1./2.)*((eta + 1.)*(eta + 1.)/(2.*2.)) - 36.*(xi/2. + 1./2.)*(eta + 1.)*(eta + 1.)/(2.*2.) - 18.*(zeta/2. + 1./2.)*(eta + 1.)*(eta + 1.)/(2.*2.) - 6. + 12.*((eta + 1.)*(eta + 1.)/(2.*2.)), 0., 0.);
                      case 27:
                        return RealGradient(0., 6.*xi + 54.*(eta/2. + 1./2.)*(xi/2. + 1./2.)*(zeta/2. + 1./2.) - 36.*(eta/2. + 1./2.)*(xi/2. + 1./2.) - 54.*(eta/2. + 1./2.)*(zeta/2. + 1./2.)*(xi + 1.)*(xi + 1.)/(2.*2.) + 36.*(eta/2. + 1./2.)*((xi + 1.)*(xi + 1.)/(2.*2.)) - 18.*(xi/2. + 1./2.)*(zeta/2. + 1./2.) + 18.*(zeta/2. + 1./2.)*((xi + 1.)*(xi + 1.)/(2.*2.)) + 6. - 12.*(xi + 1.)*(xi + 1.)/(2.*2.), 0.);
                      case 28:
                        return RealGradient(0., 0., -9.*xi/2. + 36.*(eta/2. + 1./2.)*(xi/2. + 1./2.) - 36.*(eta/2. + 1./2.)*(xi + 1.)*(xi + 1.)/(2.*2.) - 27.*(xi/2. + 1./2.)*(eta + 1.)*(eta + 1.)/(2.*2.) - 9./2. + 27.*((eta + 1.)*(eta + 1.)/(2.*2.))*((xi + 1.)*(xi + 1.)/(2.*2.)) + 9.*((xi + 1.)*(xi + 1.)/(2.*2.)));
                      case 29:
                        return RealGradient(12.*eta + 9.*xi/2. + 6.*zeta + 72.*(eta/2. + 1./2.)*(xi/2. + 1./2.)*(zeta/2. + 1./2.) - 36.*(eta/2. + 1./2.)*(xi/2. + 1./2.) - 48.*(eta/2. + 1./2.)*(zeta/2. + 1./2.) - 18.*(xi/2. + 1./2.)*(zeta/2. + 1./2.) - 54.*(xi/2. + 1./2.)*(zeta/2. + 1./2.)*(eta + 1.)*(eta + 1.)/(2.*2.) + 27.*(xi/2. + 1./2.)*((eta + 1.)*(eta + 1.)/(2.*2.)) + 36.*(zeta/2. + 1./2.)*((eta + 1.)*(eta + 1.)/(2.*2.)) + 33./2. - 18.*(eta + 1.)*(eta + 1.)/(2.*2.), 0., 0.);
                      case 30:
                        return RealGradient(-6.*eta - 9.*xi/2. - 3.*zeta - 72.*(eta/2. + 1./2.)*(xi/2. + 1./2.)*(zeta/2. + 1./2.) + 36.*(eta/2. + 1./2.)*(xi/2. + 1./2.) + 24.*(eta/2. + 1./2.)*(zeta/2. + 1./2.) + 18.*(xi/2. + 1./2.)*(zeta/2. + 1./2.) + 54.*(xi/2. + 1./2.)*(zeta/2. + 1./2.)*((eta + 1.)*(eta + 1.)/(2.*2.)) - 27.*(xi/2. + 1./2.)*(eta + 1.)*(eta + 1.)/(2.*2.) - 18.*(zeta/2. + 1./2.)*(eta + 1.)*(eta + 1.)/(2.*2.) - 21./2. + 9.*((eta + 1.)*(eta + 1.)/(2.*2.)), 0., 0.);
                      case 31:
                        return RealGradient(0., 0., 9.*xi/2. - 36.*(eta/2. + 1./2.)*(xi/2. + 1./2.) + 36.*(eta/2. + 1./2.)*((xi + 1.)*(xi + 1.)/(2.*2.)) + 27.*(xi/2. + 1./2.)*((eta + 1.)*(eta + 1.)/(2.*2.)) + 9./2. - 27.*(eta + 1.)*(eta + 1.)/(2.*2.)*(xi + 1.)*(xi + 1.)/(2.*2.) - 9.*(xi + 1.)*(xi + 1.)/(2.*2.));
                      case 32:
                        return RealGradient(0., 0., 18.*(eta/2. + 1./2.)*(xi/2. + 1./2.) - 27.*(eta/2. + 1./2.)*(xi + 1.)*(xi + 1.)/(2.*2.) - 18.*(xi/2. + 1./2.)*(eta + 1.)*(eta + 1.)/(2.*2.) + 27.*((eta + 1.)*(eta + 1.)/(2.*2.))*((xi + 1.)*(xi + 1.)/(2.*2.)));
                      case 33:
                        return RealGradient(0., 6.*xi + 36.*(eta/2. + 1./2.)*(xi/2. + 1./2.)*(zeta/2. + 1./2.) - 18.*(eta/2. + 1./2.)*(xi/2. + 1./2.) - 54.*(eta/2. + 1./2.)*(zeta/2. + 1./2.)*(xi + 1.)*(xi + 1.)/(2.*2.) + 27.*(eta/2. + 1./2.)*((xi + 1.)*(xi + 1.)/(2.*2.)) - 24.*(xi/2. + 1./2.)*(zeta/2. + 1./2.) + 36.*(zeta/2. + 1./2.)*((xi + 1.)*(xi + 1.)/(2.*2.)) + 6. - 18.*(xi + 1.)*(xi + 1.)/(2.*2.), 0.);
                      case 34:
                        return RealGradient(0., -3.*xi - 36.*(eta/2. + 1./2.)*(xi/2. + 1./2.)*(zeta/2. + 1./2.) + 18.*(eta/2. + 1./2.)*(xi/2. + 1./2.) + 54.*(eta/2. + 1./2.)*(zeta/2. + 1./2.)*((xi + 1.)*(xi + 1.)/(2.*2.)) - 27.*(eta/2. + 1./2.)*(xi + 1.)*(xi + 1.)/(2.*2.) + 12.*(xi/2. + 1./2.)*(zeta/2. + 1./2.) - 18.*(zeta/2. + 1./2.)*(xi + 1.)*(xi + 1.)/(2.*2.) - 3. + 9.*((xi + 1.)*(xi + 1.)/(2.*2.)), 0.);
                      case 35:
                        return RealGradient(0., 0., -18.*(eta/2. + 1./2.)*(xi/2. + 1./2.) + 27.*(eta/2. + 1./2.)*((xi + 1.)*(xi + 1.)/(2.*2.)) + 18.*(xi/2. + 1./2.)*((eta + 1.)*(eta + 1.)/(2.*2.)) - 27.*(eta + 1.)*(eta + 1.)/(2.*2.)*(xi + 1.)*(xi + 1.)/(2.*2.));
                      case 36:
                        return RealGradient(0., 0., 18.*(eta/2. + 1./2.)*(xi/2. + 1./2.) - 18.*(eta/2. + 1./2.)*(xi + 1.)*(xi + 1.)/(2.*2.) - 27.*(xi/2. + 1./2.)*(eta + 1.)*(eta + 1.)/(2.*2.) + 27.*((eta + 1.)*(eta + 1.)/(2.*2.))*((xi + 1.)*(xi + 1.)/(2.*2.)));
                      case 37:
                        return RealGradient(6.*eta + 36.*(eta/2. + 1./2.)*(xi/2. + 1./2.)*(zeta/2. + 1./2.) - 18.*(eta/2. + 1./2.)*(xi/2. + 1./2.) - 24.*(eta/2. + 1./2.)*(zeta/2. + 1./2.) - 54.*(xi/2. + 1./2.)*(zeta/2. + 1./2.)*(eta + 1.)*(eta + 1.)/(2.*2.) + 27.*(xi/2. + 1./2.)*((eta + 1.)*(eta + 1.)/(2.*2.)) + 36.*(zeta/2. + 1./2.)*((eta + 1.)*(eta + 1.)/(2.*2.)) + 6. - 18.*(eta + 1.)*(eta + 1.)/(2.*2.), 0., 0.);
                      case 38:
                        return RealGradient(-3.*eta - 36.*(eta/2. + 1./2.)*(xi/2. + 1./2.)*(zeta/2. + 1./2.) + 18.*(eta/2. + 1./2.)*(xi/2. + 1./2.) + 12.*(eta/2. + 1./2.)*(zeta/2. + 1./2.) + 54.*(xi/2. + 1./2.)*(zeta/2. + 1./2.)*((eta + 1.)*(eta + 1.)/(2.*2.)) - 27.*(xi/2. + 1./2.)*(eta + 1.)*(eta + 1.)/(2.*2.) - 18.*(zeta/2. + 1./2.)*(eta + 1.)*(eta + 1.)/(2.*2.) - 3. + 9.*((eta + 1.)*(eta + 1.)/(2.*2.)), 0., 0.);
                      case 39:
                        return RealGradient(0., 0., -18.*(eta/2. + 1./2.)*(xi/2. + 1./2.) + 18.*(eta/2. + 1./2.)*((xi + 1.)*(xi + 1.)/(2.*2.)) + 27.*(xi/2. + 1./2.)*((eta + 1.)*(eta + 1.)/(2.*2.)) - 27.*(eta + 1.)*(eta + 1.)/(2.*2.)*(xi + 1.)*(xi + 1.)/(2.*2.));
                      case 40:
                        return RealGradient(0., 0., -9.*eta/2. + 36.*(eta/2. + 1./2.)*(xi/2. + 1./2.) - 27.*(eta/2. + 1./2.)*(xi + 1.)*(xi + 1.)/(2.*2.) - 36.*(xi/2. + 1./2.)*(eta + 1.)*(eta + 1.)/(2.*2.) - 9./2. + 9.*((eta + 1.)*(eta + 1.)/(2.*2.)) + 27.*((eta + 1.)*(eta + 1.)/(2.*2.))*((xi + 1.)*(xi + 1.)/(2.*2.)));
                      case 41:
                        return RealGradient(0., 9.*eta/2. + 12.*xi + 6.*zeta + 72.*(eta/2. + 1./2.)*(xi/2. + 1./2.)*(zeta/2. + 1./2.) - 36.*(eta/2. + 1./2.)*(xi/2. + 1./2.) - 18.*(eta/2. + 1./2.)*(zeta/2. + 1./2.) - 54.*(eta/2. + 1./2.)*(zeta/2. + 1./2.)*(xi + 1.)*(xi + 1.)/(2.*2.) + 27.*(eta/2. + 1./2.)*((xi + 1.)*(xi + 1.)/(2.*2.)) - 48.*(xi/2. + 1./2.)*(zeta/2. + 1./2.) + 36.*(zeta/2. + 1./2.)*((xi + 1.)*(xi + 1.)/(2.*2.)) + 33./2. - 18.*(xi + 1.)*(xi + 1.)/(2.*2.), 0.);
                      case 42:
                        return RealGradient(0., -9.*eta/2. - 6.*xi - 3.*zeta - 72.*(eta/2. + 1./2.)*(xi/2. + 1./2.)*(zeta/2. + 1./2.) + 36.*(eta/2. + 1./2.)*(xi/2. + 1./2.) + 18.*(eta/2. + 1./2.)*(zeta/2. + 1./2.) + 54.*(eta/2. + 1./2.)*(zeta/2. + 1./2.)*((xi + 1.)*(xi + 1.)/(2.*2.)) - 27.*(eta/2. + 1./2.)*(xi + 1.)*(xi + 1.)/(2.*2.) + 24.*(xi/2. + 1./2.)*(zeta/2. + 1./2.) - 18.*(zeta/2. + 1./2.)*(xi + 1.)*(xi + 1.)/(2.*2.) - 21./2. + 9.*((xi + 1.)*(xi + 1.)/(2.*2.)), 0.);
                      case 43:
                        return RealGradient(0., 0., 9.*eta/2. - 36.*(eta/2. + 1./2.)*(xi/2. + 1./2.) + 27.*(eta/2. + 1./2.)*((xi + 1.)*(xi + 1.)/(2.*2.)) + 36.*(xi/2. + 1./2.)*((eta + 1.)*(eta + 1.)/(2.*2.)) + 9./2. - 9.*(eta + 1.)*(eta + 1.)/(2.*2.) - 27.*(eta + 1.)*(eta + 1.)/(2.*2.)*(xi + 1.)*(xi + 1.)/(2.*2.));
                      case 44:
                        return RealGradient(0., -6.*xi - 54.*(eta/2. + 1./2.)*(xi/2. + 1./2.)*(zeta/2. + 1./2.) + 18.*(eta/2. + 1./2.)*(xi/2. + 1./2.) + 54.*(eta/2. + 1./2.)*(zeta/2. + 1./2.)*((xi + 1.)*(xi + 1.)/(2.*2.)) - 18.*(eta/2. + 1./2.)*(xi + 1.)*(xi + 1.)/(2.*2.) + 36.*(xi/2. + 1./2.)*(zeta/2. + 1./2.) - 36.*(zeta/2. + 1./2.)*(xi + 1.)*(xi + 1.)/(2.*2.) - 6. + 12.*((xi + 1.)*(xi + 1.)/(2.*2.)), 0.);
                      case 45:
                        return RealGradient(6.*eta + 54.*(eta/2. + 1./2.)*(xi/2. + 1./2.)*(zeta/2. + 1./2.) - 18.*(eta/2. + 1./2.)*(xi/2. + 1./2.) - 36.*(eta/2. + 1./2.)*(zeta/2. + 1./2.) - 54.*(xi/2. + 1./2.)*(zeta/2. + 1./2.)*(eta + 1.)*(eta + 1.)/(2.*2.) + 18.*(xi/2. + 1./2.)*((eta + 1.)*(eta + 1.)/(2.*2.)) + 36.*(zeta/2. + 1./2.)*((eta + 1.)*(eta + 1.)/(2.*2.)) + 6. - 12.*(eta + 1.)*(eta + 1.)/(2.*2.), 0., 0.);
                      case 46:
                        return RealGradient(-3.*eta - 54.*(eta/2. + 1./2.)*(xi/2. + 1./2.)*(zeta/2. + 1./2.) + 18.*(eta/2. + 1./2.)*(xi/2. + 1./2.) + 18.*(eta/2. + 1./2.)*(zeta/2. + 1./2.) + 54.*(xi/2. + 1./2.)*(zeta/2. + 1./2.)*((eta + 1.)*(eta + 1.)/(2.*2.)) - 18.*(xi/2. + 1./2.)*(eta + 1.)*(eta + 1.)/(2.*2.) - 18.*(zeta/2. + 1./2.)*(eta + 1.)*(eta + 1.)/(2.*2.) - 3. + 6.*((eta + 1.)*(eta + 1.)/(2.*2.)), 0., 0.);
                      case 47:
                        return RealGradient(0., 3.*xi + 54.*(eta/2. + 1./2.)*(xi/2. + 1./2.)*(zeta/2. + 1./2.) - 18.*(eta/2. + 1./2.)*(xi/2. + 1./2.) - 54.*(eta/2. + 1./2.)*(zeta/2. + 1./2.)*(xi + 1.)*(xi + 1.)/(2.*2.) + 18.*(eta/2. + 1./2.)*((xi + 1.)*(xi + 1.)/(2.*2.)) - 18.*(xi/2. + 1./2.)*(zeta/2. + 1./2.) + 18.*(zeta/2. + 1./2.)*((xi + 1.)*(xi + 1.)/(2.*2.)) + 3. - 6.*(xi + 1.)*(xi + 1.)/(2.*2.), 0.);
                      case 48:
                        return RealGradient(0., 0., -54.*(eta/2. + 1./2.)*(xi/2. + 1./2.) + 54.*(eta/2. + 1./2.)*((xi + 1.)*(xi + 1.)/(2.*2.)) + 54.*(xi/2. + 1./2.)*((eta + 1.)*(eta + 1.)/(2.*2.)) - 54.*(eta + 1.)*(eta + 1.)/(2.*2.)*(xi + 1.)*(xi + 1.)/(2.*2.));
                      case 49:
                        return RealGradient(0., -18.*xi - 108.*(eta/2. + 1./2.)*(xi/2. + 1./2.)*(zeta/2. + 1./2.) + 54.*(eta/2. + 1./2.)*(xi/2. + 1./2.) + 108.*(eta/2. + 1./2.)*(zeta/2. + 1./2.)*((xi + 1.)*(xi + 1.)/(2.*2.)) - 54.*(eta/2. + 1./2.)*(xi + 1.)*(xi + 1.)/(2.*2.) + 72.*(xi/2. + 1./2.)*(zeta/2. + 1./2.) - 72.*(zeta/2. + 1./2.)*(xi + 1.)*(xi + 1.)/(2.*2.) - 18. + 36.*((xi + 1.)*(xi + 1.)/(2.*2.)), 0.);
                      case 50:
                        return RealGradient(18.*eta + 108.*(eta/2. + 1./2.)*(xi/2. + 1./2.)*(zeta/2. + 1./2.) - 54.*(eta/2. + 1./2.)*(xi/2. + 1./2.) - 72.*(eta/2. + 1./2.)*(zeta/2. + 1./2.) - 108.*(xi/2. + 1./2.)*(zeta/2. + 1./2.)*(eta + 1.)*(eta + 1.)/(2.*2.) + 54.*(xi/2. + 1./2.)*((eta + 1.)*(eta + 1.)/(2.*2.)) + 72.*(zeta/2. + 1./2.)*((eta + 1.)*(eta + 1.)/(2.*2.)) + 18. - 36.*(eta + 1.)*(eta + 1.)/(2.*2.), 0., 0.);
                      case 51:
                        return RealGradient(-9.*eta - 108.*(eta/2. + 1./2.)*(xi/2. + 1./2.)*(zeta/2. + 1./2.) + 54.*(eta/2. + 1./2.)*(xi/2. + 1./2.) + 36.*(eta/2. + 1./2.)*(zeta/2. + 1./2.) + 108.*(xi/2. + 1./2.)*(zeta/2. + 1./2.)*((eta + 1.)*(eta + 1.)/(2.*2.)) - 54.*(xi/2. + 1./2.)*(eta + 1.)*(eta + 1.)/(2.*2.) - 36.*(zeta/2. + 1./2.)*(eta + 1.)*(eta + 1.)/(2.*2.) - 9. + 18.*((eta + 1.)*(eta + 1.)/(2.*2.)), 0., 0.);
                      case 52:
                        return RealGradient(0., 9.*xi + 108.*(eta/2. + 1./2.)*(xi/2. + 1./2.)*(zeta/2. + 1./2.) - 54.*(eta/2. + 1./2.)*(xi/2. + 1./2.) - 108.*(eta/2. + 1./2.)*(zeta/2. + 1./2.)*(xi + 1.)*(xi + 1.)/(2.*2.) + 54.*(eta/2. + 1./2.)*((xi + 1.)*(xi + 1.)/(2.*2.)) - 36.*(xi/2. + 1./2.)*(zeta/2. + 1./2.) + 36.*(zeta/2. + 1./2.)*((xi + 1.)*(xi + 1.)/(2.*2.)) + 9. - 18.*(xi + 1.)*(xi + 1.)/(2.*2.), 0.);
                      case 53:
                        return RealGradient(0., 0., 54.*(eta/2. + 1./2.)*(xi/2. + 1./2.) - 54.*(eta/2. + 1./2.)*(xi + 1.)*(xi + 1.)/(2.*2.) - 54.*(xi/2. + 1./2.)*(eta + 1.)*(eta + 1.)/(2.*2.) + 54.*((eta + 1.)*(eta + 1.)/(2.*2.))*((xi + 1.)*(xi + 1.)/(2.*2.)));
                      default:
                        libmesh_error_msg("Invalid i = " << i);
                      }
                  } // j = 2

                default:
                  libmesh_error_msg("Invalid j = " << j);
                }
            }

          case TET14:
            {
              switch (j)
                {
                  // d()/dxi
                case 0:
                  {
                    switch(ii)
                      {
                      case 0:
                        return sign * RealGradient(8.*eta + 8.*zeta - 6., -8.*eta - 16.*xi - 8.*zeta + 6., -8.*eta - 16.*xi - 8.*zeta + 6.);
                      case 1:
                        return sign * RealGradient(-8.*eta - 8.*zeta + 6., 16.*xi - 4., 16.*xi - 4.);
                      case 2:
                        return sign * RealGradient(-8.*eta, 16.*xi - 4., 0.);
                      case 3:
                        return sign * RealGradient(0., 8.*eta - 2., 0.);
                      case 4:
                        return sign * RealGradient(-8.*eta, 8.*eta + 16.*xi + 16.*zeta - 12., -8.*eta);
                      case 5:
                        return sign * RealGradient(0., 2. - 8.*eta, 0.);
                      case 6:
                        return sign * RealGradient(-8.*zeta, -8.*zeta, 16.*eta + 16.*xi + 8.*zeta - 12.);
                      case 7:
                        return sign * RealGradient(0., 0., 2. - 8.*zeta);
                      case 8:
                        return sign * RealGradient(-8.*zeta, 0., 16.*xi - 4.);
                      case 9:
                        return sign * RealGradient(0., 0., 8.*zeta - 2.);
                      case 10:
                        return sign * RealGradient(0., 0., 0.);
                      case 11:
                        return sign * RealGradient(0., 0., 0.);
                      case 12:
                        return RealGradient(-8.*eta, 16.*eta + 16.*xi + 8.*zeta - 8., 8.*eta);
                      case 13:
                        return RealGradient(16.*eta, -8.*eta - 32.*xi - 16.*zeta + 16., 8.*eta);
                      case 14:
                        return RealGradient(-8.*zeta, 8.*zeta, 8.*eta + 16.*xi + 16.*zeta - 8.);
                      case 15:
                        return RealGradient(16.*zeta, 8.*zeta, -16.*eta - 32.*xi - 8.*zeta + 16.);
                      case 16:
                        return RealGradient(0., 16.*zeta, -8.*eta);
                      case 17:
                        return RealGradient(0., -8.*zeta, 16.*eta);
                      case 18:
                        return RealGradient(0., -16.*zeta, 8.*eta);
                      case 19:
                        return RealGradient(0., 8.*zeta, -16.*eta);
                      default:
                        libmesh_error_msg("Invalid i = " << i);
                      }
                  } // j = 0

                  // d()/deta
                case 1:
                  {
                    switch(ii)
                      {
                      case 0:
                        return sign * RealGradient(16.*eta + 8.*xi + 16.*zeta - 12., -8.*xi, -8.*xi);
                      case 1:
                        return sign * RealGradient(2. - 8.*xi, 0., 0.);
                      case 2:
                        return sign * RealGradient(2. - 8.*xi, 0., 0.);
                      case 3:
                        return sign * RealGradient(4. - 16.*eta, 8.*xi, 0.);
                      case 4:
                        return sign * RealGradient(-16.*eta - 8.*xi - 8.*zeta + 6., 8.*xi + 8.*zeta - 6., -16.*eta - 8.*xi - 8.*zeta + 6.);
                      case 5:
                        return sign * RealGradient(16.*eta - 4., -8.*xi - 8.*zeta + 6., 16.*eta - 4.);
                      case 6:
                        return sign * RealGradient(-8.*zeta, -8.*zeta, 16.*eta + 16.*xi + 8.*zeta - 12.);
                      case 7:
                        return sign * RealGradient(0., 0., 2. - 8.*zeta);
                      case 8:
                        return sign * RealGradient(0., 0., 0.);
                      case 9:
                        return sign * RealGradient(0., 0., 0.);
                      case 10:
                        return sign * RealGradient(0., -8.*zeta, 16.*eta - 4.);
                      case 11:
                        return sign * RealGradient(0., 0., 8.*zeta - 2.);
                      case 12:
                        return RealGradient(-32.*eta - 8.*xi - 16.*zeta + 16., 16.*xi, 8.*xi);
                      case 13:
                        return RealGradient(16.*eta + 16.*xi + 8.*zeta - 8., -8.*xi, 8.*xi);
                      case 14:
                        return RealGradient(-16.*zeta, 0., 8.*xi);
                      case 15:
                        return RealGradient(8.*zeta, 0., -16.*xi);
                      case 16:
                        return RealGradient(-8.*zeta, 0., -8.*xi);
                      case 17:
                        return RealGradient(-8.*zeta, 0., 16.*xi);
                      case 18:
                        return RealGradient(8.*zeta, -8.*zeta, 16.*eta + 8.*xi + 16.*zeta - 8.);
                      case 19:
                        return RealGradient(8.*zeta, 16.*zeta, -32.*eta - 16.*xi - 8.*zeta + 16.);
                      default:
                        libmesh_error_msg("Invalid i = " << i);
                      }
                  } // j = 1

                  // d()/dzeta
                case 2:
                  {
                    switch(ii)
                      {
                      case 0:
                        return sign * RealGradient(16.*eta + 8.*xi + 16.*zeta - 12., -8.*xi, -8.*xi);
                      case 1:
                        return sign * RealGradient(2. - 8.*xi, 0., 0.);
                      case 2:
                        return sign * RealGradient(0., 0., 0.);
                      case 3:
                        return sign * RealGradient(0., 0., 0.);
                      case 4:
                        return sign * RealGradient(-8.*eta, 8.*eta + 16.*xi + 16.*zeta - 12., -8.*eta);
                      case 5:
                        return sign * RealGradient(0., 2. - 8.*eta, 0.);
                      case 6:
                        return sign * RealGradient(-8.*eta - 8.*xi - 16.*zeta + 6., -8.*eta - 8.*xi - 16.*zeta + 6., 8.*eta + 8.*xi - 6.);
                      case 7:
                        return sign * RealGradient(16.*zeta - 4., 16.*zeta - 4., -8.*eta - 8.*xi + 6.);
                      case 8:
                        return sign * RealGradient(2. - 8.*xi, 0., 0.);
                      case 9:
                        return sign * RealGradient(4. - 16.*zeta, 0., 8.*xi);
                      case 10:
                        return sign * RealGradient(0., 2. - 8.*eta, 0.);
                      case 11:
                        return sign * RealGradient(0., 4. - 16.*zeta, 8.*eta);
                      case 12:
                        return RealGradient(-16.*eta, 8.*xi, 0.);
                      case 13:
                        return RealGradient(8.*eta, -16.*xi, 0.);
                      case 14:
                        return RealGradient(-16.*eta - 8.*xi - 32.*zeta + 16., 8.*xi, 16.*xi);
                      case 15:
                        return RealGradient(8.*eta + 16.*xi + 16.*zeta - 8., 8.*xi, -8.*xi);
                      case 16:
                        return RealGradient(-8.*eta, 16.*xi, 0.);
                      case 17:
                        return RealGradient(-8.*eta, -8.*xi, 0.);
                      case 18:
                        return RealGradient(8.*eta, -8.*eta - 16.*xi - 32.*zeta + 16., 16.*eta);
                      case 19:
                        return RealGradient(8.*eta, 16.*eta + 8.*xi + 16.*zeta - 8., -8.*eta);
                      default:
                        libmesh_error_msg("Invalid i = " << i);
                      }
                  } // j = 2

                default:
                  libmesh_error_msg("Invalid j = " << j);
                }
            }

          default:
            libmesh_error_msg("ERROR: Unsupported 3D element type!: " << Utility::enum_to_string(elem->type()));
          } // end switch (type)
      } // end case SECOND

      // unsupported order
    default:
      libmesh_error_msg("ERROR: Unsupported 3D FE order!: " << totalorder);
    }

#else // LIBMESH_DIM != 3
  libmesh_ignore(elem, order, i, j, p, add_p_level);
  libmesh_not_implemented();
#endif
}




template <>
RealGradient FE<3,NEDELEC_ONE>::shape_deriv(const ElemType,
                                            const Order,
                                            const unsigned int,
                                            const unsigned int,
                                            const Point &)
{
  libmesh_error_msg("Nedelec elements require the element type \nbecause edge orientation is needed.");
  return RealGradient();
}


template <>
RealGradient FE<3,NEDELEC_ONE>::shape_deriv(const FEType fet,
                                            const Elem * elem,
                                            const unsigned int i,
                                            const unsigned int j,
                                            const Point & p,
                                            const bool add_p_level)
{
  return FE<3,NEDELEC_ONE>::shape_deriv(elem, fet.order, i, j, p, add_p_level);
}



#ifdef LIBMESH_ENABLE_SECOND_DERIVATIVES

template <>
RealGradient FE<3,NEDELEC_ONE>::shape_second_deriv(const Elem * elem,
                                                   const Order order,
                                                   const unsigned int i,
                                                   const unsigned int j,
                                                   const Point &,
                                                   const bool add_p_level)
{
#if LIBMESH_DIM == 3

  libmesh_assert(elem);

  // j = 0 ==> d^2 phi / dxi^2
  // j = 1 ==> d^2 phi / dxi deta
  // j = 2 ==> d^2 phi / deta^2
  // j = 3 ==> d^2 phi / dxi dzeta
  // j = 4 ==> d^2 phi / deta dzeta
  // j = 5 ==> d^2 phi / dzeta^2
  libmesh_assert_less (j, 6);

  const Order totalorder = static_cast<Order>(order + add_p_level * elem->p_level());
  libmesh_assert_less(i, n_dofs(elem->type(), totalorder));

  const char sign = elem->point(elem->local_edge_node(i, 0)) > elem->point(elem->local_edge_node(i, 1)) ? 1 : -1;

  switch (totalorder)
    {
      // linear Nedelec (first kind) shape function second derivatives
    case FIRST:
      {
        switch (elem->type())
          {
          case HEX20:
          case HEX27:
            {
              switch (j)
                {
                  // d^2()/dxi^2
                case 0:
                  {
                    // All d^2()/dxi^2 derivatives for linear hexes are zero.
                    return RealGradient();
                  } // j = 0

                  // d^2()/dxideta
                case 1:
                  {
                    switch(i)
                      {
                      case 0:
                      case 1:
                      case 2:
                      case 3:
                      case 8:
                      case 9:
                      case 10:
                      case 11:
                        return RealGradient();
                      case 4:
                      case 6:
                        return sign * RealGradient( 0.0, 0.0, -0.125 );
                      case 5:
                      case 7:
                        return sign * RealGradient( 0.0, 0.0,  0.125 );

                      default:
                        libmesh_error_msg("Invalid i = " << i);
                      } // switch(i)

                  } // j = 1

                  // d^2()/deta^2
                case 2:
                  {
                    // All d^2()/deta^2 derivatives for linear hexes are zero.
                    return RealGradient();
                  } // j = 2

                  // d^2()/dxidzeta
                case 3:
                  {
                    switch(i)
                      {
                      case 0:
                      case 2:
                      case 4:
                      case 5:
                      case 6:
                      case 7:
                      case 8:
                      case 10:
                        return RealGradient();
                      case 1:
                      case 3:
                      case 11:
                        return sign * RealGradient( 0.0,  0.125 );
                      case 9:
                        return sign * RealGradient( 0.0, -0.125, 0.0 );

                      default:
                        libmesh_error_msg("Invalid i = " << i);
                      } // switch(i)

                  } // j = 3

                  // d^2()/detadzeta
                case 4:
                  {
                    switch(i)
                      {
                      case 0:
                        return sign * RealGradient( -0.125, 0.0, 0.0 );
                      case 1:
                      case 3:
                      case 4:
                      case 5:
                      case 6:
                      case 7:
                      case 9:
                      case 11:
                        return RealGradient();
                      case 2:
                      case 8:
                      case 10:
                        return sign * RealGradient(  0.125, 0.0, 0.0 );

                      default:
                        libmesh_error_msg("Invalid i = " << i);
                      } // switch(i)

                  } // j = 4

                  // d^2()/dzeta^2
                case 5:
                  {
                    // All d^2()/dzeta^2 derivatives for linear hexes are zero.
                    return RealGradient();
                  } // j = 5

                default:
                  libmesh_error_msg("Invalid j = " << j);
                }
            }

          case TET10:
          case TET14:
            {
              // All second derivatives for linear tets are zero.
              return RealGradient();
            }

          default:
            libmesh_error_msg("ERROR: Unsupported 3D element type!: " << Utility::enum_to_string(elem->type()));

          } //switch(type)

      } // case FIRST:

      // quadratic Nedelec (first kind) shape function second derivatives
    case SECOND:
      {
        switch (elem->type())
          {
          case HEX27:
            {
              switch (j)
                {
                  // d^2()/dxi^2
                case 0:
                  {
                    switch(ii)
                      {
                      case 0:
                        return sign * RealGradient(0., 0., 0.);
                      case 1:
                        return sign * RealGradient(0., 0., 0.);
                      case 2:
                        return sign * RealGradient(0., -9.*eta/4. - 6.*zeta + 9.*(eta + 1.)*(zeta + 1.)/2. - 27.*(eta + 1.)*(zeta + 1.)*(zeta + 1.)/16. - 21./4. + 9.*((zeta + 1.)*(zeta + 1.))/4., 0.);
                      case 3:
                        return sign * RealGradient(0., 9.*eta/4. + 3.*zeta - 9.*(eta + 1.)*(zeta + 1.)/2. + 27.*(eta + 1.)*((zeta + 1.)*(zeta + 1.))/16. + 15./4. - 9.*(zeta + 1.)*(zeta + 1.)/8., 0.);
                      case 4:
                        return sign * RealGradient(0., 0., 0.);
                      case 5:
                        return sign * RealGradient(0., 0., 0.);
                      case 6:
                        return sign * RealGradient(0., -9.*eta/4. - 6.*zeta + 9.*(eta + 1.)*(zeta + 1.)/2. - 27.*(eta + 1.)*(zeta + 1.)*(zeta + 1.)/16. - 21./4. + 9.*((zeta + 1.)*(zeta + 1.))/4., 0.);
                      case 7:
                        return sign * RealGradient(0., 9.*eta/4. + 3.*zeta - 9.*(eta + 1.)*(zeta + 1.)/2. + 27.*(eta + 1.)*((zeta + 1.)*(zeta + 1.))/16. + 15./4. - 9.*(zeta + 1.)*(zeta + 1.)/8., 0.);
                      case 8:
                        return sign * RealGradient(0., 0., -6.*eta - 9.*zeta/4. + 9.*(eta + 1.)*(zeta + 1.)/2. - 27.*(zeta + 1.)*(eta + 1.)*(eta + 1.)/16. - 21./4. + 9.*((eta + 1.)*(eta + 1.))/4.);
                      case 9:
                        return sign * RealGradient(0., 0., 3.*eta + 9.*zeta/4. - 9.*(eta + 1.)*(zeta + 1.)/2. + 27.*(zeta + 1.)*((eta + 1.)*(eta + 1.))/16. + 15./4. - 9.*(eta + 1.)*(eta + 1.)/8.);
                      case 10:
                        return sign * RealGradient(0., 0., -6.*eta - 9.*zeta/4. + 9.*(eta + 1.)*(zeta + 1.)/2. - 27.*(zeta + 1.)*(eta + 1.)*(eta + 1.)/16. - 21./4. + 9.*((eta + 1.)*(eta + 1.))/4.);
                      case 11:
                        return sign * RealGradient(0., 0., 3.*eta + 9.*zeta/4. - 9.*(eta + 1.)*(zeta + 1.)/2. + 27.*(zeta + 1.)*((eta + 1.)*(eta + 1.))/16. + 15./4. - 9.*(eta + 1.)*(eta + 1.)/8.);
                      case 12:
                        return sign * RealGradient(0., 0., -3.*eta + 9.*(eta + 1.)*(zeta + 1.)/4. - 27.*(zeta + 1.)*(eta + 1.)*(eta + 1.)/16. - 3. + 9.*((eta + 1.)*(eta + 1.))/4.);
                      case 13:
                        return sign * RealGradient(0., 0., 3.*eta/2. - 9.*(eta + 1.)*(zeta + 1.)/4. + 27.*(zeta + 1.)*((eta + 1.)*(eta + 1.))/16. + 3./2. - 9.*(eta + 1.)*(eta + 1.)/8.);
                      case 14:
                        return sign * RealGradient(0., 0., -3.*eta + 9.*(eta + 1.)*(zeta + 1.)/4. - 27.*(zeta + 1.)*(eta + 1.)*(eta + 1.)/16. - 3. + 9.*((eta + 1.)*(eta + 1.))/4.);
                      case 15:
                        return sign * RealGradient(0., 0., 3.*eta/2. - 9.*(eta + 1.)*(zeta + 1.)/4. + 27.*(zeta + 1.)*((eta + 1.)*(eta + 1.))/16. + 3./2. - 9.*(eta + 1.)*(eta + 1.)/8.);
                      case 16:
                        return sign * RealGradient(0., 0., 0.);
                      case 17:
                        return sign * RealGradient(0., 0., 0.);
                      case 18:
                        return sign * RealGradient(0., -3.*zeta + 9.*(eta + 1.)*(zeta + 1.)/4. - 27.*(eta + 1.)*(zeta + 1.)*(zeta + 1.)/16. - 3. + 9.*((zeta + 1.)*(zeta + 1.))/4., 0.);
                      case 19:
                        return sign * RealGradient(0., 3.*zeta/2. - 9.*(eta + 1.)*(zeta + 1.)/4. + 27.*(eta + 1.)*((zeta + 1.)*(zeta + 1.))/16. + 3./2. - 9.*(zeta + 1.)*(zeta + 1.)/8., 0.);
                      case 20:
                        return sign * RealGradient(0., 0., 0.);
                      case 21:
                        return sign * RealGradient(0., 0., 0.);
                      case 22:
                        return sign * RealGradient(0., -3.*zeta + 9.*(eta + 1.)*(zeta + 1.)/4. - 27.*(eta + 1.)*(zeta + 1.)*(zeta + 1.)/16. - 3. + 9.*((zeta + 1.)*(zeta + 1.))/4., 0.);
                      case 23:
                        return sign * RealGradient(0., 3.*zeta/2. - 9.*(eta + 1.)*(zeta + 1.)/4. + 27.*(eta + 1.)*((zeta + 1.)*(zeta + 1.))/16. + 3./2. - 9.*(zeta + 1.)*(zeta + 1.)/8., 0.);
                      case 24:
                        return RealGradient(0., 9.*eta/2. + 12.*zeta - 9.*(eta + 1.)*(zeta + 1.) + 27.*(eta + 1.)*((zeta + 1.)*(zeta + 1.))/8. + 21./2. - 9.*(zeta + 1.)*(zeta + 1.)/2., 0.);
                      case 25:
                        return RealGradient(0., 0., 0.);
                      case 26:
                        return RealGradient(0., 0., 0.);
                      case 27:
                        return RealGradient(0., -9.*eta/2. - 6.*zeta + 9.*(eta + 1.)*(zeta + 1.) - 27.*(eta + 1.)*(zeta + 1.)*(zeta + 1.)/8. - 15./2. + 9.*((zeta + 1.)*(zeta + 1.))/4., 0.);
                      case 28:
                        return RealGradient(0., 0., 12.*eta + 9.*zeta/2. - 9.*(eta + 1.)*(zeta + 1.) + 27.*(zeta + 1.)*((eta + 1.)*(eta + 1.))/8. + 21./2. - 9.*(eta + 1.)*(eta + 1.)/2.);
                      case 29:
                        return RealGradient(0., 0., 0.);
                      case 30:
                        return RealGradient(0., 0., 0.);
                      case 31:
                        return RealGradient(0., 0., -6.*eta - 9.*zeta/2. + 9.*(eta + 1.)*(zeta + 1.) - 27.*(zeta + 1.)*(eta + 1.)*(eta + 1.)/8. - 15./2. + 9.*((eta + 1.)*(eta + 1.))/4.);
                      case 32:
                        return RealGradient(0., 0., 9.*eta - 27.*(eta + 1.)*(zeta + 1.)/4. + 27.*(zeta + 1.)*((eta + 1.)*(eta + 1.))/8. + 9. - 9.*(eta + 1.)*(eta + 1.)/2.);
                      case 33:
                        return RealGradient(0., -9.*zeta + 27.*(eta + 1.)*(zeta + 1.)/4. - 27.*(eta + 1.)*(zeta + 1.)*(zeta + 1.)/8. - 9. + 9.*((zeta + 1.)*(zeta + 1.))/2., 0.);
                      case 34:
                        return RealGradient(0., 9.*zeta/2. - 27.*(eta + 1.)*(zeta + 1.)/4. + 27.*(eta + 1.)*((zeta + 1.)*(zeta + 1.))/8. + 9./2. - 9.*(zeta + 1.)*(zeta + 1.)/4., 0.);
                      case 35:
                        return RealGradient(0., 0., -9.*eta/2. + 27.*(eta + 1.)*(zeta + 1.)/4. - 27.*(zeta + 1.)*(eta + 1.)*(eta + 1.)/8. - 9./2. + 9.*((eta + 1.)*(eta + 1.))/4.);
                      case 36:
                        return RealGradient(0., 0., 6.*eta - 9.*(eta + 1.)*(zeta + 1.)/2. + 27.*(zeta + 1.)*((eta + 1.)*(eta + 1.))/8. + 6. - 9.*(eta + 1.)*(eta + 1.)/2.);
                      case 37:
                        return RealGradient(0., 0., 0.);
                      case 38:
                        return RealGradient(0., 0., 0.);
                      case 39:
                        return RealGradient(0., 0., -3.*eta + 9.*(eta + 1.)*(zeta + 1.)/2. - 27.*(zeta + 1.)*(eta + 1.)*(eta + 1.)/8. - 3. + 9.*((eta + 1.)*(eta + 1.))/4.);
                      case 40:
                        return RealGradient(0., 0., 9.*eta - 27.*(eta + 1.)*(zeta + 1.)/4. + 27.*(zeta + 1.)*((eta + 1.)*(eta + 1.))/8. + 9. - 9.*(eta + 1.)*(eta + 1.)/2.);
                      case 41:
                        return RealGradient(0., -9.*zeta + 27.*(eta + 1.)*(zeta + 1.)/4. - 27.*(eta + 1.)*(zeta + 1.)*(zeta + 1.)/8. - 9. + 9.*((zeta + 1.)*(zeta + 1.))/2., 0.);
                      case 42:
                        return RealGradient(0., 9.*zeta/2. - 27.*(eta + 1.)*(zeta + 1.)/4. + 27.*(eta + 1.)*((zeta + 1.)*(zeta + 1.))/8. + 9./2. - 9.*(zeta + 1.)*(zeta + 1.)/4., 0.);
                      case 43:
                        return RealGradient(0., 0., -9.*eta/2. + 27.*(eta + 1.)*(zeta + 1.)/4. - 27.*(zeta + 1.)*(eta + 1.)*(eta + 1.)/8. - 9./2. + 9.*((eta + 1.)*(eta + 1.))/4.);
                      case 44:
                        return RealGradient(0., 6.*zeta - 9.*(eta + 1.)*(zeta + 1.)/2. + 27.*(eta + 1.)*((zeta + 1.)*(zeta + 1.))/8. + 6. - 9.*(zeta + 1.)*(zeta + 1.)/2., 0.);
                      case 45:
                        return RealGradient(0., 0., 0.);
                      case 46:
                        return RealGradient(0., 0., 0.);
                      case 47:
                        return RealGradient(0., -3.*zeta + 9.*(eta + 1.)*(zeta + 1.)/2. - 27.*(eta + 1.)*(zeta + 1.)*(zeta + 1.)/8. - 3. + 9.*((zeta + 1.)*(zeta + 1.))/4., 0.);
                      case 48:
                        return RealGradient(0., 0., -18.*eta + 27.*(eta + 1.)*(zeta + 1.)/2. - 27.*(zeta + 1.)*(eta + 1.)*(eta + 1.)/4. - 18. + 9.*((eta + 1.)*(eta + 1.)));
                      case 49:
                        return RealGradient(0., 18.*zeta - 27.*(eta + 1.)*(zeta + 1.)/2. + 27.*(eta + 1.)*((zeta + 1.)*(zeta + 1.))/4. + 18. - 9.*(zeta + 1.)*(zeta + 1.), 0.);
                      case 50:
                        return RealGradient(0., 0., 0.);
                      case 51:
                        return RealGradient(0., 0., 0.);
                      case 52:
                        return RealGradient(0., -9.*zeta + 27.*(eta + 1.)*(zeta + 1.)/2. - 27.*(eta + 1.)*(zeta + 1.)*(zeta + 1.)/4. - 9. + 9.*((zeta + 1.)*(zeta + 1.))/2., 0.);
                      case 53:
                        return RealGradient(0., 0., 9.*eta - 27.*(eta + 1.)*(zeta + 1.)/2. + 27.*(zeta + 1.)*((eta + 1.)*(eta + 1.))/4. + 9. - 9.*(eta + 1.)*(eta + 1.)/2.);
                      default:
                        libmesh_error_msg("Invalid i = " << i);
                      }
                  } // j = 0

                  // d^2()/dxideta
                case 1:
                  {
                    switch(ii)
                      {
                      case 0:
                        return sign * RealGradient(-9.*eta/4. - 6.*zeta + 18.*(eta/2. + 1./2.)*(zeta/2. + 1./2.) - 27.*(eta/2. + 1./2.)*(zeta + 1.)*(zeta + 1.)/(2.*2.)/2. - 21./4. + 9.*((zeta + 1.)*(zeta + 1.)/(2.*2.)), 0., 0.);
                      case 1:
                        return sign * RealGradient(9.*eta/4. + 6.*zeta - 18.*(eta/2. + 1./2.)*(zeta/2. + 1./2.) + 27.*(eta/2. + 1./2.)*((zeta + 1.)*(zeta + 1.)/(2.*2.))/2. + 21./4. - 9.*(zeta + 1.)*(zeta + 1.)/(2.*2.), 0., 0.);
                      case 2:
                        return sign * RealGradient(0., -9.*xi/4. - 3.*zeta + 18.*(xi/2. + 1./2.)*(zeta/2. + 1./2.) - 27.*(xi/2. + 1./2.)*(zeta + 1.)*(zeta + 1.)/(2.*2.)/2. - 15./4. + 9.*((zeta + 1.)*(zeta + 1.)/(2.*2.))/2., 0.);
                      case 3:
                        return sign * RealGradient(0., 9.*xi/4. + 3.*zeta - 18.*(xi/2. + 1./2.)*(zeta/2. + 1./2.) + 27.*(xi/2. + 1./2.)*((zeta + 1.)*(zeta + 1.)/(2.*2.))/2. + 15./4. - 9.*(zeta + 1.)*(zeta + 1.)/(2.*2.)/2., 0.);
                      case 4:
                        return sign * RealGradient(-9.*eta/4. - 3.*zeta + 18.*(eta/2. + 1./2.)*(zeta/2. + 1./2.) - 27.*(eta/2. + 1./2.)*(zeta + 1.)*(zeta + 1.)/(2.*2.)/2. - 15./4. + 9.*((zeta + 1.)*(zeta + 1.)/(2.*2.))/2., 0., 0.);
                      case 5:
                        return sign * RealGradient(9.*eta/4. + 3.*zeta - 18.*(eta/2. + 1./2.)*(zeta/2. + 1./2.) + 27.*(eta/2. + 1./2.)*((zeta + 1.)*(zeta + 1.)/(2.*2.))/2. + 15./4. - 9.*(zeta + 1.)*(zeta + 1.)/(2.*2.)/2., 0., 0.);
                      case 6:
                        return sign * RealGradient(0., -9.*xi/4. - 6.*zeta + 18.*(xi/2. + 1./2.)*(zeta/2. + 1./2.) - 27.*(xi/2. + 1./2.)*(zeta + 1.)*(zeta + 1.)/(2.*2.)/2. - 21./4. + 9.*((zeta + 1.)*(zeta + 1.)/(2.*2.)), 0.);
                      case 7:
                        return sign * RealGradient(0., 9.*xi/4. + 6.*zeta - 18.*(xi/2. + 1./2.)*(zeta/2. + 1./2.) + 27.*(xi/2. + 1./2.)*((zeta + 1.)*(zeta + 1.)/(2.*2.))/2. + 21./4. - 9.*(zeta + 1.)*(zeta + 1.)/(2.*2.), 0.);
                      case 8:
                        return sign * RealGradient(0., 0., -6.*eta - 6.*xi - 6.*zeta - 27.*(eta/2. + 1./2.)*(xi/2. + 1./2.)*(zeta/2. + 1./2.) + 18.*(eta/2. + 1./2.)*(xi/2. + 1./2.) + 18.*(eta/2. + 1./2.)*(zeta/2. + 1./2.) + 18.*(xi/2. + 1./2.)*(zeta/2. + 1./2.) - 10.);
                      case 9:
                        return sign * RealGradient(0., 0., 3.*eta + 3.*xi + 6.*zeta + 27.*(eta/2. + 1./2.)*(xi/2. + 1./2.)*(zeta/2. + 1./2.) - 9.*(eta/2. + 1./2.)*(xi/2. + 1./2.) - 18.*(eta/2. + 1./2.)*(zeta/2. + 1./2.) - 18.*(xi/2. + 1./2.)*(zeta/2. + 1./2.) + 8.);
                      case 10:
                        return sign * RealGradient(0., 0., -3.*eta - 6.*xi - 3.*zeta - 27.*(eta/2. + 1./2.)*(xi/2. + 1./2.)*(zeta/2. + 1./2.) + 18.*(eta/2. + 1./2.)*(xi/2. + 1./2.) + 9.*(eta/2. + 1./2.)*(zeta/2. + 1./2.) + 18.*(xi/2. + 1./2.)*(zeta/2. + 1./2.) - 8.);
                      case 11:
                        return sign * RealGradient(0., 0., 3.*eta/2. + 3.*xi + 3.*zeta + 27.*(eta/2. + 1./2.)*(xi/2. + 1./2.)*(zeta/2. + 1./2.) - 9.*(eta/2. + 1./2.)*(xi/2. + 1./2.) - 9.*(eta/2. + 1./2.)*(zeta/2. + 1./2.) - 18.*(xi/2. + 1./2.)*(zeta/2. + 1./2.) + 11./2.);
                      case 12:
                        return sign * RealGradient(0., 0., -3.*eta - 3.*xi - 3.*zeta/2. - 27.*(eta/2. + 1./2.)*(xi/2. + 1./2.)*(zeta/2. + 1./2.) + 18.*(eta/2. + 1./2.)*(xi/2. + 1./2.) + 9.*(eta/2. + 1./2.)*(zeta/2. + 1./2.) + 9.*(xi/2. + 1./2.)*(zeta/2. + 1./2.) - 11./2.);
                      case 13:
                        return sign * RealGradient(0., 0., 3.*eta/2. + 3.*xi/2. + 3.*zeta/2. + 27.*(eta/2. + 1./2.)*(xi/2. + 1./2.)*(zeta/2. + 1./2.) - 9.*(eta/2. + 1./2.)*(xi/2. + 1./2.) - 9.*(eta/2. + 1./2.)*(zeta/2. + 1./2.) - 9.*(xi/2. + 1./2.)*(zeta/2. + 1./2.) + 7./2.);
                      case 14:
                        return sign * RealGradient(0., 0., -6.*eta - 3.*xi - 3.*zeta - 27.*(eta/2. + 1./2.)*(xi/2. + 1./2.)*(zeta/2. + 1./2.) + 18.*(eta/2. + 1./2.)*(xi/2. + 1./2.) + 18.*(eta/2. + 1./2.)*(zeta/2. + 1./2.) + 9.*(xi/2. + 1./2.)*(zeta/2. + 1./2.) - 8.);
                      case 15:
                        return sign * RealGradient(0., 0., 3.*eta + 3.*xi/2. + 3.*zeta + 27.*(eta/2. + 1./2.)*(xi/2. + 1./2.)*(zeta/2. + 1./2.) - 9.*(eta/2. + 1./2.)*(xi/2. + 1./2.) - 18.*(eta/2. + 1./2.)*(zeta/2. + 1./2.) - 9.*(xi/2. + 1./2.)*(zeta/2. + 1./2.) + 11./2.);
                      case 16:
                        return sign * RealGradient(-3.*zeta + 9.*(eta/2. + 1./2.)*(zeta/2. + 1./2.) - 27.*(eta/2. + 1./2.)*(zeta + 1.)*(zeta + 1.)/(2.*2.)/2. - 3. + 9.*((zeta + 1.)*(zeta + 1.)/(2.*2.)), 0., 0.);
                      case 17:
                        return sign * RealGradient(3.*zeta - 9.*(eta/2. + 1./2.)*(zeta/2. + 1./2.) + 27.*(eta/2. + 1./2.)*((zeta + 1.)*(zeta + 1.)/(2.*2.))/2. + 3. - 9.*(zeta + 1.)*(zeta + 1.)/(2.*2.), 0., 0.);
                      case 18:
                        return sign * RealGradient(0., -3.*zeta/2. + 9.*(xi/2. + 1./2.)*(zeta/2. + 1./2.) - 27.*(xi/2. + 1./2.)*(zeta + 1.)*(zeta + 1.)/(2.*2.)/2. - 3./2. + 9.*((zeta + 1.)*(zeta + 1.)/(2.*2.))/2., 0.);
                      case 19:
                        return sign * RealGradient(0., 3.*zeta/2. - 9.*(xi/2. + 1./2.)*(zeta/2. + 1./2.) + 27.*(xi/2. + 1./2.)*((zeta + 1.)*(zeta + 1.)/(2.*2.))/2. + 3./2. - 9.*(zeta + 1.)*(zeta + 1.)/(2.*2.)/2., 0.);
                      case 20:
                        return sign * RealGradient(-3.*zeta/2. + 9.*(eta/2. + 1./2.)*(zeta/2. + 1./2.) - 27.*(eta/2. + 1./2.)*(zeta + 1.)*(zeta + 1.)/(2.*2.)/2. - 3./2. + 9.*((zeta + 1.)*(zeta + 1.)/(2.*2.))/2., 0., 0.);
                      case 21:
                        return sign * RealGradient(3.*zeta/2. - 9.*(eta/2. + 1./2.)*(zeta/2. + 1./2.) + 27.*(eta/2. + 1./2.)*((zeta + 1.)*(zeta + 1.)/(2.*2.))/2. + 3./2. - 9.*(zeta + 1.)*(zeta + 1.)/(2.*2.)/2., 0., 0.);
                      case 22:
                        return sign * RealGradient(0., -3.*zeta + 9.*(xi/2. + 1./2.)*(zeta/2. + 1./2.) - 27.*(xi/2. + 1./2.)*(zeta + 1.)*(zeta + 1.)/(2.*2.)/2. - 3. + 9.*((zeta + 1.)*(zeta + 1.)/(2.*2.)), 0.);
                      case 23:
                        return sign * RealGradient(0., 3.*zeta - 9.*(xi/2. + 1./2.)*(zeta/2. + 1./2.) + 27.*(xi/2. + 1./2.)*((zeta + 1.)*(zeta + 1.)/(2.*2.))/2. + 3. - 9.*(zeta + 1.)*(zeta + 1.)/(2.*2.), 0.);
                      case 24:
                        return RealGradient(0., 9.*xi/2. + 9.*zeta - 36.*(xi/2. + 1./2.)*(zeta/2. + 1./2.) + 27.*(xi/2. + 1./2.)*((zeta + 1.)*(zeta + 1.)/(2.*2.)) + 9. - 27.*(zeta + 1.)*(zeta + 1.)/(2.*2.)/2., 0.);
                      case 25:
                        return RealGradient(-9.*eta/2. - 9.*zeta + 36.*(eta/2. + 1./2.)*(zeta/2. + 1./2.) - 27.*(eta/2. + 1./2.)*(zeta + 1.)*(zeta + 1.)/(2.*2.) - 9. + 27.*((zeta + 1.)*(zeta + 1.)/(2.*2.))/2., 0., 0.);
                      case 26:
                        return RealGradient(9.*eta/2. + 9.*zeta - 36.*(eta/2. + 1./2.)*(zeta/2. + 1./2.) + 27.*(eta/2. + 1./2.)*((zeta + 1.)*(zeta + 1.)/(2.*2.)) + 9. - 27.*(zeta + 1.)*(zeta + 1.)/(2.*2.)/2., 0., 0.);
                      case 27:
                        return RealGradient(0., -9.*xi/2. - 9.*zeta + 36.*(xi/2. + 1./2.)*(zeta/2. + 1./2.) - 27.*(xi/2. + 1./2.)*(zeta + 1.)*(zeta + 1.)/(2.*2.) - 9. + 27.*((zeta + 1.)*(zeta + 1.)/(2.*2.))/2., 0.);
                      case 28:
                        return RealGradient(0., 0., 9.*eta + 12.*xi + 9.*zeta + 54.*(eta/2. + 1./2.)*(xi/2. + 1./2.)*(zeta/2. + 1./2.) - 36.*(eta/2. + 1./2.)*(xi/2. + 1./2.) - 27.*(eta/2. + 1./2.)*(zeta/2. + 1./2.) - 36.*(xi/2. + 1./2.)*(zeta/2. + 1./2.) + 18.);
                      case 29:
                        return RealGradient(-9.*zeta + 27.*(eta/2. + 1./2.)*(zeta/2. + 1./2.) - 27.*(eta/2. + 1./2.)*(zeta + 1.)*(zeta + 1.)/(2.*2.) - 9. + 18.*((zeta + 1.)*(zeta + 1.)/(2.*2.)), 0., 0.);
                      case 30:
                        return RealGradient(9.*zeta - 27.*(eta/2. + 1./2.)*(zeta/2. + 1./2.) + 27.*(eta/2. + 1./2.)*((zeta + 1.)*(zeta + 1.)/(2.*2.)) + 9. - 18.*(zeta + 1.)*(zeta + 1.)/(2.*2.), 0., 0.);
                      case 31:
                        return RealGradient(0., 0., -9.*eta/2. - 6.*xi - 9.*zeta - 54.*(eta/2. + 1./2.)*(xi/2. + 1./2.)*(zeta/2. + 1./2.) + 18.*(eta/2. + 1./2.)*(xi/2. + 1./2.) + 27.*(eta/2. + 1./2.)*(zeta/2. + 1./2.) + 36.*(xi/2. + 1./2.)*(zeta/2. + 1./2.) - 27./2.);
                      case 32:
                        return RealGradient(0., 0., 6.*eta + 9.*xi + 9.*zeta/2. + 54.*(eta/2. + 1./2.)*(xi/2. + 1./2.)*(zeta/2. + 1./2.) - 36.*(eta/2. + 1./2.)*(xi/2. + 1./2.) - 18.*(eta/2. + 1./2.)*(zeta/2. + 1./2.) - 27.*(xi/2. + 1./2.)*(zeta/2. + 1./2.) + 27./2.);
                      case 33:
                        return RealGradient(0., -9.*zeta/2. + 27.*(xi/2. + 1./2.)*(zeta/2. + 1./2.) - 27.*(xi/2. + 1./2.)*(zeta + 1.)*(zeta + 1.)/(2.*2.) - 9./2. + 9.*((zeta + 1.)*(zeta + 1.)/(2.*2.)), 0.);
                      case 34:
                        return RealGradient(0., 9.*zeta/2. - 27.*(xi/2. + 1./2.)*(zeta/2. + 1./2.) + 27.*(xi/2. + 1./2.)*((zeta + 1.)*(zeta + 1.)/(2.*2.)) + 9./2. - 9.*(zeta + 1.)*(zeta + 1.)/(2.*2.), 0.);
                      case 35:
                        return RealGradient(0., 0., -3.*eta - 9.*xi/2. - 9.*zeta/2. - 54.*(eta/2. + 1./2.)*(xi/2. + 1./2.)*(zeta/2. + 1./2.) + 18.*(eta/2. + 1./2.)*(xi/2. + 1./2.) + 18.*(eta/2. + 1./2.)*(zeta/2. + 1./2.) + 27.*(xi/2. + 1./2.)*(zeta/2. + 1./2.) - 9.);
                      case 36:
                        return RealGradient(0., 0., 9.*eta + 6.*xi + 9.*zeta/2. + 54.*(eta/2. + 1./2.)*(xi/2. + 1./2.)*(zeta/2. + 1./2.) - 36.*(eta/2. + 1./2.)*(xi/2. + 1./2.) - 27.*(eta/2. + 1./2.)*(zeta/2. + 1./2.) - 18.*(xi/2. + 1./2.)*(zeta/2. + 1./2.) + 27./2.);
                      case 37:
                        return RealGradient(-9.*zeta/2. + 27.*(eta/2. + 1./2.)*(zeta/2. + 1./2.) - 27.*(eta/2. + 1./2.)*(zeta + 1.)*(zeta + 1.)/(2.*2.) - 9./2. + 9.*((zeta + 1.)*(zeta + 1.)/(2.*2.)), 0., 0.);
                      case 38:
                        return RealGradient(9.*zeta/2. - 27.*(eta/2. + 1./2.)*(zeta/2. + 1./2.) + 27.*(eta/2. + 1./2.)*((zeta + 1.)*(zeta + 1.)/(2.*2.)) + 9./2. - 9.*(zeta + 1.)*(zeta + 1.)/(2.*2.), 0., 0.);
                      case 39:
                        return RealGradient(0., 0., -9.*eta/2. - 3.*xi - 9.*zeta/2. - 54.*(eta/2. + 1./2.)*(xi/2. + 1./2.)*(zeta/2. + 1./2.) + 18.*(eta/2. + 1./2.)*(xi/2. + 1./2.) + 27.*(eta/2. + 1./2.)*(zeta/2. + 1./2.) + 18.*(xi/2. + 1./2.)*(zeta/2. + 1./2.) - 9.);
                      case 40:
                        return RealGradient(0., 0., 12.*eta + 9.*xi + 9.*zeta + 54.*(eta/2. + 1./2.)*(xi/2. + 1./2.)*(zeta/2. + 1./2.) - 36.*(eta/2. + 1./2.)*(xi/2. + 1./2.) - 36.*(eta/2. + 1./2.)*(zeta/2. + 1./2.) - 27.*(xi/2. + 1./2.)*(zeta/2. + 1./2.) + 18.);
                      case 41:
                        return RealGradient(0., -9.*zeta + 27.*(xi/2. + 1./2.)*(zeta/2. + 1./2.) - 27.*(xi/2. + 1./2.)*(zeta + 1.)*(zeta + 1.)/(2.*2.) - 9. + 18.*((zeta + 1.)*(zeta + 1.)/(2.*2.)), 0.);
                      case 42:
                        return RealGradient(0., 9.*zeta - 27.*(xi/2. + 1./2.)*(zeta/2. + 1./2.) + 27.*(xi/2. + 1./2.)*((zeta + 1.)*(zeta + 1.)/(2.*2.)) + 9. - 18.*(zeta + 1.)*(zeta + 1.)/(2.*2.), 0.);
                      case 43:
                        return RealGradient(0., 0., -6.*eta - 9.*xi/2. - 9.*zeta - 54.*(eta/2. + 1./2.)*(xi/2. + 1./2.)*(zeta/2. + 1./2.) + 18.*(eta/2. + 1./2.)*(xi/2. + 1./2.) + 36.*(eta/2. + 1./2.)*(zeta/2. + 1./2.) + 27.*(xi/2. + 1./2.)*(zeta/2. + 1./2.) - 27./2.);
                      case 44:
                        return RealGradient(0., 9.*zeta/2. - 18.*(xi/2. + 1./2.)*(zeta/2. + 1./2.) + 27.*(xi/2. + 1./2.)*((zeta + 1.)*(zeta + 1.)/(2.*2.)) + 9./2. - 27.*(zeta + 1.)*(zeta + 1.)/(2.*2.)/2., 0.);
                      case 45:
                        return RealGradient(-9.*zeta/2. + 18.*(eta/2. + 1./2.)*(zeta/2. + 1./2.) - 27.*(eta/2. + 1./2.)*(zeta + 1.)*(zeta + 1.)/(2.*2.) - 9./2. + 27.*((zeta + 1.)*(zeta + 1.)/(2.*2.))/2., 0., 0.);
                      case 46:
                        return RealGradient(9.*zeta/2. - 18.*(eta/2. + 1./2.)*(zeta/2. + 1./2.) + 27.*(eta/2. + 1./2.)*((zeta + 1.)*(zeta + 1.)/(2.*2.)) + 9./2. - 27.*(zeta + 1.)*(zeta + 1.)/(2.*2.)/2., 0., 0.);
                      case 47:
                        return RealGradient(0., -9.*zeta/2. + 18.*(xi/2. + 1./2.)*(zeta/2. + 1./2.) - 27.*(xi/2. + 1./2.)*(zeta + 1.)*(zeta + 1.)/(2.*2.) - 9./2. + 27.*((zeta + 1.)*(zeta + 1.)/(2.*2.))/2., 0.);
                      case 48:
                        return RealGradient(0., 0., -18.*eta - 18.*xi - 27.*zeta/2. - 108.*(eta/2. + 1./2.)*(xi/2. + 1./2.)*(zeta/2. + 1./2.) + 72.*(eta/2. + 1./2.)*(xi/2. + 1./2.) + 54.*(eta/2. + 1./2.)*(zeta/2. + 1./2.) + 54.*(xi/2. + 1./2.)*(zeta/2. + 1./2.) - 63./2.);
                      case 49:
                        return RealGradient(0., 27.*zeta/2. - 54.*(xi/2. + 1./2.)*(zeta/2. + 1./2.) + 54.*(xi/2. + 1./2.)*((zeta + 1.)*(zeta + 1.)/(2.*2.)) + 27./2. - 27.*(zeta + 1.)*(zeta + 1.)/(2.*2.), 0.);
                      case 50:
                        return RealGradient(-27.*zeta/2. + 54.*(eta/2. + 1./2.)*(zeta/2. + 1./2.) - 54.*(eta/2. + 1./2.)*(zeta + 1.)*(zeta + 1.)/(2.*2.) - 27./2. + 27.*((zeta + 1.)*(zeta + 1.)/(2.*2.)), 0., 0.);
                      case 51:
                        return RealGradient(27.*zeta/2. - 54.*(eta/2. + 1./2.)*(zeta/2. + 1./2.) + 54.*(eta/2. + 1./2.)*((zeta + 1.)*(zeta + 1.)/(2.*2.)) + 27./2. - 27.*(zeta + 1.)*(zeta + 1.)/(2.*2.), 0., 0.);
                      case 52:
                        return RealGradient(0., -27.*zeta/2. + 54.*(xi/2. + 1./2.)*(zeta/2. + 1./2.) - 54.*(xi/2. + 1./2.)*(zeta + 1.)*(zeta + 1.)/(2.*2.) - 27./2. + 27.*((zeta + 1.)*(zeta + 1.)/(2.*2.)), 0.);
                      case 53:
                        return RealGradient(0., 0., 9.*eta + 9.*xi + 27.*zeta/2. + 108.*(eta/2. + 1./2.)*(xi/2. + 1./2.)*(zeta/2. + 1./2.) - 36.*(eta/2. + 1./2.)*(xi/2. + 1./2.) - 54.*(eta/2. + 1./2.)*(zeta/2. + 1./2.) - 54.*(xi/2. + 1./2.)*(zeta/2. + 1./2.) + 45./2.);
                      default:
                        libmesh_error_msg("Invalid i = " << i);
                      }
                  } // j = 1

                  // d^2()/deta^2
                case 2:
                  {
                    switch(ii)
                      {
                      case 0:
                        return sign * RealGradient(-9.*xi/4. - 6.*zeta + 9.*(xi + 1.)*(zeta + 1.)/2. - 27.*(xi + 1.)*(zeta + 1.)*(zeta + 1.)/16. - 21./4. + 9.*((zeta + 1.)*(zeta + 1.))/4., 0., 0.);
                      case 1:
                        return sign * RealGradient(9.*xi/4. + 3.*zeta - 9.*(xi + 1.)*(zeta + 1.)/2. + 27.*(xi + 1.)*((zeta + 1.)*(zeta + 1.))/16. + 15./4. - 9.*(zeta + 1.)*(zeta + 1.)/8., 0., 0.);
                      case 2:
                        return sign * RealGradient(0., 0., 0.);
                      case 3:
                        return sign * RealGradient(0., 0., 0.);
                      case 4:
                        return sign * RealGradient(-9.*xi/4. - 3.*zeta + 9.*(xi + 1.)*(zeta + 1.)/2. - 27.*(xi + 1.)*(zeta + 1.)*(zeta + 1.)/16. - 15./4. + 9.*((zeta + 1.)*(zeta + 1.))/8., 0., 0.);
                      case 5:
                        return sign * RealGradient(9.*xi/4. + 6.*zeta - 9.*(xi + 1.)*(zeta + 1.)/2. + 27.*(xi + 1.)*((zeta + 1.)*(zeta + 1.))/16. + 21./4. - 9.*(zeta + 1.)*(zeta + 1.)/4., 0., 0.);
                      case 6:
                        return sign * RealGradient(0., 0., 0.);
                      case 7:
                        return sign * RealGradient(0., 0., 0.);
                      case 8:
                        return sign * RealGradient(0., 0., -6.*xi - 9.*zeta/4. + 9.*(xi + 1.)*(zeta + 1.)/2. - 27.*(zeta + 1.)*(xi + 1.)*(xi + 1.)/16. - 21./4. + 9.*((xi + 1.)*(xi + 1.))/4.);
                      case 9:
                        return sign * RealGradient(0., 0., 3.*xi + 9.*zeta/4. - 9.*(xi + 1.)*(zeta + 1.)/2. + 27.*(zeta + 1.)*((xi + 1.)*(xi + 1.))/16. + 15./4. - 9.*(xi + 1.)*(xi + 1.)/8.);
                      case 10:
                        return sign * RealGradient(0., 0., -3.*xi + 9.*(xi + 1.)*(zeta + 1.)/4. - 27.*(zeta + 1.)*(xi + 1.)*(xi + 1.)/16. - 3. + 9.*((xi + 1.)*(xi + 1.))/4.);
                      case 11:
                        return sign * RealGradient(0., 0., 3.*xi/2. - 9.*(xi + 1.)*(zeta + 1.)/4. + 27.*(zeta + 1.)*((xi + 1.)*(xi + 1.))/16. + 3./2. - 9.*(xi + 1.)*(xi + 1.)/8.);
                      case 12:
                        return sign * RealGradient(0., 0., -3.*xi + 9.*(xi + 1.)*(zeta + 1.)/4. - 27.*(zeta + 1.)*(xi + 1.)*(xi + 1.)/16. - 3. + 9.*((xi + 1.)*(xi + 1.))/4.);
                      case 13:
                        return sign * RealGradient(0., 0., 3.*xi/2. - 9.*(xi + 1.)*(zeta + 1.)/4. + 27.*(zeta + 1.)*((xi + 1.)*(xi + 1.))/16. + 3./2. - 9.*(xi + 1.)*(xi + 1.)/8.);
                      case 14:
                        return sign * RealGradient(0., 0., -6.*xi - 9.*zeta/4. + 9.*(xi + 1.)*(zeta + 1.)/2. - 27.*(zeta + 1.)*(xi + 1.)*(xi + 1.)/16. - 21./4. + 9.*((xi + 1.)*(xi + 1.))/4.);
                      case 15:
                        return sign * RealGradient(0., 0., 3.*xi + 9.*zeta/4. - 9.*(xi + 1.)*(zeta + 1.)/2. + 27.*(zeta + 1.)*((xi + 1.)*(xi + 1.))/16. + 15./4. - 9.*(xi + 1.)*(xi + 1.)/8.);
                      case 16:
                        return sign * RealGradient(-3.*zeta + 9.*(xi + 1.)*(zeta + 1.)/4. - 27.*(xi + 1.)*(zeta + 1.)*(zeta + 1.)/16. - 3. + 9.*((zeta + 1.)*(zeta + 1.))/4., 0., 0.);
                      case 17:
                        return sign * RealGradient(3.*zeta/2. - 9.*(xi + 1.)*(zeta + 1.)/4. + 27.*(xi + 1.)*((zeta + 1.)*(zeta + 1.))/16. + 3./2. - 9.*(zeta + 1.)*(zeta + 1.)/8., 0., 0.);
                      case 18:
                        return sign * RealGradient(0., 0., 0.);
                      case 19:
                        return sign * RealGradient(0., 0., 0.);
                      case 20:
                        return sign * RealGradient(-3.*zeta/2. + 9.*(xi + 1.)*(zeta + 1.)/4. - 27.*(xi + 1.)*(zeta + 1.)*(zeta + 1.)/16. - 3./2. + 9.*((zeta + 1.)*(zeta + 1.))/8., 0., 0.);
                      case 21:
                        return sign * RealGradient(3.*zeta - 9.*(xi + 1.)*(zeta + 1.)/4. + 27.*(xi + 1.)*((zeta + 1.)*(zeta + 1.))/16. + 3. - 9.*(zeta + 1.)*(zeta + 1.)/4., 0., 0.);
                      case 22:
                        return sign * RealGradient(0., 0., 0.);
                      case 23:
                        return sign * RealGradient(0., 0., 0.);
                      case 24:
                        return RealGradient(0., 0., 0.);
                      case 25:
                        return RealGradient(-9.*xi/2. - 12.*zeta + 9.*(xi + 1.)*(zeta + 1.) - 27.*(xi + 1.)*(zeta + 1.)*(zeta + 1.)/8. - 21./2. + 9.*((zeta + 1.)*(zeta + 1.))/2., 0., 0.);
                      case 26:
                        return RealGradient(9.*xi/2. + 6.*zeta - 9.*(xi + 1.)*(zeta + 1.) + 27.*(xi + 1.)*((zeta + 1.)*(zeta + 1.))/8. + 15./2. - 9.*(zeta + 1.)*(zeta + 1.)/4., 0., 0.);
                      case 27:
                        return RealGradient(0., 0., 0.);
                      case 28:
                        return RealGradient(0., 0., 9.*xi - 27.*(xi + 1.)*(zeta + 1.)/4. + 27.*(zeta + 1.)*((xi + 1.)*(xi + 1.))/8. + 9. - 9.*(xi + 1.)*(xi + 1.)/2.);
                      case 29:
                        return RealGradient(-9.*zeta + 27.*(xi + 1.)*(zeta + 1.)/4. - 27.*(xi + 1.)*(zeta + 1.)*(zeta + 1.)/8. - 9. + 9.*((zeta + 1.)*(zeta + 1.))/2., 0., 0.);
                      case 30:
                        return RealGradient(9.*zeta/2. - 27.*(xi + 1.)*(zeta + 1.)/4. + 27.*(xi + 1.)*((zeta + 1.)*(zeta + 1.))/8. + 9./2. - 9.*(zeta + 1.)*(zeta + 1.)/4., 0., 0.);
                      case 31:
                        return RealGradient(0., 0., -9.*xi/2. + 27.*(xi + 1.)*(zeta + 1.)/4. - 27.*(zeta + 1.)*(xi + 1.)*(xi + 1.)/8. - 9./2. + 9.*((xi + 1.)*(xi + 1.))/4.);
                      case 32:
                        return RealGradient(0., 0., 6.*xi - 9.*(xi + 1.)*(zeta + 1.)/2. + 27.*(zeta + 1.)*((xi + 1.)*(xi + 1.))/8. + 6. - 9.*(xi + 1.)*(xi + 1.)/2.);
                      case 33:
                        return RealGradient(0., 0., 0.);
                      case 34:
                        return RealGradient(0., 0., 0.);
                      case 35:
                        return RealGradient(0., 0., -3.*xi + 9.*(xi + 1.)*(zeta + 1.)/2. - 27.*(zeta + 1.)*(xi + 1.)*(xi + 1.)/8. - 3. + 9.*((xi + 1.)*(xi + 1.))/4.);
                      case 36:
                        return RealGradient(0., 0., 9.*xi - 27.*(xi + 1.)*(zeta + 1.)/4. + 27.*(zeta + 1.)*((xi + 1.)*(xi + 1.))/8. + 9. - 9.*(xi + 1.)*(xi + 1.)/2.);
                      case 37:
                        return RealGradient(-9.*zeta + 27.*(xi + 1.)*(zeta + 1.)/4. - 27.*(xi + 1.)*(zeta + 1.)*(zeta + 1.)/8. - 9. + 9.*((zeta + 1.)*(zeta + 1.))/2., 0., 0.);
                      case 38:
                        return RealGradient(9.*zeta/2. - 27.*(xi + 1.)*(zeta + 1.)/4. + 27.*(xi + 1.)*((zeta + 1.)*(zeta + 1.))/8. + 9./2. - 9.*(zeta + 1.)*(zeta + 1.)/4., 0., 0.);
                      case 39:
                        return RealGradient(0., 0., -9.*xi/2. + 27.*(xi + 1.)*(zeta + 1.)/4. - 27.*(zeta + 1.)*(xi + 1.)*(xi + 1.)/8. - 9./2. + 9.*((xi + 1.)*(xi + 1.))/4.);
                      case 40:
                        return RealGradient(0., 0., 12.*xi + 9.*zeta/2. - 9.*(xi + 1.)*(zeta + 1.) + 27.*(zeta + 1.)*((xi + 1.)*(xi + 1.))/8. + 21./2. - 9.*(xi + 1.)*(xi + 1.)/2.);
                      case 41:
                        return RealGradient(0., 0., 0.);
                      case 42:
                        return RealGradient(0., 0., 0.);
                      case 43:
                        return RealGradient(0., 0., -6.*xi - 9.*zeta/2. + 9.*(xi + 1.)*(zeta + 1.) - 27.*(zeta + 1.)*(xi + 1.)*(xi + 1.)/8. - 15./2. + 9.*((xi + 1.)*(xi + 1.))/4.);
                      case 44:
                        return RealGradient(0., 0., 0.);
                      case 45:
                        return RealGradient(-6.*zeta + 9.*(xi + 1.)*(zeta + 1.)/2. - 27.*(xi + 1.)*(zeta + 1.)*(zeta + 1.)/8. - 6. + 9.*((zeta + 1.)*(zeta + 1.))/2., 0., 0.);
                      case 46:
                        return RealGradient(3.*zeta - 9.*(xi + 1.)*(zeta + 1.)/2. + 27.*(xi + 1.)*((zeta + 1.)*(zeta + 1.))/8. + 3. - 9.*(zeta + 1.)*(zeta + 1.)/4., 0., 0.);
                      case 47:
                        return RealGradient(0., 0., 0.);
                      case 48:
                        return RealGradient(0., 0., -18.*xi + 27.*(xi + 1.)*(zeta + 1.)/2. - 27.*(zeta + 1.)*(xi + 1.)*(xi + 1.)/4. - 18. + 9.*((xi + 1.)*(xi + 1.)));
                      case 49:
                        return RealGradient(0., 0., 0.);
                      case 50:
                        return RealGradient(-18.*zeta + 27.*(xi + 1.)*(zeta + 1.)/2. - 27.*(xi + 1.)*(zeta + 1.)*(zeta + 1.)/4. - 18. + 9.*((zeta + 1.)*(zeta + 1.)), 0., 0.);
                      case 51:
                        return RealGradient(9.*zeta - 27.*(xi + 1.)*(zeta + 1.)/2. + 27.*(xi + 1.)*((zeta + 1.)*(zeta + 1.))/4. + 9. - 9.*(zeta + 1.)*(zeta + 1.)/2., 0., 0.);
                      case 52:
                        return RealGradient(0., 0., 0.);
                      case 53:
                        return RealGradient(0., 0., 9.*xi - 27.*(xi + 1.)*(zeta + 1.)/2. + 27.*(zeta + 1.)*((xi + 1.)*(xi + 1.))/4. + 9. - 9.*(xi + 1.)*(xi + 1.)/2.);
                      default:
                        libmesh_error_msg("Invalid i = " << i);
                      }
                  } // j = 2

                  // d^2()/dxidzeta
                case 3:
                  {
                    switch(ii)
                      {
                      case 0:
                        return sign * RealGradient(-6.*eta - 9.*zeta/4. + 18.*(eta/2. + 1./2.)*(zeta/2. + 1./2.) - 27.*(zeta/2. + 1./2.)*(eta + 1.)*(eta + 1.)/(2.*2.)/2. - 21./4. + 9.*((eta + 1.)*(eta + 1.)/(2.*2.)), 0., 0.);
                      case 1:
                        return sign * RealGradient(6.*eta + 9.*zeta/4. - 18.*(eta/2. + 1./2.)*(zeta/2. + 1./2.) + 27.*(zeta/2. + 1./2.)*((eta + 1.)*(eta + 1.)/(2.*2.))/2. + 21./4. - 9.*(eta + 1.)*(eta + 1.)/(2.*2.), 0., 0.);
                      case 2:
                        return sign * RealGradient(0., -3.*eta - 6.*xi - 3.*zeta - 27.*(eta/2. + 1./2.)*(xi/2. + 1./2.)*(zeta/2. + 1./2.) + 18.*(eta/2. + 1./2.)*(xi/2. + 1./2.) + 9.*(eta/2. + 1./2.)*(zeta/2. + 1./2.) + 18.*(xi/2. + 1./2.)*(zeta/2. + 1./2.) - 8., 0.);
                      case 3:
                        return sign * RealGradient(0., 3.*eta + 3.*xi + 3.*zeta/2. + 27.*(eta/2. + 1./2.)*(xi/2. + 1./2.)*(zeta/2. + 1./2.) - 18.*(eta/2. + 1./2.)*(xi/2. + 1./2.) - 9.*(eta/2. + 1./2.)*(zeta/2. + 1./2.) - 9.*(xi/2. + 1./2.)*(zeta/2. + 1./2.) + 11./2., 0.);
                      case 4:
                        return sign * RealGradient(-3.*eta + 9.*(eta/2. + 1./2.)*(zeta/2. + 1./2.) - 27.*(zeta/2. + 1./2.)*(eta + 1.)*(eta + 1.)/(2.*2.)/2. - 3. + 9.*((eta + 1.)*(eta + 1.)/(2.*2.)), 0., 0.);
                      case 5:
                        return sign * RealGradient(3.*eta - 9.*(eta/2. + 1./2.)*(zeta/2. + 1./2.) + 27.*(zeta/2. + 1./2.)*((eta + 1.)*(eta + 1.)/(2.*2.))/2. + 3. - 9.*(eta + 1.)*(eta + 1.)/(2.*2.), 0., 0.);
                      case 6:
                        return sign * RealGradient(0., -6.*eta - 6.*xi - 6.*zeta - 27.*(eta/2. + 1./2.)*(xi/2. + 1./2.)*(zeta/2. + 1./2.) + 18.*(eta/2. + 1./2.)*(xi/2. + 1./2.) + 18.*(eta/2. + 1./2.)*(zeta/2. + 1./2.) + 18.*(xi/2. + 1./2.)*(zeta/2. + 1./2.) - 10., 0.);
                      case 7:
                        return sign * RealGradient(0., 6.*eta + 3.*xi + 3.*zeta + 27.*(eta/2. + 1./2.)*(xi/2. + 1./2.)*(zeta/2. + 1./2.) - 18.*(eta/2. + 1./2.)*(xi/2. + 1./2.) - 18.*(eta/2. + 1./2.)*(zeta/2. + 1./2.) - 9.*(xi/2. + 1./2.)*(zeta/2. + 1./2.) + 8., 0.);
                      case 8:
                        return sign * RealGradient(0., 0., -6.*eta - 9.*xi/4. + 18.*(eta/2. + 1./2.)*(xi/2. + 1./2.) - 27.*(xi/2. + 1./2.)*(eta + 1.)*(eta + 1.)/(2.*2.)/2. - 21./4. + 9.*((eta + 1.)*(eta + 1.)/(2.*2.)));
                      case 9:
                        return sign * RealGradient(0., 0., 6.*eta + 9.*xi/4. - 18.*(eta/2. + 1./2.)*(xi/2. + 1./2.) + 27.*(xi/2. + 1./2.)*((eta + 1.)*(eta + 1.)/(2.*2.))/2. + 21./4. - 9.*(eta + 1.)*(eta + 1.)/(2.*2.));
                      case 10:
                        return sign * RealGradient(0., 0., -3.*eta - 9.*xi/4. + 18.*(eta/2. + 1./2.)*(xi/2. + 1./2.) - 27.*(xi/2. + 1./2.)*(eta + 1.)*(eta + 1.)/(2.*2.)/2. - 15./4. + 9.*((eta + 1.)*(eta + 1.)/(2.*2.))/2.);
                      case 11:
                        return sign * RealGradient(0., 0., 3.*eta + 9.*xi/4. - 18.*(eta/2. + 1./2.)*(xi/2. + 1./2.) + 27.*(xi/2. + 1./2.)*((eta + 1.)*(eta + 1.)/(2.*2.))/2. + 15./4. - 9.*(eta + 1.)*(eta + 1.)/(2.*2.)/2.);
                      case 12:
                        return sign * RealGradient(0., 0., -3.*eta/2. + 9.*(eta/2. + 1./2.)*(xi/2. + 1./2.) - 27.*(xi/2. + 1./2.)*(eta + 1.)*(eta + 1.)/(2.*2.)/2. - 3./2. + 9.*((eta + 1.)*(eta + 1.)/(2.*2.))/2.);
                      case 13:
                        return sign * RealGradient(0., 0., 3.*eta/2. - 9.*(eta/2. + 1./2.)*(xi/2. + 1./2.) + 27.*(xi/2. + 1./2.)*((eta + 1.)*(eta + 1.)/(2.*2.))/2. + 3./2. - 9.*(eta + 1.)*(eta + 1.)/(2.*2.)/2.);
                      case 14:
                        return sign * RealGradient(0., 0., -3.*eta + 9.*(eta/2. + 1./2.)*(xi/2. + 1./2.) - 27.*(xi/2. + 1./2.)*(eta + 1.)*(eta + 1.)/(2.*2.)/2. - 3. + 9.*((eta + 1.)*(eta + 1.)/(2.*2.)));
                      case 15:
                        return sign * RealGradient(0., 0., 3.*eta - 9.*(eta/2. + 1./2.)*(xi/2. + 1./2.) + 27.*(xi/2. + 1./2.)*((eta + 1.)*(eta + 1.)/(2.*2.))/2. + 3. - 9.*(eta + 1.)*(eta + 1.)/(2.*2.));
                      case 16:
                        return sign * RealGradient(-3.*eta - 9.*zeta/4. + 18.*(eta/2. + 1./2.)*(zeta/2. + 1./2.) - 27.*(zeta/2. + 1./2.)*(eta + 1.)*(eta + 1.)/(2.*2.)/2. - 15./4. + 9.*((eta + 1.)*(eta + 1.)/(2.*2.))/2., 0., 0.);
                      case 17:
                        return sign * RealGradient(3.*eta + 9.*zeta/4. - 18.*(eta/2. + 1./2.)*(zeta/2. + 1./2.) + 27.*(zeta/2. + 1./2.)*((eta + 1.)*(eta + 1.)/(2.*2.))/2. + 15./4. - 9.*(eta + 1.)*(eta + 1.)/(2.*2.)/2., 0., 0.);
                      case 18:
                        return sign * RealGradient(0., -3.*eta/2. - 3.*xi - 3.*zeta - 27.*(eta/2. + 1./2.)*(xi/2. + 1./2.)*(zeta/2. + 1./2.) + 9.*(eta/2. + 1./2.)*(xi/2. + 1./2.) + 9.*(eta/2. + 1./2.)*(zeta/2. + 1./2.) + 18.*(xi/2. + 1./2.)*(zeta/2. + 1./2.) - 11./2., 0.);
                      case 19:
                        return sign * RealGradient(0., 3.*eta/2. + 3.*xi/2. + 3.*zeta/2. + 27.*(eta/2. + 1./2.)*(xi/2. + 1./2.)*(zeta/2. + 1./2.) - 9.*(eta/2. + 1./2.)*(xi/2. + 1./2.) - 9.*(eta/2. + 1./2.)*(zeta/2. + 1./2.) - 9.*(xi/2. + 1./2.)*(zeta/2. + 1./2.) + 7./2., 0.);
                      case 20:
                        return sign * RealGradient(-3.*eta/2. + 9.*(eta/2. + 1./2.)*(zeta/2. + 1./2.) - 27.*(zeta/2. + 1./2.)*(eta + 1.)*(eta + 1.)/(2.*2.)/2. - 3./2. + 9.*((eta + 1.)*(eta + 1.)/(2.*2.))/2., 0., 0.);
                      case 21:
                        return sign * RealGradient(3.*eta/2. - 9.*(eta/2. + 1./2.)*(zeta/2. + 1./2.) + 27.*(zeta/2. + 1./2.)*((eta + 1.)*(eta + 1.)/(2.*2.))/2. + 3./2. - 9.*(eta + 1.)*(eta + 1.)/(2.*2.)/2., 0., 0.);
                      case 22:
                        return sign * RealGradient(0., -3.*eta - 3.*xi - 6.*zeta - 27.*(eta/2. + 1./2.)*(xi/2. + 1./2.)*(zeta/2. + 1./2.) + 9.*(eta/2. + 1./2.)*(xi/2. + 1./2.) + 18.*(eta/2. + 1./2.)*(zeta/2. + 1./2.) + 18.*(xi/2. + 1./2.)*(zeta/2. + 1./2.) - 8., 0.);
                      case 23:
                        return sign * RealGradient(0., 3.*eta + 3.*xi/2. + 3.*zeta + 27.*(eta/2. + 1./2.)*(xi/2. + 1./2.)*(zeta/2. + 1./2.) - 9.*(eta/2. + 1./2.)*(xi/2. + 1./2.) - 18.*(eta/2. + 1./2.)*(zeta/2. + 1./2.) - 9.*(xi/2. + 1./2.)*(zeta/2. + 1./2.) + 11./2., 0.);
                      case 24:
                        return RealGradient(0., 9.*eta + 12.*xi + 9.*zeta + 54.*(eta/2. + 1./2.)*(xi/2. + 1./2.)*(zeta/2. + 1./2.) - 36.*(eta/2. + 1./2.)*(xi/2. + 1./2.) - 27.*(eta/2. + 1./2.)*(zeta/2. + 1./2.) - 36.*(xi/2. + 1./2.)*(zeta/2. + 1./2.) + 18., 0.);
                      case 25:
                        return RealGradient(-9.*eta + 27.*(eta/2. + 1./2.)*(zeta/2. + 1./2.) - 27.*(zeta/2. + 1./2.)*(eta + 1.)*(eta + 1.)/(2.*2.) - 9. + 18.*((eta + 1.)*(eta + 1.)/(2.*2.)), 0., 0.);
                      case 26:
                        return RealGradient(9.*eta - 27.*(eta/2. + 1./2.)*(zeta/2. + 1./2.) + 27.*(zeta/2. + 1./2.)*((eta + 1.)*(eta + 1.)/(2.*2.)) + 9. - 18.*(eta + 1.)*(eta + 1.)/(2.*2.), 0., 0.);
                      case 27:
                        return RealGradient(0., -9.*eta - 6.*xi - 9.*zeta/2. - 54.*(eta/2. + 1./2.)*(xi/2. + 1./2.)*(zeta/2. + 1./2.) + 36.*(eta/2. + 1./2.)*(xi/2. + 1./2.) + 27.*(eta/2. + 1./2.)*(zeta/2. + 1./2.) + 18.*(xi/2. + 1./2.)*(zeta/2. + 1./2.) - 27./2., 0.);
                      case 28:
                        return RealGradient(0., 0., 9.*eta + 9.*xi/2. - 36.*(eta/2. + 1./2.)*(xi/2. + 1./2.) + 27.*(xi/2. + 1./2.)*((eta + 1.)*(eta + 1.)/(2.*2.)) + 9. - 27.*(eta + 1.)*(eta + 1.)/(2.*2.)/2.);
                      case 29:
                        return RealGradient(-9.*eta - 9.*zeta/2. + 36.*(eta/2. + 1./2.)*(zeta/2. + 1./2.) - 27.*(zeta/2. + 1./2.)*(eta + 1.)*(eta + 1.)/(2.*2.) - 9. + 27.*((eta + 1.)*(eta + 1.)/(2.*2.))/2., 0., 0.);
                      case 30:
                        return RealGradient(9.*eta + 9.*zeta/2. - 36.*(eta/2. + 1./2.)*(zeta/2. + 1./2.) + 27.*(zeta/2. + 1./2.)*((eta + 1.)*(eta + 1.)/(2.*2.)) + 9. - 27.*(eta + 1.)*(eta + 1.)/(2.*2.)/2., 0., 0.);
                      case 31:
                        return RealGradient(0., 0., -9.*eta - 9.*xi/2. + 36.*(eta/2. + 1./2.)*(xi/2. + 1./2.) - 27.*(xi/2. + 1./2.)*(eta + 1.)*(eta + 1.)/(2.*2.) - 9. + 27.*((eta + 1.)*(eta + 1.)/(2.*2.))/2.);
                      case 32:
                        return RealGradient(0., 0., 9.*eta/2. - 27.*(eta/2. + 1./2.)*(xi/2. + 1./2.) + 27.*(xi/2. + 1./2.)*((eta + 1.)*(eta + 1.)/(2.*2.)) + 9./2. - 9.*(eta + 1.)*(eta + 1.)/(2.*2.));
                      case 33:
                        return RealGradient(0., -9.*eta/2. - 9.*xi - 6.*zeta - 54.*(eta/2. + 1./2.)*(xi/2. + 1./2.)*(zeta/2. + 1./2.) + 27.*(eta/2. + 1./2.)*(xi/2. + 1./2.) + 18.*(eta/2. + 1./2.)*(zeta/2. + 1./2.) + 36.*(xi/2. + 1./2.)*(zeta/2. + 1./2.) - 27./2., 0.);
                      case 34:
                        return RealGradient(0., 9.*eta/2. + 9.*xi/2. + 3.*zeta + 54.*(eta/2. + 1./2.)*(xi/2. + 1./2.)*(zeta/2. + 1./2.) - 27.*(eta/2. + 1./2.)*(xi/2. + 1./2.) - 18.*(eta/2. + 1./2.)*(zeta/2. + 1./2.) - 18.*(xi/2. + 1./2.)*(zeta/2. + 1./2.) + 9., 0.);
                      case 35:
                        return RealGradient(0., 0., -9.*eta/2. + 27.*(eta/2. + 1./2.)*(xi/2. + 1./2.) - 27.*(xi/2. + 1./2.)*(eta + 1.)*(eta + 1.)/(2.*2.) - 9./2. + 9.*((eta + 1.)*(eta + 1.)/(2.*2.)));
                      case 36:
                        return RealGradient(0., 0., 9.*eta/2. - 18.*(eta/2. + 1./2.)*(xi/2. + 1./2.) + 27.*(xi/2. + 1./2.)*((eta + 1.)*(eta + 1.)/(2.*2.)) + 9./2. - 27.*(eta + 1.)*(eta + 1.)/(2.*2.)/2.);
                      case 37:
                        return RealGradient(-9.*eta/2. + 18.*(eta/2. + 1./2.)*(zeta/2. + 1./2.) - 27.*(zeta/2. + 1./2.)*(eta + 1.)*(eta + 1.)/(2.*2.) - 9./2. + 27.*((eta + 1.)*(eta + 1.)/(2.*2.))/2., 0., 0.);
                      case 38:
                        return RealGradient(9.*eta/2. - 18.*(eta/2. + 1./2.)*(zeta/2. + 1./2.) + 27.*(zeta/2. + 1./2.)*((eta + 1.)*(eta + 1.)/(2.*2.)) + 9./2. - 27.*(eta + 1.)*(eta + 1.)/(2.*2.)/2., 0., 0.);
                      case 39:
                        return RealGradient(0., 0., -9.*eta/2. + 18.*(eta/2. + 1./2.)*(xi/2. + 1./2.) - 27.*(xi/2. + 1./2.)*(eta + 1.)*(eta + 1.)/(2.*2.) - 9./2. + 27.*((eta + 1.)*(eta + 1.)/(2.*2.))/2.);
                      case 40:
                        return RealGradient(0., 0., 9.*eta - 27.*(eta/2. + 1./2.)*(xi/2. + 1./2.) + 27.*(xi/2. + 1./2.)*((eta + 1.)*(eta + 1.)/(2.*2.)) + 9. - 18.*(eta + 1.)*(eta + 1.)/(2.*2.));
                      case 41:
                        return RealGradient(0., -9.*eta - 9.*xi - 12.*zeta - 54.*(eta/2. + 1./2.)*(xi/2. + 1./2.)*(zeta/2. + 1./2.) + 27.*(eta/2. + 1./2.)*(xi/2. + 1./2.) + 36.*(eta/2. + 1./2.)*(zeta/2. + 1./2.) + 36.*(xi/2. + 1./2.)*(zeta/2. + 1./2.) - 18., 0.);
                      case 42:
                        return RealGradient(0., 9.*eta + 9.*xi/2. + 6.*zeta + 54.*(eta/2. + 1./2.)*(xi/2. + 1./2.)*(zeta/2. + 1./2.) - 27.*(eta/2. + 1./2.)*(xi/2. + 1./2.) - 36.*(eta/2. + 1./2.)*(zeta/2. + 1./2.) - 18.*(xi/2. + 1./2.)*(zeta/2. + 1./2.) + 27./2., 0.);
                      case 43:
                        return RealGradient(0., 0., -9.*eta + 27.*(eta/2. + 1./2.)*(xi/2. + 1./2.) - 27.*(xi/2. + 1./2.)*(eta + 1.)*(eta + 1.)/(2.*2.) - 9. + 18.*((eta + 1.)*(eta + 1.)/(2.*2.)));
                      case 44:
                        return RealGradient(0., 9.*eta/2. + 6.*xi + 9.*zeta + 54.*(eta/2. + 1./2.)*(xi/2. + 1./2.)*(zeta/2. + 1./2.) - 18.*(eta/2. + 1./2.)*(xi/2. + 1./2.) - 27.*(eta/2. + 1./2.)*(zeta/2. + 1./2.) - 36.*(xi/2. + 1./2.)*(zeta/2. + 1./2.) + 27./2., 0.);
                      case 45:
                        return RealGradient(-9.*eta/2. + 27.*(eta/2. + 1./2.)*(zeta/2. + 1./2.) - 27.*(zeta/2. + 1./2.)*(eta + 1.)*(eta + 1.)/(2.*2.) - 9./2. + 9.*((eta + 1.)*(eta + 1.)/(2.*2.)), 0., 0.);
                      case 46:
                        return RealGradient(9.*eta/2. - 27.*(eta/2. + 1./2.)*(zeta/2. + 1./2.) + 27.*(zeta/2. + 1./2.)*((eta + 1.)*(eta + 1.)/(2.*2.)) + 9./2. - 9.*(eta + 1.)*(eta + 1.)/(2.*2.), 0., 0.);
                      case 47:
                        return RealGradient(0., -9.*eta/2. - 3.*xi - 9.*zeta/2. - 54.*(eta/2. + 1./2.)*(xi/2. + 1./2.)*(zeta/2. + 1./2.) + 18.*(eta/2. + 1./2.)*(xi/2. + 1./2.) + 27.*(eta/2. + 1./2.)*(zeta/2. + 1./2.) + 18.*(xi/2. + 1./2.)*(zeta/2. + 1./2.) - 9., 0.);
                      case 48:
                        return RealGradient(0., 0., -27.*eta/2. + 54.*(eta/2. + 1./2.)*(xi/2. + 1./2.) - 54.*(xi/2. + 1./2.)*(eta + 1.)*(eta + 1.)/(2.*2.) - 27./2. + 27.*((eta + 1.)*(eta + 1.)/(2.*2.)));
                      case 49:
                        return RealGradient(0., 27.*eta/2. + 18.*xi + 18.*zeta + 108.*(eta/2. + 1./2.)*(xi/2. + 1./2.)*(zeta/2. + 1./2.) - 54.*(eta/2. + 1./2.)*(xi/2. + 1./2.) - 54.*(eta/2. + 1./2.)*(zeta/2. + 1./2.) - 72.*(xi/2. + 1./2.)*(zeta/2. + 1./2.) + 63./2., 0.);
                      case 50:
                        return RealGradient(-27.*eta/2. + 54.*(eta/2. + 1./2.)*(zeta/2. + 1./2.) - 54.*(zeta/2. + 1./2.)*(eta + 1.)*(eta + 1.)/(2.*2.) - 27./2. + 27.*((eta + 1.)*(eta + 1.)/(2.*2.)), 0., 0.);
                      case 51:
                        return RealGradient(27.*eta/2. - 54.*(eta/2. + 1./2.)*(zeta/2. + 1./2.) + 54.*(zeta/2. + 1./2.)*((eta + 1.)*(eta + 1.)/(2.*2.)) + 27./2. - 27.*(eta + 1.)*(eta + 1.)/(2.*2.), 0., 0.);
                      case 52:
                        return RealGradient(0., -27.*eta/2. - 9.*xi - 9.*zeta - 108.*(eta/2. + 1./2.)*(xi/2. + 1./2.)*(zeta/2. + 1./2.) + 54.*(eta/2. + 1./2.)*(xi/2. + 1./2.) + 54.*(eta/2. + 1./2.)*(zeta/2. + 1./2.) + 36.*(xi/2. + 1./2.)*(zeta/2. + 1./2.) - 45./2., 0.);
                      case 53:
                        return RealGradient(0., 0., 27.*eta/2. - 54.*(eta/2. + 1./2.)*(xi/2. + 1./2.) + 54.*(xi/2. + 1./2.)*((eta + 1.)*(eta + 1.)/(2.*2.)) + 27./2. - 27.*(eta + 1.)*(eta + 1.)/(2.*2.));
                      default:
                        libmesh_error_msg("Invalid i = " << i);
                      }
                  } // j = 3

                  // d^2()/detadzeta
                case 4:
                  {
                    switch(ii)
                      {
                      case 0:
                        return sign * RealGradient(-6.*eta - 6.*xi - 6.*zeta - 27.*(eta/2. + 1./2.)*(xi/2. + 1./2.)*(zeta/2. + 1./2.) + 18.*(eta/2. + 1./2.)*(xi/2. + 1./2.) + 18.*(eta/2. + 1./2.)*(zeta/2. + 1./2.) + 18.*(xi/2. + 1./2.)*(zeta/2. + 1./2.) - 10., 0., 0.);
                      case 1:
                        return sign * RealGradient(3.*eta + 6.*xi + 3.*zeta + 27.*(eta/2. + 1./2.)*(xi/2. + 1./2.)*(zeta/2. + 1./2.) - 18.*(eta/2. + 1./2.)*(xi/2. + 1./2.) - 9.*(eta/2. + 1./2.)*(zeta/2. + 1./2.) - 18.*(xi/2. + 1./2.)*(zeta/2. + 1./2.) + 8., 0., 0.);
                      case 2:
                        return sign * RealGradient(0., -3.*xi + 9.*(xi/2. + 1./2.)*(zeta/2. + 1./2.) - 27.*(zeta/2. + 1./2.)*(xi + 1.)*(xi + 1.)/(2.*2.)/2. - 3. + 9.*((xi + 1.)*(xi + 1.)/(2.*2.)), 0.);
                      case 3:
                        return sign * RealGradient(0., 3.*xi - 9.*(xi/2. + 1./2.)*(zeta/2. + 1./2.) + 27.*(zeta/2. + 1./2.)*((xi + 1.)*(xi + 1.)/(2.*2.))/2. + 3. - 9.*(xi + 1.)*(xi + 1.)/(2.*2.), 0.);
                      case 4:
                        return sign * RealGradient(-3.*eta - 3.*xi - 3.*zeta/2. - 27.*(eta/2. + 1./2.)*(xi/2. + 1./2.)*(zeta/2. + 1./2.) + 18.*(eta/2. + 1./2.)*(xi/2. + 1./2.) + 9.*(eta/2. + 1./2.)*(zeta/2. + 1./2.) + 9.*(xi/2. + 1./2.)*(zeta/2. + 1./2.) - 11./2., 0., 0.);
                      case 5:
                        return sign * RealGradient(6.*eta + 3.*xi + 3.*zeta + 27.*(eta/2. + 1./2.)*(xi/2. + 1./2.)*(zeta/2. + 1./2.) - 18.*(eta/2. + 1./2.)*(xi/2. + 1./2.) - 18.*(eta/2. + 1./2.)*(zeta/2. + 1./2.) - 9.*(xi/2. + 1./2.)*(zeta/2. + 1./2.) + 8., 0., 0.);
                      case 6:
                        return sign * RealGradient(0., -6.*xi - 9.*zeta/4. + 18.*(xi/2. + 1./2.)*(zeta/2. + 1./2.) - 27.*(zeta/2. + 1./2.)*(xi + 1.)*(xi + 1.)/(2.*2.)/2. - 21./4. + 9.*((xi + 1.)*(xi + 1.)/(2.*2.)), 0.);
                      case 7:
                        return sign * RealGradient(0., 6.*xi + 9.*zeta/4. - 18.*(xi/2. + 1./2.)*(zeta/2. + 1./2.) + 27.*(zeta/2. + 1./2.)*((xi + 1.)*(xi + 1.)/(2.*2.))/2. + 21./4. - 9.*(xi + 1.)*(xi + 1.)/(2.*2.), 0.);
                      case 8:
                        return sign * RealGradient(0., 0., -9.*eta/4. - 6.*xi + 18.*(eta/2. + 1./2.)*(xi/2. + 1./2.) - 27.*(eta/2. + 1./2.)*(xi + 1.)*(xi + 1.)/(2.*2.)/2. - 21./4. + 9.*((xi + 1.)*(xi + 1.)/(2.*2.)));
                      case 9:
                        return sign * RealGradient(0., 0., 9.*eta/4. + 6.*xi - 18.*(eta/2. + 1./2.)*(xi/2. + 1./2.) + 27.*(eta/2. + 1./2.)*((xi + 1.)*(xi + 1.)/(2.*2.))/2. + 21./4. - 9.*(xi + 1.)*(xi + 1.)/(2.*2.));
                      case 10:
                        return sign * RealGradient(0., 0., -3.*xi + 9.*(eta/2. + 1./2.)*(xi/2. + 1./2.) - 27.*(eta/2. + 1./2.)*(xi + 1.)*(xi + 1.)/(2.*2.)/2. - 3. + 9.*((xi + 1.)*(xi + 1.)/(2.*2.)));
                      case 11:
                        return sign * RealGradient(0., 0., 3.*xi - 9.*(eta/2. + 1./2.)*(xi/2. + 1./2.) + 27.*(eta/2. + 1./2.)*((xi + 1.)*(xi + 1.)/(2.*2.))/2. + 3. - 9.*(xi + 1.)*(xi + 1.)/(2.*2.));
                      case 12:
                        return sign * RealGradient(0., 0., -3.*xi/2. + 9.*(eta/2. + 1./2.)*(xi/2. + 1./2.) - 27.*(eta/2. + 1./2.)*(xi + 1.)*(xi + 1.)/(2.*2.)/2. - 3./2. + 9.*((xi + 1.)*(xi + 1.)/(2.*2.))/2.);
                      case 13:
                        return sign * RealGradient(0., 0., 3.*xi/2. - 9.*(eta/2. + 1./2.)*(xi/2. + 1./2.) + 27.*(eta/2. + 1./2.)*((xi + 1.)*(xi + 1.)/(2.*2.))/2. + 3./2. - 9.*(xi + 1.)*(xi + 1.)/(2.*2.)/2.);
                      case 14:
                        return sign * RealGradient(0., 0., -9.*eta/4. - 3.*xi + 18.*(eta/2. + 1./2.)*(xi/2. + 1./2.) - 27.*(eta/2. + 1./2.)*(xi + 1.)*(xi + 1.)/(2.*2.)/2. - 15./4. + 9.*((xi + 1.)*(xi + 1.)/(2.*2.))/2.);
                      case 15:
                        return sign * RealGradient(0., 0., 9.*eta/4. + 3.*xi - 18.*(eta/2. + 1./2.)*(xi/2. + 1./2.) + 27.*(eta/2. + 1./2.)*((xi + 1.)*(xi + 1.)/(2.*2.))/2. + 15./4. - 9.*(xi + 1.)*(xi + 1.)/(2.*2.)/2.);
                      case 16:
                        return sign * RealGradient(-3.*eta - 3.*xi - 6.*zeta - 27.*(eta/2. + 1./2.)*(xi/2. + 1./2.)*(zeta/2. + 1./2.) + 9.*(eta/2. + 1./2.)*(xi/2. + 1./2.) + 18.*(eta/2. + 1./2.)*(zeta/2. + 1./2.) + 18.*(xi/2. + 1./2.)*(zeta/2. + 1./2.) - 8., 0., 0.);
                      case 17:
                        return sign * RealGradient(3.*eta/2. + 3.*xi + 3.*zeta + 27.*(eta/2. + 1./2.)*(xi/2. + 1./2.)*(zeta/2. + 1./2.) - 9.*(eta/2. + 1./2.)*(xi/2. + 1./2.) - 9.*(eta/2. + 1./2.)*(zeta/2. + 1./2.) - 18.*(xi/2. + 1./2.)*(zeta/2. + 1./2.) + 11./2., 0., 0.);
                      case 18:
                        return sign * RealGradient(0., -3.*xi/2. + 9.*(xi/2. + 1./2.)*(zeta/2. + 1./2.) - 27.*(zeta/2. + 1./2.)*(xi + 1.)*(xi + 1.)/(2.*2.)/2. - 3./2. + 9.*((xi + 1.)*(xi + 1.)/(2.*2.))/2., 0.);
                      case 19:
                        return sign * RealGradient(0., 3.*xi/2. - 9.*(xi/2. + 1./2.)*(zeta/2. + 1./2.) + 27.*(zeta/2. + 1./2.)*((xi + 1.)*(xi + 1.)/(2.*2.))/2. + 3./2. - 9.*(xi + 1.)*(xi + 1.)/(2.*2.)/2., 0.);
                      case 20:
                        return sign * RealGradient(-3.*eta/2. - 3.*xi/2. - 3.*zeta/2. - 27.*(eta/2. + 1./2.)*(xi/2. + 1./2.)*(zeta/2. + 1./2.) + 9.*(eta/2. + 1./2.)*(xi/2. + 1./2.) + 9.*(eta/2. + 1./2.)*(zeta/2. + 1./2.) + 9.*(xi/2. + 1./2.)*(zeta/2. + 1./2.) - 7./2., 0., 0.);
                      case 21:
                        return sign * RealGradient(3.*eta + 3.*xi/2. + 3.*zeta + 27.*(eta/2. + 1./2.)*(xi/2. + 1./2.)*(zeta/2. + 1./2.) - 9.*(eta/2. + 1./2.)*(xi/2. + 1./2.) - 18.*(eta/2. + 1./2.)*(zeta/2. + 1./2.) - 9.*(xi/2. + 1./2.)*(zeta/2. + 1./2.) + 11./2., 0., 0.);
                      case 22:
                        return sign * RealGradient(0., -3.*xi - 9.*zeta/4. + 18.*(xi/2. + 1./2.)*(zeta/2. + 1./2.) - 27.*(zeta/2. + 1./2.)*(xi + 1.)*(xi + 1.)/(2.*2.)/2. - 15./4. + 9.*((xi + 1.)*(xi + 1.)/(2.*2.))/2., 0.);
                      case 23:
                        return sign * RealGradient(0., 3.*xi + 9.*zeta/4. - 18.*(xi/2. + 1./2.)*(zeta/2. + 1./2.) + 27.*(zeta/2. + 1./2.)*((xi + 1.)*(xi + 1.)/(2.*2.))/2. + 15./4. - 9.*(xi + 1.)*(xi + 1.)/(2.*2.)/2., 0.);
                      case 24:
                        return RealGradient(0., 9.*xi - 27.*(xi/2. + 1./2.)*(zeta/2. + 1./2.) + 27.*(zeta/2. + 1./2.)*((xi + 1.)*(xi + 1.)/(2.*2.)) + 9. - 18.*(xi + 1.)*(xi + 1.)/(2.*2.), 0.);
                      case 25:
                        return RealGradient(-12.*eta - 9.*xi - 9.*zeta - 54.*(eta/2. + 1./2.)*(xi/2. + 1./2.)*(zeta/2. + 1./2.) + 36.*(eta/2. + 1./2.)*(xi/2. + 1./2.) + 36.*(eta/2. + 1./2.)*(zeta/2. + 1./2.) + 27.*(xi/2. + 1./2.)*(zeta/2. + 1./2.) - 18., 0., 0.);
                      case 26:
                        return RealGradient(6.*eta + 9.*xi + 9.*zeta/2. + 54.*(eta/2. + 1./2.)*(xi/2. + 1./2.)*(zeta/2. + 1./2.) - 36.*(eta/2. + 1./2.)*(xi/2. + 1./2.) - 18.*(eta/2. + 1./2.)*(zeta/2. + 1./2.) - 27.*(xi/2. + 1./2.)*(zeta/2. + 1./2.) + 27./2., 0., 0.);
                      case 27:
                        return RealGradient(0., -9.*xi + 27.*(xi/2. + 1./2.)*(zeta/2. + 1./2.) - 27.*(zeta/2. + 1./2.)*(xi + 1.)*(xi + 1.)/(2.*2.) - 9. + 18.*((xi + 1.)*(xi + 1.)/(2.*2.)), 0.);
                      case 28:
                        return RealGradient(0., 0., 9.*xi - 27.*(eta/2. + 1./2.)*(xi/2. + 1./2.) + 27.*(eta/2. + 1./2.)*((xi + 1.)*(xi + 1.)/(2.*2.)) + 9. - 18.*(xi + 1.)*(xi + 1.)/(2.*2.));
                      case 29:
                        return RealGradient(-9.*eta - 9.*xi - 12.*zeta - 54.*(eta/2. + 1./2.)*(xi/2. + 1./2.)*(zeta/2. + 1./2.) + 27.*(eta/2. + 1./2.)*(xi/2. + 1./2.) + 36.*(eta/2. + 1./2.)*(zeta/2. + 1./2.) + 36.*(xi/2. + 1./2.)*(zeta/2. + 1./2.) - 18., 0., 0.);
                      case 30:
                        return RealGradient(9.*eta/2. + 9.*xi + 6.*zeta + 54.*(eta/2. + 1./2.)*(xi/2. + 1./2.)*(zeta/2. + 1./2.) - 27.*(eta/2. + 1./2.)*(xi/2. + 1./2.) - 18.*(eta/2. + 1./2.)*(zeta/2. + 1./2.) - 36.*(xi/2. + 1./2.)*(zeta/2. + 1./2.) + 27./2., 0., 0.);
                      case 31:
                        return RealGradient(0., 0., -9.*xi + 27.*(eta/2. + 1./2.)*(xi/2. + 1./2.) - 27.*(eta/2. + 1./2.)*(xi + 1.)*(xi + 1.)/(2.*2.) - 9. + 18.*((xi + 1.)*(xi + 1.)/(2.*2.)));
                      case 32:
                        return RealGradient(0., 0., 9.*xi/2. - 18.*(eta/2. + 1./2.)*(xi/2. + 1./2.) + 27.*(eta/2. + 1./2.)*((xi + 1.)*(xi + 1.)/(2.*2.)) + 9./2. - 27.*(xi + 1.)*(xi + 1.)/(2.*2.)/2.);
                      case 33:
                        return RealGradient(0., -9.*xi/2. + 18.*(xi/2. + 1./2.)*(zeta/2. + 1./2.) - 27.*(zeta/2. + 1./2.)*(xi + 1.)*(xi + 1.)/(2.*2.) - 9./2. + 27.*((xi + 1.)*(xi + 1.)/(2.*2.))/2., 0.);
                      case 34:
                        return RealGradient(0., 9.*xi/2. - 18.*(xi/2. + 1./2.)*(zeta/2. + 1./2.) + 27.*(zeta/2. + 1./2.)*((xi + 1.)*(xi + 1.)/(2.*2.)) + 9./2. - 27.*(xi + 1.)*(xi + 1.)/(2.*2.)/2., 0.);
                      case 35:
                        return RealGradient(0., 0., -9.*xi/2. + 18.*(eta/2. + 1./2.)*(xi/2. + 1./2.) - 27.*(eta/2. + 1./2.)*(xi + 1.)*(xi + 1.)/(2.*2.) - 9./2. + 27.*((xi + 1.)*(xi + 1.)/(2.*2.))/2.);
                      case 36:
                        return RealGradient(0., 0., 9.*xi/2. - 27.*(eta/2. + 1./2.)*(xi/2. + 1./2.) + 27.*(eta/2. + 1./2.)*((xi + 1.)*(xi + 1.)/(2.*2.)) + 9./2. - 9.*(xi + 1.)*(xi + 1.)/(2.*2.));
                      case 37:
                        return RealGradient(-9.*eta - 9.*xi/2. - 6.*zeta - 54.*(eta/2. + 1./2.)*(xi/2. + 1./2.)*(zeta/2. + 1./2.) + 27.*(eta/2. + 1./2.)*(xi/2. + 1./2.) + 36.*(eta/2. + 1./2.)*(zeta/2. + 1./2.) + 18.*(xi/2. + 1./2.)*(zeta/2. + 1./2.) - 27./2., 0., 0.);
                      case 38:
                        return RealGradient(9.*eta/2. + 9.*xi/2. + 3.*zeta + 54.*(eta/2. + 1./2.)*(xi/2. + 1./2.)*(zeta/2. + 1./2.) - 27.*(eta/2. + 1./2.)*(xi/2. + 1./2.) - 18.*(eta/2. + 1./2.)*(zeta/2. + 1./2.) - 18.*(xi/2. + 1./2.)*(zeta/2. + 1./2.) + 9., 0., 0.);
                      case 39:
                        return RealGradient(0., 0., -9.*xi/2. + 27.*(eta/2. + 1./2.)*(xi/2. + 1./2.) - 27.*(eta/2. + 1./2.)*(xi + 1.)*(xi + 1.)/(2.*2.) - 9./2. + 9.*((xi + 1.)*(xi + 1.)/(2.*2.)));
                      case 40:
                        return RealGradient(0., 0., 9.*eta/2. + 9.*xi - 36.*(eta/2. + 1./2.)*(xi/2. + 1./2.) + 27.*(eta/2. + 1./2.)*((xi + 1.)*(xi + 1.)/(2.*2.)) + 9. - 27.*(xi + 1.)*(xi + 1.)/(2.*2.)/2.);
                      case 41:
                        return RealGradient(0., -9.*xi - 9.*zeta/2. + 36.*(xi/2. + 1./2.)*(zeta/2. + 1./2.) - 27.*(zeta/2. + 1./2.)*(xi + 1.)*(xi + 1.)/(2.*2.) - 9. + 27.*((xi + 1.)*(xi + 1.)/(2.*2.))/2., 0.);
                      case 42:
                        return RealGradient(0., 9.*xi + 9.*zeta/2. - 36.*(xi/2. + 1./2.)*(zeta/2. + 1./2.) + 27.*(zeta/2. + 1./2.)*((xi + 1.)*(xi + 1.)/(2.*2.)) + 9. - 27.*(xi + 1.)*(xi + 1.)/(2.*2.)/2., 0.);
                      case 43:
                        return RealGradient(0., 0., -9.*eta/2. - 9.*xi + 36.*(eta/2. + 1./2.)*(xi/2. + 1./2.) - 27.*(eta/2. + 1./2.)*(xi + 1.)*(xi + 1.)/(2.*2.) - 9. + 27.*((xi + 1.)*(xi + 1.)/(2.*2.))/2.);
                      case 44:
                        return RealGradient(0., 9.*xi/2. - 27.*(xi/2. + 1./2.)*(zeta/2. + 1./2.) + 27.*(zeta/2. + 1./2.)*((xi + 1.)*(xi + 1.)/(2.*2.)) + 9./2. - 9.*(xi + 1.)*(xi + 1.)/(2.*2.), 0.);
                      case 45:
                        return RealGradient(-6.*eta - 9.*xi/2. - 9.*zeta - 54.*(eta/2. + 1./2.)*(xi/2. + 1./2.)*(zeta/2. + 1./2.) + 18.*(eta/2. + 1./2.)*(xi/2. + 1./2.) + 36.*(eta/2. + 1./2.)*(zeta/2. + 1./2.) + 27.*(xi/2. + 1./2.)*(zeta/2. + 1./2.) - 27./2., 0., 0.);
                      case 46:
                        return RealGradient(3.*eta + 9.*xi/2. + 9.*zeta/2. + 54.*(eta/2. + 1./2.)*(xi/2. + 1./2.)*(zeta/2. + 1./2.) - 18.*(eta/2. + 1./2.)*(xi/2. + 1./2.) - 18.*(eta/2. + 1./2.)*(zeta/2. + 1./2.) - 27.*(xi/2. + 1./2.)*(zeta/2. + 1./2.) + 9., 0., 0.);
                      case 47:
                        return RealGradient(0., -9.*xi/2. + 27.*(xi/2. + 1./2.)*(zeta/2. + 1./2.) - 27.*(zeta/2. + 1./2.)*(xi + 1.)*(xi + 1.)/(2.*2.) - 9./2. + 9.*((xi + 1.)*(xi + 1.)/(2.*2.)), 0.);
                      case 48:
                        return RealGradient(0., 0., -27.*xi/2. + 54.*(eta/2. + 1./2.)*(xi/2. + 1./2.) - 54.*(eta/2. + 1./2.)*(xi + 1.)*(xi + 1.)/(2.*2.) - 27./2. + 27.*((xi + 1.)*(xi + 1.)/(2.*2.)));
                      case 49:
                        return RealGradient(0., 27.*xi/2. - 54.*(xi/2. + 1./2.)*(zeta/2. + 1./2.) + 54.*(zeta/2. + 1./2.)*((xi + 1.)*(xi + 1.)/(2.*2.)) + 27./2. - 27.*(xi + 1.)*(xi + 1.)/(2.*2.), 0.);
                      case 50:
                        return RealGradient(-18.*eta - 27.*xi/2. - 18.*zeta - 108.*(eta/2. + 1./2.)*(xi/2. + 1./2.)*(zeta/2. + 1./2.) + 54.*(eta/2. + 1./2.)*(xi/2. + 1./2.) + 72.*(eta/2. + 1./2.)*(zeta/2. + 1./2.) + 54.*(xi/2. + 1./2.)*(zeta/2. + 1./2.) - 63./2., 0., 0.);
                      case 51:
                        return RealGradient(9.*eta + 27.*xi/2. + 9.*zeta + 108.*(eta/2. + 1./2.)*(xi/2. + 1./2.)*(zeta/2. + 1./2.) - 54.*(eta/2. + 1./2.)*(xi/2. + 1./2.) - 36.*(eta/2. + 1./2.)*(zeta/2. + 1./2.) - 54.*(xi/2. + 1./2.)*(zeta/2. + 1./2.) + 45./2., 0., 0.);
                      case 52:
                        return RealGradient(0., -27.*xi/2. + 54.*(xi/2. + 1./2.)*(zeta/2. + 1./2.) - 54.*(zeta/2. + 1./2.)*(xi + 1.)*(xi + 1.)/(2.*2.) - 27./2. + 27.*((xi + 1.)*(xi + 1.)/(2.*2.)), 0.);
                      case 53:
                        return RealGradient(0., 0., 27.*xi/2. - 54.*(eta/2. + 1./2.)*(xi/2. + 1./2.) + 54.*(eta/2. + 1./2.)*((xi + 1.)*(xi + 1.)/(2.*2.)) + 27./2. - 27.*(xi + 1.)*(xi + 1.)/(2.*2.));
                      default:
                        libmesh_error_msg("Invalid i = " << i);
                      }
                  } // j = 4

                  // d^2()/dzeta^2
                case 5:
                  {
                    switch(ii)
                      {
                      case 0:
                        return sign * RealGradient(-6.*eta - 9.*xi/4. + 9.*(eta + 1.)*(xi + 1.)/2. - 27.*(xi + 1.)*(eta + 1.)*(eta + 1.)/16. - 21./4. + 9.*((eta + 1.)*(eta + 1.))/4., 0., 0.);
                      case 1:
                        return sign * RealGradient(3.*eta + 9.*xi/4. - 9.*(eta + 1.)*(xi + 1.)/2. + 27.*(xi + 1.)*((eta + 1.)*(eta + 1.))/16. + 15./4. - 9.*(eta + 1.)*(eta + 1.)/8., 0., 0.);
                      case 2:
                        return sign * RealGradient(0., -3.*xi + 9.*(eta + 1.)*(xi + 1.)/4. - 27.*(eta + 1.)*(xi + 1.)*(xi + 1.)/16. - 3. + 9.*((xi + 1.)*(xi + 1.))/4., 0.);
                      case 3:
                        return sign * RealGradient(0., 3.*xi/2. - 9.*(eta + 1.)*(xi + 1.)/4. + 27.*(eta + 1.)*((xi + 1.)*(xi + 1.))/16. + 3./2. - 9.*(xi + 1.)*(xi + 1.)/8., 0.);
                      case 4:
                        return sign * RealGradient(-3.*eta/2. + 9.*(eta + 1.)*(xi + 1.)/4. - 27.*(xi + 1.)*(eta + 1.)*(eta + 1.)/16. - 3./2. + 9.*((eta + 1.)*(eta + 1.))/8., 0., 0.);
                      case 5:
                        return sign * RealGradient(3.*eta - 9.*(eta + 1.)*(xi + 1.)/4. + 27.*(xi + 1.)*((eta + 1.)*(eta + 1.))/16. + 3. - 9.*(eta + 1.)*(eta + 1.)/4., 0., 0.);
                      case 6:
                        return sign * RealGradient(0., -9.*eta/4. - 6.*xi + 9.*(eta + 1.)*(xi + 1.)/2. - 27.*(eta + 1.)*(xi + 1.)*(xi + 1.)/16. - 21./4. + 9.*((xi + 1.)*(xi + 1.))/4., 0.);
                      case 7:
                        return sign * RealGradient(0., 9.*eta/4. + 3.*xi - 9.*(eta + 1.)*(xi + 1.)/2. + 27.*(eta + 1.)*((xi + 1.)*(xi + 1.))/16. + 15./4. - 9.*(xi + 1.)*(xi + 1.)/8., 0.);
                      case 8:
                        return sign * RealGradient(0., 0., 0.);
                      case 9:
                        return sign * RealGradient(0., 0., 0.);
                      case 10:
                        return sign * RealGradient(0., 0., 0.);
                      case 11:
                        return sign * RealGradient(0., 0., 0.);
                      case 12:
                        return sign * RealGradient(0., 0., 0.);
                      case 13:
                        return sign * RealGradient(0., 0., 0.);
                      case 14:
                        return sign * RealGradient(0., 0., 0.);
                      case 15:
                        return sign * RealGradient(0., 0., 0.);
                      case 16:
                        return sign * RealGradient(-6.*eta - 9.*xi/4. + 9.*(eta + 1.)*(xi + 1.)/2. - 27.*(xi + 1.)*(eta + 1.)*(eta + 1.)/16. - 21./4. + 9.*((eta + 1.)*(eta + 1.))/4., 0., 0.);
                      case 17:
                        return sign * RealGradient(3.*eta + 9.*xi/4. - 9.*(eta + 1.)*(xi + 1.)/2. + 27.*(xi + 1.)*((eta + 1.)*(eta + 1.))/16. + 15./4. - 9.*(eta + 1.)*(eta + 1.)/8., 0., 0.);
                      case 18:
                        return sign * RealGradient(0., -3.*xi + 9.*(eta + 1.)*(xi + 1.)/4. - 27.*(eta + 1.)*(xi + 1.)*(xi + 1.)/16. - 3. + 9.*((xi + 1.)*(xi + 1.))/4., 0.);
                      case 19:
                        return sign * RealGradient(0., 3.*xi/2. - 9.*(eta + 1.)*(xi + 1.)/4. + 27.*(eta + 1.)*((xi + 1.)*(xi + 1.))/16. + 3./2. - 9.*(xi + 1.)*(xi + 1.)/8., 0.);
                      case 20:
                        return sign * RealGradient(-3.*eta/2. + 9.*(eta + 1.)*(xi + 1.)/4. - 27.*(xi + 1.)*(eta + 1.)*(eta + 1.)/16. - 3./2. + 9.*((eta + 1.)*(eta + 1.))/8., 0., 0.);
                      case 21:
                        return sign * RealGradient(3.*eta - 9.*(eta + 1.)*(xi + 1.)/4. + 27.*(xi + 1.)*((eta + 1.)*(eta + 1.))/16. + 3. - 9.*(eta + 1.)*(eta + 1.)/4., 0., 0.);
                      case 22:
                        return sign * RealGradient(0., -9.*eta/4. - 6.*xi + 9.*(eta + 1.)*(xi + 1.)/2. - 27.*(eta + 1.)*(xi + 1.)*(xi + 1.)/16. - 21./4. + 9.*((xi + 1.)*(xi + 1.))/4., 0.);
                      case 23:
                        return sign * RealGradient(0., 9.*eta/4. + 3.*xi - 9.*(eta + 1.)*(xi + 1.)/2. + 27.*(eta + 1.)*((xi + 1.)*(xi + 1.))/16. + 15./4. - 9.*(xi + 1.)*(xi + 1.)/8., 0.);
                      case 24:
                        return RealGradient(0., 9.*xi - 27.*(eta + 1.)*(xi + 1.)/4. + 27.*(eta + 1.)*((xi + 1.)*(xi + 1.))/8. + 9. - 9.*(xi + 1.)*(xi + 1.)/2., 0.);
                      case 25:
                        return RealGradient(-9.*eta + 27.*(eta + 1.)*(xi + 1.)/4. - 27.*(xi + 1.)*(eta + 1.)*(eta + 1.)/8. - 9. + 9.*((eta + 1.)*(eta + 1.))/2., 0., 0.);
                      case 26:
                        return RealGradient(9.*eta/2. - 27.*(eta + 1.)*(xi + 1.)/4. + 27.*(xi + 1.)*((eta + 1.)*(eta + 1.))/8. + 9./2. - 9.*(eta + 1.)*(eta + 1.)/4., 0., 0.);
                      case 27:
                        return RealGradient(0., -9.*xi/2. + 27.*(eta + 1.)*(xi + 1.)/4. - 27.*(eta + 1.)*(xi + 1.)*(xi + 1.)/8. - 9./2. + 9.*((xi + 1.)*(xi + 1.))/4., 0.);
                      case 28:
                        return RealGradient(0., 0., 0.);
                      case 29:
                        return RealGradient(-12.*eta - 9.*xi/2. + 9.*(eta + 1.)*(xi + 1.) - 27.*(xi + 1.)*(eta + 1.)*(eta + 1.)/8. - 21./2. + 9.*((eta + 1.)*(eta + 1.))/2., 0., 0.);
                      case 30:
                        return RealGradient(6.*eta + 9.*xi/2. - 9.*(eta + 1.)*(xi + 1.) + 27.*(xi + 1.)*((eta + 1.)*(eta + 1.))/8. + 15./2. - 9.*(eta + 1.)*(eta + 1.)/4., 0., 0.);
                      case 31:
                        return RealGradient(0., 0., 0.);
                      case 32:
                        return RealGradient(0., 0., 0.);
                      case 33:
                        return RealGradient(0., -6.*xi + 9.*(eta + 1.)*(xi + 1.)/2. - 27.*(eta + 1.)*(xi + 1.)*(xi + 1.)/8. - 6. + 9.*((xi + 1.)*(xi + 1.))/2., 0.);
                      case 34:
                        return RealGradient(0., 3.*xi - 9.*(eta + 1.)*(xi + 1.)/2. + 27.*(eta + 1.)*((xi + 1.)*(xi + 1.))/8. + 3. - 9.*(xi + 1.)*(xi + 1.)/4., 0.);
                      case 35:
                        return RealGradient(0., 0., 0.);
                      case 36:
                        return RealGradient(0., 0., 0.);
                      case 37:
                        return RealGradient(-6.*eta + 9.*(eta + 1.)*(xi + 1.)/2. - 27.*(xi + 1.)*(eta + 1.)*(eta + 1.)/8. - 6. + 9.*((eta + 1.)*(eta + 1.))/2., 0., 0.);
                      case 38:
                        return RealGradient(3.*eta - 9.*(eta + 1.)*(xi + 1.)/2. + 27.*(xi + 1.)*((eta + 1.)*(eta + 1.))/8. + 3. - 9.*(eta + 1.)*(eta + 1.)/4., 0., 0.);
                      case 39:
                        return RealGradient(0., 0., 0.);
                      case 40:
                        return RealGradient(0., 0., 0.);
                      case 41:
                        return RealGradient(0., -9.*eta/2. - 12.*xi + 9.*(eta + 1.)*(xi + 1.) - 27.*(eta + 1.)*(xi + 1.)*(xi + 1.)/8. - 21./2. + 9.*((xi + 1.)*(xi + 1.))/2., 0.);
                      case 42:
                        return RealGradient(0., 9.*eta/2. + 6.*xi - 9.*(eta + 1.)*(xi + 1.) + 27.*(eta + 1.)*((xi + 1.)*(xi + 1.))/8. + 15./2. - 9.*(xi + 1.)*(xi + 1.)/4., 0.);
                      case 43:
                        return RealGradient(0., 0., 0.);
                      case 44:
                        return RealGradient(0., 9.*xi - 27.*(eta + 1.)*(xi + 1.)/4. + 27.*(eta + 1.)*((xi + 1.)*(xi + 1.))/8. + 9. - 9.*(xi + 1.)*(xi + 1.)/2., 0.);
                      case 45:
                        return RealGradient(-9.*eta + 27.*(eta + 1.)*(xi + 1.)/4. - 27.*(xi + 1.)*(eta + 1.)*(eta + 1.)/8. - 9. + 9.*((eta + 1.)*(eta + 1.))/2., 0., 0.);
                      case 46:
                        return RealGradient(9.*eta/2. - 27.*(eta + 1.)*(xi + 1.)/4. + 27.*(xi + 1.)*((eta + 1.)*(eta + 1.))/8. + 9./2. - 9.*(eta + 1.)*(eta + 1.)/4., 0., 0.);
                      case 47:
                        return RealGradient(0., -9.*xi/2. + 27.*(eta + 1.)*(xi + 1.)/4. - 27.*(eta + 1.)*(xi + 1.)*(xi + 1.)/8. - 9./2. + 9.*((xi + 1.)*(xi + 1.))/4., 0.);
                      case 48:
                        return RealGradient(0., 0., 0.);
                      case 49:
                        return RealGradient(0., 18.*xi - 27.*(eta + 1.)*(xi + 1.)/2. + 27.*(eta + 1.)*((xi + 1.)*(xi + 1.))/4. + 18. - 9.*(xi + 1.)*(xi + 1.), 0.);
                      case 50:
                        return RealGradient(-18.*eta + 27.*(eta + 1.)*(xi + 1.)/2. - 27.*(xi + 1.)*(eta + 1.)*(eta + 1.)/4. - 18. + 9.*((eta + 1.)*(eta + 1.)), 0., 0.);
                      case 51:
                        return RealGradient(9.*eta - 27.*(eta + 1.)*(xi + 1.)/2. + 27.*(xi + 1.)*((eta + 1.)*(eta + 1.))/4. + 9. - 9.*(eta + 1.)*(eta + 1.)/2., 0., 0.);
                      case 52:
                        return RealGradient(0., -9.*xi + 27.*(eta + 1.)*(xi + 1.)/2. - 27.*(eta + 1.)*(xi + 1.)*(xi + 1.)/4. - 9. + 9.*((xi + 1.)*(xi + 1.))/2., 0.);
                      case 53:
                        return RealGradient(0., 0., 0.);
                      default:
                        libmesh_error_msg("Invalid i = " << i);
                      }
                  } // j = 5

                default:
                  libmesh_error_msg("Invalid j = " << j);
                }
            }

          case TET14:
            {
              switch (j)
                {
                  // d^2()/dxi^2
                case 0:
                  {
                    switch(ii)
                      {
                      case 0:
                        return sign * RealGradient(0., -16., -16.);
                      case 1:
                        return sign * RealGradient(0., 16., 16.);
                      case 2:
                        return sign * RealGradient(0., 16., 0.);
                      case 3:
                        return sign * RealGradient(0., 0., 0.);
                      case 4:
                        return sign * RealGradient(0., 16., 0.);
                      case 5:
                        return sign * RealGradient(0., 0., 0.);
                      case 6:
                        return sign * RealGradient(0., 0., 16.);
                      case 7:
                        return sign * RealGradient(0., 0., 0.);
                      case 8:
                        return sign * RealGradient(0., 0., 16.);
                      case 9:
                        return sign * RealGradient(0., 0., 0.);
                      case 10:
                        return sign * RealGradient(0., 0., 0.);
                      case 11:
                        return sign * RealGradient(0., 0., 0.);
                      case 12:
                        return RealGradient(0., 16., 0.);
                      case 13:
                        return RealGradient(0., -32., 0.);
                      case 14:
                        return RealGradient(0., 0., 16.);
                      case 15:
                        return RealGradient(0., 0., -32.);
                      case 16:
                        return RealGradient(0., 0., 0.);
                      case 17:
                        return RealGradient(0., 0., 0.);
                      case 18:
                        return RealGradient(0., 0., 0.);
                      case 19:
                        return RealGradient(0., 0., 0.);
                      default:
                        libmesh_error_msg("Invalid i = " << i);
                      }
                  } // j = 0

                  // d^2()/dxideta
                case 1:
                  {
                    switch(ii)
                      {
                      case 0:
                        return sign * RealGradient(8., -8., -8.);
                      case 1:
                        return sign * RealGradient(-8., 0., 0.);
                      case 2:
                        return sign * RealGradient(-8., 0., 0.);
                      case 3:
                        return sign * RealGradient(0., 8., 0.);
                      case 4:
                        return sign * RealGradient(-8., 8., -8.);
                      case 5:
                        return sign * RealGradient(0., -8., 0.);
                      case 6:
                        return sign * RealGradient(0., 0., 16.);
                      case 7:
                        return sign * RealGradient(0., 0., 0.);
                      case 8:
                        return sign * RealGradient(0., 0., 0.);
                      case 9:
                        return sign * RealGradient(0., 0., 0.);
                      case 10:
                        return sign * RealGradient(0., 0., 0.);
                      case 11:
                        return sign * RealGradient(0., 0., 0.);
                      case 12:
                        return RealGradient(-8., 16., 8.);
                      case 13:
                        return RealGradient(16., -8., 8.);
                      case 14:
                        return RealGradient(0., 0., 8.);
                      case 15:
                        return RealGradient(0., 0., -16.);
                      case 16:
                        return RealGradient(0., 0., -8.);
                      case 17:
                        return RealGradient(0., 0., 16.);
                      case 18:
                        return RealGradient(0., 0., 8.);
                      case 19:
                        return RealGradient(0., 0., -16.);
                      default:
                        libmesh_error_msg("Invalid i = " << i);
                      }
                  } // j = 1

                  // d^2()/deta^2
                case 2:
                  {
                    switch(ii)
                      {
                      case 0:
                        return sign * RealGradient(16., 0., 0.);
                      case 1:
                        return sign * RealGradient(0., 0., 0.);
                      case 2:
                        return sign * RealGradient(0., 0., 0.);
                      case 3:
                        return sign * RealGradient(-16., 0., 0.);
                      case 4:
                        return sign * RealGradient(-16., 0., -16.);
                      case 5:
                        return sign * RealGradient(16., 0., 16.);
                      case 6:
                        return sign * RealGradient(0., 0., 16.);
                      case 7:
                        return sign * RealGradient(0., 0., 0.);
                      case 8:
                        return sign * RealGradient(0., 0., 0.);
                      case 9:
                        return sign * RealGradient(0., 0., 0.);
                      case 10:
                        return sign * RealGradient(0., 0., 16.);
                      case 11:
                        return sign * RealGradient(0., 0., 0.);
                      case 12:
                        return RealGradient(-32., 0., 0.);
                      case 13:
                        return RealGradient(16., 0., 0.);
                      case 14:
                        return RealGradient(0., 0., 0.);
                      case 15:
                        return RealGradient(0., 0., 0.);
                      case 16:
                        return RealGradient(0., 0., 0.);
                      case 17:
                        return RealGradient(0., 0., 0.);
                      case 18:
                        return RealGradient(0., 0., 16.);
                      case 19:
                        return RealGradient(0., 0., -32.);
                      default:
                        libmesh_error_msg("Invalid i = " << i);
                      }
                  } // j = 2

                  // d^2()/dxidzeta
                case 3:
                  {
                    switch(ii)
                      {
                      case 0:
                        return sign * RealGradient(8., -8., -8.);
                      case 1:
                        return sign * RealGradient(-8., 0., 0.);
                      case 2:
                        return sign * RealGradient(0., 0., 0.);
                      case 3:
                        return sign * RealGradient(0., 0., 0.);
                      case 4:
                        return sign * RealGradient(0., 16., 0.);
                      case 5:
                        return sign * RealGradient(0., 0., 0.);
                      case 6:
                        return sign * RealGradient(-8., -8., 8.);
                      case 7:
                        return sign * RealGradient(0., 0., -8.);
                      case 8:
                        return sign * RealGradient(-8., 0., 0.);
                      case 9:
                        return sign * RealGradient(0., 0., 8.);
                      case 10:
                        return sign * RealGradient(0., 0., 0.);
                      case 11:
                        return sign * RealGradient(0., 0., 0.);
                      case 12:
                        return RealGradient(0., 8., 0.);
                      case 13:
                        return RealGradient(0., -16., 0.);
                      case 14:
                        return RealGradient(-8., 8., 16.);
                      case 15:
                        return RealGradient(16., 8., -8.);
                      case 16:
                        return RealGradient(0., 16., 0.);
                      case 17:
                        return RealGradient(0., -8., 0.);
                      case 18:
                        return RealGradient(0., -16., 0.);
                      case 19:
                        return RealGradient(0., 8., 0.);
                      default:
                        libmesh_error_msg("Invalid i = " << i);
                      }
                  } // j = 3

                  // d^2()/detadzeta
                case 4:
                  {
                    switch(ii)
                      {
                      case 0:
                        return sign * RealGradient(16., 0., 0.);
                      case 1:
                        return sign * RealGradient(0., 0., 0.);
                      case 2:
                        return sign * RealGradient(0., 0., 0.);
                      case 3:
                        return sign * RealGradient(0., 0., 0.);
                      case 4:
                        return sign * RealGradient(-8., 8., -8.);
                      case 5:
                        return sign * RealGradient(0., -8., 0.);
                      case 6:
                        return sign * RealGradient(-8., -8., 8.);
                      case 7:
                        return sign * RealGradient(0., 0., -8.);
                      case 8:
                        return sign * RealGradient(0., 0., 0.);
                      case 9:
                        return sign * RealGradient(0., 0., 0.);
                      case 10:
                        return sign * RealGradient(0., -8., 0.);
                      case 11:
                        return sign * RealGradient(0., 0., 8.);
                      case 12:
                        return RealGradient(-16., 0., 0.);
                      case 13:
                        return RealGradient(8., 0., 0.);
                      case 14:
                        return RealGradient(-16., 0., 0.);
                      case 15:
                        return RealGradient(8., 0., 0.);
                      case 16:
                        return RealGradient(-8., 0., 0.);
                      case 17:
                        return RealGradient(-8., 0., 0.);
                      case 18:
                        return RealGradient(8., -8., 16.);
                      case 19:
                        return RealGradient(8., 16., -8.);
                      default:
                        libmesh_error_msg("Invalid i = " << i);
                      }
                  } // j = 4

                  // d^2()/dzeta^2
                case 5:
                  {
                    switch(ii)
                      {
                      case 0:
                        return sign * RealGradient(16., 0., 0.);
                      case 1:
                        return sign * RealGradient(0., 0., 0.);
                      case 2:
                        return sign * RealGradient(0., 0., 0.);
                      case 3:
                        return sign * RealGradient(0., 0., 0.);
                      case 4:
                        return sign * RealGradient(0., 16., 0.);
                      case 5:
                        return sign * RealGradient(0., 0., 0.);
                      case 6:
                        return sign * RealGradient(-16., -16., 0.);
                      case 7:
                        return sign * RealGradient(16., 16., 0.);
                      case 8:
                        return sign * RealGradient(0., 0., 0.);
                      case 9:
                        return sign * RealGradient(-16., 0., 0.);
                      case 10:
                        return sign * RealGradient(0., 0., 0.);
                      case 11:
                        return sign * RealGradient(0., -16., 0.);
                      case 12:
                        return RealGradient(0., 0., 0.);
                      case 13:
                        return RealGradient(0., 0., 0.);
                      case 14:
                        return RealGradient(-32., 0., 0.);
                      case 15:
                        return RealGradient(16., 0., 0.);
                      case 16:
                        return RealGradient(0., 0., 0.);
                      case 17:
                        return RealGradient(0., 0., 0.);
                      case 18:
                        return RealGradient(0., -32., 0.);
                      case 19:
                        return RealGradient(0., 16., 0.);
                      default:
                        libmesh_error_msg("Invalid i = " << i);
                      }
                  } // j = 5

                default:
                  libmesh_error_msg("Invalid j = " << j);
                }
            }

          default:
            libmesh_error_msg("ERROR: Unsupported 3D element type!: " << Utility::enum_to_string(elem->type()));
          } // end switch (type)
      } // end case SECOND

      // unsupported order
    default:
      libmesh_error_msg("ERROR: Unsupported 3D FE order!: " << totalorder);
    }

#else // LIBMESH_DIM != 3
  libmesh_assert(true || p(0));
  libmesh_ignore(elem, order, i, j, add_p_level);
  libmesh_not_implemented();
#endif
}



template <>
RealGradient FE<3,NEDELEC_ONE>::shape_second_deriv(const ElemType,
                                                   const Order,
                                                   const unsigned int,
                                                   const unsigned int,
                                                   const Point &)
{
  libmesh_error_msg("Nedelec elements require the element type \nbecause edge orientation is needed.");
  return RealGradient();
}



template <>
RealGradient FE<3,NEDELEC_ONE>::shape_second_deriv(const FEType fet,
                                                   const Elem * elem,
                                                   const unsigned int i,
                                                   const unsigned int j,
                                                   const Point & p,
                                                   const bool add_p_level)
{
  return FE<3,NEDELEC_ONE>::shape_second_deriv(elem, fet.order, i, j, p, add_p_level);
}



#endif

} // namespace libMesh
